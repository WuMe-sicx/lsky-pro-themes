import{p as e,a as t,n as l,r as a,c as o,C as s,A as i,m as n,i as r,y as c,j as u,f as d,z as p}from"./Layout-B7WTefT3.js";import{d as v,b as h,f,g as y,m as g,c as m,i as b,I as k,a as x,a8 as w,F as _,h as C,z as S,e as A,E as P,C as M,n as z,y as T,Y as D,v as I,a4 as j,ac as E,ag as $,J as L,_ as U,ah as B,x as N,s as O,O as W,A as K,o as R,ai as F,a7 as H,aj as V}from"./index-Ctnlk-aF.js";import{P as q,W as G}from"./WaterfallLayout-Cc-Ll5Bs.js";import{E as Y,D as J}from"./album-CfclpCjE.js";import{u as X}from"./composables-DhvgzyQS.js";import{N as Q}from"./Spin-DlOkiMFH.js";import{N as Z}from"./Popconfirm-DM_99shz.js";const ee={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},te=[y("path",{d:"M384 224v184a40 40 0 0 1-40 40H104a40 40 0 0 1-40-40V168a40 40 0 0 1 40-40h167.48",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M336 64h112v112"},null,-1),y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M224 288L440 72"},null,-1)],le=v({name:"OpenOutline",render:function(e,t){return f(),h("svg",ee,te)}}),ae={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},oe=[y("path",{d:"M336 192h40a40 40 0 0 1 40 40v192a40 40 0 0 1-40 40H136a40 40 0 0 1-40-40V232a40 40 0 0 1 40-40h40",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M336 128l-80-80l-80 80"},null,-1),y("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 321V48"},null,-1)],se=v({name:"ShareOutline",render:function(e,t){return f(),h("svg",ae,oe)}}),ie=["aria-label","aria-selected"],ne={class:"relative group bg-gray-200 dark:bg-gray-700 rounded-xl overflow-hidden h-full"},re={class:"absolute inset-0 z-[2] select-none pointer-events-none"},ce={class:"absolute top-2.5 left-2.5 pointer-events-auto"},ue=["aria-label","title"],de=["aria-label","title"],pe={class:"photo-hover-action absolute bottom-2 left-2.5 pointer-events-none"},ve={key:0,class:"text-white text-xs truncate max-w-[70%] drop-shadow-sm"},he={key:1,class:"text-white/70 text-[10px] drop-shadow-sm"},fe={key:0,class:"absolute top-2.5 right-2.5"},ye={class:"flex gap-2"},ge=["aria-label","title","onClick"],me=["aria-label","title","onClick"],be=U(v({__name:"Photo",props:{photo:{}},emits:["onToggleSelect"],setup(n,{emit:r}){const c=n;g();const u=m((()=>c.photo)),d=e(),{t:p}=b(),v=t(),U=X(),B=k(),N=m((()=>B.path.includes("/user/albums/"))),O=m((()=>d.selectionMode||d.selections.length>0)),W=x(null),K=x(!1),R=x();let F=null;function H(e){F=setTimeout((()=>{F=null,d.selectionMode=!0,d.toggleSelect(u.value.key),W.value=u.value.key}),500)}function V(){F&&(clearTimeout(F),F=null)}function G(){F&&(clearTimeout(F),F=null)}let Q=null;w((()=>{F&&clearTimeout(F),Q&&clearTimeout(Q)}));const Z=m((()=>u.value.size?l.fileSize(u.value.size):"")),ee={showThumbnails:!0,showDrawer:!0,drawerConfig:{defaultOpen:!0,title:p("Photo Info")},controls:{showClose:!0,showInfo:!0,showNavigation:!0}},te=m((()=>d.groups.flatMap((e=>e.photos)).map((e=>({id:e.key,src:e.public_url||e.src,thumbnail:e.thumbnail_url||e.src,name:e.name,width:e.width,height:e.height,size:e.size,extension:e.extension,created_at:e.created_at||void 0,is_public:e.is_public,tags:e.tags||[]})))));function ae(e){e&&(e.preventDefault(),e.stopPropagation());const t=u.value.key;if(e&&(e.ctrlKey||e.metaKey))return d.toggleSelect(t),void(W.value=t);e&&e.shiftKey&&W.value?function(e,t){let l=-1,a=-1,o=-1,s=-1;const i=d.groups;for(let n=0;n<i.length;n++){const r=i[n];for(let i=0;i<r.photos.length;i++)r.photos[i].key===e&&(l=n,a=i),r.photos[i].key===t&&(o=n,s=i)}if(-1===l||-1===o)return;(l>o||l===o&&a>s)&&([l,o]=[o,l],[a,s]=[s,a]);for(let n=l;n<=o;n++){const e=i[n],t=n===l?a:0,r=n===o?s:e.photos.length-1;for(let l=t;l<=r;l++){const t=e.photos[l].key;e.photos[l].selected||d.toggleSelect(t)}}}(W.value,t):(d.toggleSelect(t),W.value=t)}function oe(e){if(e.ctrlKey||e.metaKey||e.shiftKey)ae(e);else{if(O.value)return e.preventDefault(),d.toggleSelect(u.value.key),void(W.value=u.value.key);e.preventDefault(),R.value=u.value.key,K.value=!0}}function be(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),O.value?d.toggleSelect(u.value.key):(R.value=u.value.key,K.value=!0))}function ke(e){return()=>j(o,null,{default:()=>j(e)})}const xe=m((()=>[{label:p("Copy Image"),key:"copy",disabled:d.selections.length>1,icon:ke(s)},{label:p("Copy Link"),key:"copy-urls",icon:ke(s),children:[{label:"Url",key:"copy-url"},{label:"Html",key:"copy-html"},{label:"BBCode",key:"copy-bbcode"},{label:"Markdown",key:"copy-markdown"},{label:"Markdown with link",key:"copy-markdown_with_link"},{label:"Thumbnail url",key:"copy-thumbnail_url"}]},{label:p("Open in New Window"),key:"open",disabled:d.selections.length>1,icon:ke(le)},{label:p("Edit Information"),key:"edit",icon:ke(Y)},{label:p("Share"),key:"share",icon:ke(se)},...N.value?[{label:p("Remove from Album"),key:"remove-from-album",icon:ke(i)}]:[{label:p("Add to Album"),key:"to-album",icon:ke(i)}],{type:"divider",key:"d1"},{label:p("Delete"),key:"delete",icon:ke(J)}])),we=x(!1),_e=x(0),Ce=x(0);function Se(e){var t;we.value=!1;const l=String(e);switch(l){case"copy":d.copyImage(u.value.src).then((()=>v.success(p("Copy successful")))).catch((e=>{v.error(p("Copy failed"))}));break;case"copy-url":case"copy-html":case"copy-bbcode":case"copy-markdown":case"copy-markdown_with_link":case"copy-thumbnail_url":d.copyLink(l.replace("copy-","")).then((()=>v.success(p("Copy successful")))).catch((()=>v.error(p("Copy failed"))));break;case"open":d.openPhoto(u.value);break;case"edit":d.setEditModalActive(!0);break;case"share":d.setShareModalActive(!0);break;case"to-album":null==(t=d.albumSelectorRef)||t.open();break;case"remove-from-album":const e=Number(B.params.id);if(e){const t=U.warning({title:p("Warning"),content:p("Are you sure you want to remove the selected {count} photos from the album?",{count:d.selections.length}),positiveText:p("Confirm"),negativeText:p("Cancel"),onPositiveClick:()=>(t.loading=!0,E({path:{id:e},body:d.selections.map((e=>e.id))}).then((()=>{v.success(p("Removed successfully")),d.deletePhotos(d.selections.map((e=>e.key)));const e=g();e.isLoggedIn&&e.fetchUserProfile()})))})}break;case"delete":const a=U.warning({title:p("Warning"),content:p("Are you sure you want to delete the selected {count} photos?",{count:d.selections.length}),positiveText:p("Confirm"),negativeText:p("Cancel"),onPositiveClick:()=>(a.loading=!0,d.deleteSelectedPhotos().then((()=>{v.success(p("Deleted successfully"))})))})}}function Ae(e){e.preventDefault(),we.value=!1,$().then((()=>{we.value=!0,_e.value=e.clientX,Ce.value=e.clientY})),u.value.selected||(d.unselectAll(),Q&&clearTimeout(Q),Q=setTimeout((()=>{d.toggleSelect(u.value.key)}),10))}function Pe(){we.value=!1}function Me(){const e=U.warning({title:p("Warning"),content:p("Are you sure you want to delete this photo?"),positiveText:p("Confirm"),negativeText:p("Cancel"),onPositiveClick:()=>(e.loading=!0,u.value.selected||d.toggleSelect(u.value.key),d.deleteSelectedPhotos().then((()=>{v.success(p("Deleted successfully")),K.value=!1})))})}function ze(){u.value.selected||(d.unselectAll(),d.toggleSelect(u.value.key)),d.copyLink("url").then((()=>v.success(p("Copy successful")))).catch((()=>v.error(p("Copy failed"))))}return(e,t)=>(f(),h(_,null,[y("div",{role:"button",tabindex:"0","aria-label":u.value.name||S(p)("Photo"),"aria-selected":u.value.selected,onContextmenu:Ae,onClick:oe,onKeydown:be,onTouchstartPassive:H,onTouchendPassive:V,onTouchmovePassive:G,class:"outline-none focus-visible:ring-2 focus-visible:ring-violet-500 focus-visible:ring-offset-1 rounded-xl cursor-pointer"},[C(S(a),{placement:"bottom-start",trigger:"manual",x:_e.value,y:Ce.value,options:xe.value,show:we.value,"on-clickoutside":Pe,onSelect:Se},null,8,["x","y","options","show"]),y("div",ne,[t[3]||(t[3]=y("div",{class:"photo-hover-overlay absolute inset-0 bg-black/0 group-hover:bg-black/15 transition-all duration-300 z-[1] pointer-events-none rounded-xl"},null,-1)),y("div",re,[y("div",ce,[C(S(P),{class:z(["rounded-full cursor-pointer photo-hover-action",u.value.selected?"text-violet-500 bg-white outline outline-1 outline-white dark:outline-gray-500 !opacity-100":O.value?"text-white/60 hover:text-white !opacity-100":"text-white/80 hover:text-white"]),icon:"fa-solid fa-circle-check",size:"xl","aria-label":S(p)("Select photo"),role:"checkbox","aria-checked":u.value.selected,onClick:M(ae,["prevent","stop"])},null,8,["class","aria-label","aria-checked"])]),y("button",{class:"photo-hover-action absolute top-2.5 right-2.5 pointer-events-auto photo-action-btn","aria-label":S(p)("Copy Link"),title:S(p)("Copy Link"),onClick:M(ze,["prevent","stop"])},[C(S(P),{icon:"fa-solid fa-link",class:"text-xs"})],8,ue),y("button",{class:"photo-hover-action absolute bottom-2.5 right-2.5 pointer-events-auto photo-action-btn","aria-label":S(p)("Delete"),title:S(p)("Delete"),onClick:M(Me,["prevent","stop"])},[C(S(P),{icon:"fa-solid fa-trash-can",class:"text-xs"})],8,de),y("div",pe,[u.value.name?(f(),h("p",ve,T(u.value.name),1)):A("",!0),Z.value?(f(),h("p",he,T(Z.value),1)):A("",!0)]),u.value.is_public&&!O.value?(f(),h("div",fe,[C(S(P),{class:"text-red-400 drop-shadow-sm photo-public-indicator",icon:"fa-solid fa-eye",size:"sm",title:e.$t("Public")},null,8,["title"])])):A("",!0)]),y("div",{class:z(["overflow-hidden transition-all duration-300 h-full",u.value.selected?"scale-[0.88] rounded-xl":""])},[D(e.$slots,"default",{},void 0,!0)],2)])],40,ie),C(S(q),{show:K.value,"onUpdate:show":t[0]||(t[0]=e=>K.value=e),"current-photo-id":R.value,"onUpdate:currentPhotoId":t[1]||(t[1]=e=>R.value=e),photos:te.value,config:ee,"onPhoto:change":t[2]||(t[2]=e=>{})},{"top-right":I((({photo:e})=>[y("div",ye,[y("button",{class:"viewer-button","aria-label":S(p)("Edit Information"),title:S(p)("Edit Information"),onClick:t=>function(e){const t=d.groups.flatMap((e=>e.photos)).find((t=>t.key===e.id));if(t){const e=d.selections.slice();d.unselectAll(),d.toggleSelect(t.key),d.setEditModalActive(!0);const l=L((()=>d.editModalActive),(t=>{t||(d.unselectAll(),e.forEach((e=>{d.toggleSelect(e.key)})),l())}))}}(e)},[C(S(P),{icon:"fa-solid fa-edit",class:"text-sm text-white"})],8,ge),y("button",{class:"viewer-button","aria-label":S(p)("Share"),title:S(p)("Share"),onClick:t=>function(e){const t=d.groups.flatMap((e=>e.photos)).find((t=>t.key===e.id));if(t){const e=d.selections.slice();d.unselectAll(),d.toggleSelect(t.key),d.setShareModalActive(!0);const l=L((()=>d.shareModalActive),(t=>{t||(d.unselectAll(),e.forEach((e=>{d.toggleSelect(e.key)})),l())}))}}(e)},[C(S(P),{icon:"fa-solid fa-share",class:"text-sm text-white"})],8,me)])])),"drawer-content":I((({photo:e})=>t[4]||(t[4]=[]))),_:1},8,["show","current-photo-id","photos"])],64))}}),[["__scopeId","data-v-e79b77e9"]]),ke={class:"photo-image-container relative w-full h-full"},xe={key:0,class:"absolute inset-0 overflow-hidden rounded-xl"},we={key:1,class:"flex flex-col items-center gap-2 px-2"},_e={key:1,class:"w-full h-full"},Ce=["src","alt"],Se=U(v({__name:"PhotoImage",props:{src:{type:String,required:!0},alt:{type:String,default:""},placeholderText:{type:String,default:""},errorText:{type:String,default:""},retryText:{type:String,default:""},width:{type:Number,default:0},height:{type:Number,default:0}},setup(e){const t=e,l=x(!0),a=x(!1),o=x(),s=x(0);function i(){l.value=!1,a.value=!1,s.value=0}function n(){if(l.value=!1,s.value<2){s.value++;const e=500*Math.pow(2,s.value);setTimeout((()=>{if(!o.value)return;l.value=!0,a.value=!1;const e=t.src.includes("?")?"&":"?";o.value.src=`${t.src}${e}_retry=${Date.now()}`}),e)}else a.value=!0}function r(){if(!o.value)return;l.value=!0,a.value=!1,s.value=0;const e=t.src.includes("?")?"&":"?";o.value.src=`${t.src}${e}_retry=${Date.now()}`}return(t,s)=>(f(),h("div",ke,[l.value||a.value?(f(),h("div",{key:0,class:z(["absolute inset-0 rounded-xl flex items-center justify-center",a.value?"bg-gray-100 dark:bg-gray-700":"bg-gray-200 dark:bg-gray-700 animate-pulse"])},[l.value?(f(),h("div",xe,s[0]||(s[0]=[y("div",{class:"shimmer-effect absolute inset-0"},null,-1)]))):a.value?(f(),h("div",we,[s[1]||(s[1]=y("svg",{class:"w-8 h-8 text-gray-400 dark:text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.5"},[y("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909M3.75 21h16.5A2.25 2.25 0 0022.5 18.75V5.25A2.25 2.25 0 0020.25 3H3.75A2.25 2.25 0 001.5 5.25v13.5A2.25 2.25 0 003.75 21z"})],-1)),y("button",{onClick:M(r,["stop"]),class:"text-xs text-gray-500 dark:text-gray-400 hover:text-blue-500 dark:hover:text-blue-400 cursor-pointer transition-colors"},T(e.retryText||"Retry"),1)])):A("",!0)],2)):A("",!0),l.value||a.value?(f(),h("div",_e)):A("",!0),y("img",{ref_key:"imageRef",ref:o,src:e.src,alt:e.alt,class:z(["w-full h-full object-cover rounded-xl transition-opacity duration-300",{"opacity-0":l.value||a.value,"opacity-100":!l.value&&!a.value}]),loading:"lazy",onLoad:i,onError:n},null,42,Ce),s[2]||(s[2]=y("div",{class:"photo-inner-border absolute inset-0 rounded-xl pointer-events-none"},null,-1))]))}}),[["__scopeId","data-v-32d70d49"]]),Ae={class:"flex flex-col space-y-2"},Pe={class:"photo-group-header sticky top-12 z-[3] py-2.5 px-1 flex items-center gap-2.5 overflow-hidden group"},Me={class:"font-semibold text-[15px] text-apple-text-dark dark:text-gray-100 tracking-tight"},ze={class:"text-sm text-apple-gray dark:text-gray-500"},Te={class:"photo-count-badge"},De=U(v({__name:"PhotoGroup",props:{group:{type:Object,default:()=>{},required:!0}},setup(t){const l=t,{toggleSelectAllByGroup:a}=e(),o=e(),{t:s}=b(),i=x(220),r=B("columnWidth",i),c=[s("Sunday"),s("Monday"),s("Tuesday"),s("Wednesday"),s("Thursday"),s("Friday"),s("Saturday")],u=m((()=>l.group.photos.map((e=>({...e,id:e.key}))))),d=m((()=>o.selectionMode||o.selections.length>0||l.group.selected));return(e,t)=>(f(),h("div",Ae,[y("div",Pe,[C(S(P),{icon:l.group.selected?"fa-solid fa-circle-check":"fa-regular fa-circle",size:"xl",class:z(["cursor-pointer transition-all duration-200 select-none",l.group.selected?"text-violet-500":d.value?"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300":"opacity-0 group-hover:opacity-100 text-gray-400 hover:text-gray-600 dark:text-gray-500"]),"aria-label":S(s)("Select all in group"),role:"checkbox","aria-checked":l.group.selected,onClick:t[0]||(t[0]=()=>S(a)(l.group.date))},null,8,["icon","class","aria-label","aria-checked"]),y("span",Me,T(S(n)(l.group.date).format("L")),1),y("span",ze,T(c[S(n)(l.group.date).day()]),1),y("span",Te,T(l.group.photos.length),1)]),C(G,{items:u.value,"column-width":S(r),gap:12,"uniform-ratio":1,showLoadMore:!1},{default:I((({item:e})=>[C(be,{photo:e},{default:I((()=>[C(Se,{src:e.src,alt:e.name||"",width:e.width,height:e.height,"retry-text":S(s)("Retry")},null,8,["src","alt","width","height","retry-text"])])),_:2},1032,["photo"])])),_:1},8,["items","column-width"])]))}}),[["__scopeId","data-v-21670cf6"]]),Ie={key:0,class:"flex flex-col items-center justify-center py-20 px-4"},je={class:"w-16 h-16 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center mb-4"},Ee={class:"text-gray-600 dark:text-gray-300 font-medium mb-1"},$e={class:"text-gray-400 dark:text-gray-500 text-sm"},Le={key:2,class:"flex justify-center py-10"},Ue=v({__name:"PhotoList",setup(t){const l=e(),{t:a}=b();return(e,t)=>(f(),h(_,null,[S(l).isLoading||0!==S(l).groups.length?(f(!0),h(_,{key:1},N(S(l).groups,(e=>(f(),O(De,{group:e,key:e.date},null,8,["group"])))),128)):(f(),h("div",Ie,[y("div",je,[C(S(P),{icon:"fa-solid fa-cloud-arrow-up",class:"text-2xl text-gray-400 dark:text-gray-500"})]),y("p",Ee,T(S(a)("No photos yet")),1),y("p",$e,T(S(a)("Upload your first photo to get started")),1)])),S(l).isLoading?(f(),h("div",Le,[C(S(Q),{size:25})])):A("",!0)],64))}}),Be=["aria-label"],Ne=v({__name:"PhotoOperates",setup(t){const l=e();return(e,t)=>(f(),h("div",{class:z(["flex flex-row items-center fixed bottom-4 left-1/2 p-2 md:p-3 z-[3] bg-white/90 dark:bg-black/85 backdrop-blur-md border border-gray-200 dark:border-slate-600 transition-all duration-300 rounded-full shadow-lg gap-2 md:gap-3",S(l).selections.length>0?"-translate-x-1/2 translate-y-0 opacity-100":"-translate-x-1/2 translate-y-20 opacity-0 pointer-events-none"]),role:"toolbar","aria-label":e.$t("Photo operations")},[D(e.$slots,"default")],10,Be))}}),Oe=v({__name:"PhotoCopyLink",setup(l){const o=e(),s=t(),{t:i}=b(),n=[{label:"Url",key:"url"},{label:"Html",key:"html"},{label:"BBCode",key:"bbcode"},{label:"Markdown",key:"markdown"},{label:"Markdown with link",key:"markdown_with_link"},{label:"Thumbnail url",key:"thumbnail_url"}];function r(e){0!==o.selections.length?o.copyLink(e).then((()=>{s.success(i("Copy successful"))})).catch((()=>{s.error(i("Copy failed"))})):s.warning(i("Please select photos first"))}return(e,t)=>(f(),O(S(a),{placement:"top",trigger:"hover",size:"small","show-arrow":"",options:n,onSelect:r},{default:I((()=>[C(S(W),{tertiary:"",circle:"",size:"small",type:"default",title:e.$t("Copy Link"),"aria-label":e.$t("Copy Link")},{icon:I((()=>[C(S(P),{icon:"fa-solid fa-copy"})])),_:1},8,["title","aria-label"])])),_:1}))}}),We=v({__name:"PhotoCancel",setup(t){const l=e();return(e,t)=>(f(),O(S(W),{tertiary:"",circle:"",size:"small",type:"default",title:e.$t("Deselect"),"aria-label":e.$t("Deselect")},{icon:I((()=>[C(S(P),{icon:"fa-solid fa-times",onClick:t[0]||(t[0]=e=>S(l).unselectAll())})])),_:1},8,["title","aria-label"]))}}),Ke=v({__name:"PhotoDelete",setup(l){const a=e(),o=t(),{t:s}=b();function i(){a.deleteSelectedPhotos().then((()=>{o.success(s("Deleted successfully"))}))}return(e,t)=>(f(),O(S(Z),{placement:"top",onPositiveClick:i},{trigger:I((()=>[C(S(W),{quaternary:"",circle:"",size:"small",type:"error",title:e.$t("Delete Selected Items"),"aria-label":e.$t("Delete Selected Items")},{icon:I((()=>[C(S(P),{icon:"fa-solid fa-trash-alt"})])),_:1},8,["title","aria-label"])])),default:I((()=>[K(" "+T(e.$t("Are you sure you want to delete the selected {count} photos?",{count:S(a).selections.length})),1)])),_:1}))}}),Re={key:0,class:"flex flex-col space-y-4"},Fe={key:0,class:"text-sm dark:text-gray-300 mb-2 text-center p-2 bg-gray-50 dark:bg-gray-800 rounded"},He={key:1,class:"mb-4 bg-gray-50 dark:bg-gray-800 p-3 rounded"},Ve={class:"text-sm font-medium mb-2 text-gray-700 dark:text-gray-300"},qe={class:"flex flex-wrap gap-4"},Ge={class:"flex items-center gap-2"},Ye={class:"text-sm"},Je={class:"flex items-center gap-2"},Xe={class:"text-sm"},Qe={class:"flex items-center gap-2"},Ze={class:"text-sm"},et={class:"flex items-center gap-2"},tt={class:"text-sm"},lt={class:"flex justify-end space-x-2"},at=v({__name:"PhotoEdit",setup(l){const a=e(),o=m((()=>a.selections)),s=m((()=>o.value.length>1)),i=m((()=>a.selections[0]||{tags:[]})),n=x(),v=x({}),g={},k=t(),{t:w}=b(),M=x({name:!s.value,intro:!s.value,is_public:!s.value,tags:!s.value});function z(){var e;if(0===o.value.length)return;const{name:t,intro:l,is_public:a}=i.value,n=(null==(e=i.value.tags)?void 0:e.map((e=>e.name)))||[];v.value={name:t,intro:l,is_public:a,tags:n},M.value={name:!s.value,intro:!s.value,is_public:!s.value,tags:!s.value}}async function D(){const e={ids:o.value.map((e=>e.id))};M.value.name&&(e.name=v.value.name),M.value.intro&&(e.intro=v.value.intro),M.value.is_public&&(e.is_public=v.value.is_public),M.value.tags&&(e.tags=v.value.tags),await V({body:e}).then((()=>{k.success(w("Successfully updated")),a.setEditModalActive(!1),o.value.forEach((e=>{M.value.name&&(e.name=v.value.name),M.value.intro&&(e.intro=v.value.intro),M.value.is_public&&(e.is_public=v.value.is_public),M.value.tags&&(e.tags=v.value.tags.map((e=>({name:e}))))}))})).catch((e=>{k.error(w("Update failed"))}))}return R((()=>{z()})),L((()=>a.editModalActive),(e=>{e&&$((()=>{z()}))})),(e,t)=>(f(),h(_,null,[(f(),O(F,{to:"body"},[C(S(H),{show:S(a).editModalActive,"onUpdate:show":t[9]||(t[9]=e=>S(a).editModalActive=e),title:s.value?S(w)("Batch Edit Information"):S(w)("Edit Information"),preset:"card",size:"small",bordered:!1,class:"max-w-screen-sm mx-4 md:mx-auto","mask-closable":!1},{action:I((()=>[y("div",lt,[C(S(W),{tertiary:"",type:"default",onClick:t[8]||(t[8]=e=>S(a).setEditModalActive(!1))},{default:I((()=>[K(T(S(w)("Cancel")),1)])),_:1}),C(S(W),{tertiary:"",type:"primary",onClick:D},{default:I((()=>[K(T(S(w)("Save")),1)])),_:1})])])),default:I((()=>[o.value.length>0?(f(),h("div",Re,[C(S(r),{ref_key:"formRef",ref:n,model:v.value,rules:g},{default:I((()=>[s.value?(f(),h("div",Fe,T(S(w)("Selected {count} photos for batch editing",{count:o.value.length})),1)):A("",!0),s.value?(f(),h("div",He,[y("div",Ve,T(S(w)("Select fields to update"))+":",1),y("div",qe,[y("div",Ge,[C(S(c),{value:M.value.name,"onUpdate:value":t[0]||(t[0]=e=>M.value.name=e),size:"small"},null,8,["value"]),y("span",Ye,T(S(w)("Custom Name")),1)]),y("div",Je,[C(S(c),{value:M.value.intro,"onUpdate:value":t[1]||(t[1]=e=>M.value.intro=e),size:"small"},null,8,["value"]),y("span",Xe,T(S(w)("Description")),1)]),y("div",Qe,[C(S(c),{value:M.value.tags,"onUpdate:value":t[2]||(t[2]=e=>M.value.tags=e),size:"small"},null,8,["value"]),y("span",Ze,T(S(w)("Tags")),1)]),y("div",et,[C(S(c),{value:M.value.is_public,"onUpdate:value":t[3]||(t[3]=e=>M.value.is_public=e),size:"small"},null,8,["value"]),y("span",tt,T(S(w)("Is Public")),1)])])])):A("",!0),C(S(u),{label:S(w)("Custom Name"),path:"name"},{default:I((()=>[C(S(d),{value:v.value.name,"onUpdate:value":t[4]||(t[4]=e=>v.value.name=e),disabled:s.value&&!M.value.name,placeholder:s.value&&!M.value.name?S(w)("Field not selected"):""},null,8,["value","disabled","placeholder"])])),_:1},8,["label"]),C(S(u),{label:S(w)("Description"),path:"intro"},{default:I((()=>[C(S(d),{resizable:"",type:"textarea",value:v.value.intro,"onUpdate:value":t[5]||(t[5]=e=>v.value.intro=e),disabled:s.value&&!M.value.intro,placeholder:s.value&&!M.value.intro?S(w)("Field not selected"):""},null,8,["value","disabled","placeholder"])])),_:1},8,["label"]),C(S(u),{label:S(w)("Tags"),path:"tags"},{default:I((()=>[C(S(p),{value:v.value.tags,"onUpdate:value":t[6]||(t[6]=e=>v.value.tags=e),disabled:s.value&&!M.value.tags,placeholder:s.value&&!M.value.tags?S(w)("Field not selected"):""},null,8,["value","disabled","placeholder"])])),_:1},8,["label"]),C(S(u),{label:S(w)("Is Public"),path:"is_public"},{default:I((()=>[C(S(c),{value:v.value.is_public,"onUpdate:value":t[7]||(t[7]=e=>v.value.is_public=e),disabled:s.value&&!M.value.is_public},null,8,["value","disabled"])])),_:1},8,["label"])])),_:1},8,["model"])])):A("",!0)])),_:1},8,["show","title"])])),C(S(W),{tertiary:"",circle:"",size:"small",type:"default",title:o.value.length>1?S(w)("Batch Edit Information"):S(w)("Edit Information"),"aria-label":o.value.length>1?S(w)("Batch Edit Information"):S(w)("Edit Information"),onClick:t[10]||(t[10]=e=>S(a).setEditModalActive(!0))},{icon:I((()=>[C(S(P),{icon:"fa-solid fa-edit"})])),_:1},8,["title","aria-label"])],64))}}),ot=v({__name:"PhotoSelect",setup(t){const l=e();return(e,t)=>(f(),O(S(W),{tertiary:"",circle:"",size:"small",type:"default",title:S(l).isAllSelected?e.$t("Deselect All"):e.$t("Select All"),"aria-label":S(l).isAllSelected?e.$t("Deselect All"):e.$t("Select All")},{icon:I((()=>[C(S(P),{icon:"fa-solid fa-"+(S(l).isAllSelected?"check-double":"check"),onClick:t[0]||(t[0]=()=>{S(l).isAllSelected?S(l).unselectAll():S(l).selectAll()})},null,8,["icon"])])),_:1},8,["title","aria-label"]))}});export{Se as P,Ue as _,Ne as a,We as b,ot as c,Oe as d,at as e,Ke as f};
