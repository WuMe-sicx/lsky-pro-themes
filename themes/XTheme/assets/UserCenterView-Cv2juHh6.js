import{d as e,b as a,f as t,g as s,z as l,y as o,u as r,m as c,j as n,a as i,J as u,c as d,o as v,s as m,v as x,ca as p,I as b,cb as h,c9 as f,D as g,e as k,h as z,n as w,A as y,F as _,x as j,cc as C,cd as $}from"./index-Ctnlk-aF.js";import{E as M}from"./ExploreImage-DuMNEv2N.js";import{n as V,a as A,L as H,a4 as L,c as q,a5 as B,b as D}from"./Layout-B7WTefT3.js";import{W as P}from"./WaterfallLayout-Cc-Ll5Bs.js";import{N as U}from"./Upload-B8hcdnl-.js";const I="/assets/empty-image-Dvbju7a-.png",E={class:"flex overflow-hidden rounded-md h-[200px]"},N={class:"flex basis-2/3 border-r shrink-0"},S=["src"],W={class:"flex basis-1/3 flex-col"},F=["src"],J=["src"],O={class:"flex flex-col w-full mt-4 space-y-2"},Q={class:"text-base truncate"},T={class:"text-md text-gray-500 dark:text-gray-400"},G=e({__name:"ExploreAlbum",props:{album:{type:Object,required:!0,default:()=>{}}},setup(e){const r=e;return(e,c)=>(t(),a("div",{class:"flex flex-col w-full hover:opacity-75 transition-all cursor-pointer",onClick:c[0]||(c[0]=()=>{return e=`/explore/albums/${r.album.id}`,void window.open(e,"_blank");var e})},[s("div",E,[s("div",N,[s("img",{src:r.album.covers[0]||l(I),alt:"Album Cover",class:"w-full h-full object-cover"},null,8,S)]),s("div",W,[s("img",{src:r.album.covers[1]||l(I),alt:"Album Cover",class:"w-full h-full border-b object-cover shrink-0 overflow-hidden basis-1/2"},null,8,F),s("img",{src:r.album.covers[2]||l(I),alt:"Album Cover",class:"w-full h-full object-cover shrink-0 overflow-hidden basis-1/2"},null,8,J)])]),s("div",O,[s("p",Q,o(r.album.name),1),s("p",T,o(e.$t("{count} photos",{count:l(V).format(r.album.photo_count||0)}))+" · Curated by "+o(r.album.user.name),1)])]))}}),K={class:"min-h-screen bg-white dark:bg-zinc-950"},R={class:"relative"},X={key:0,class:"absolute inset-0 bg-black/20"},Y={key:1,class:"absolute top-4 right-4 z-10"},Z={class:"flex items-center gap-2 px-3 py-2 rounded-lg bg-white/90 dark:bg-zinc-800/90 text-zinc-700 dark:text-zinc-300 text-sm font-medium hover:bg-white dark:hover:bg-zinc-700 transition-colors shadow-sm"},ee={class:"max-w-screen-xl mx-auto px-4 sm:px-6"},ae={class:"relative -mt-16 sm:-mt-20 pb-6"},te={class:"flex flex-col sm:flex-row items-center sm:items-end gap-4"},se={class:"relative"},le=["src","alt"],oe={class:"flex-1 text-center sm:text-left pb-2"},re={class:"text-2xl sm:text-3xl font-bold text-zinc-900 dark:text-zinc-100"},ce={class:"text-zinc-500 dark:text-zinc-400 mt-1"},ne={key:0,class:"text-zinc-600 dark:text-zinc-400 mt-2 max-w-lg"},ie={class:"flex items-center gap-6 sm:gap-8"},ue={class:"text-center"},de={class:"text-xl sm:text-2xl font-bold text-zinc-900 dark:text-zinc-100"},ve={class:"text-xs text-zinc-500 dark:text-zinc-400"},me={class:"text-center"},xe={class:"text-xl sm:text-2xl font-bold text-zinc-900 dark:text-zinc-100"},pe={class:"text-xs text-zinc-500 dark:text-zinc-400"},be={class:"sticky top-0 z-20 bg-white/80 dark:bg-zinc-950/80 backdrop-blur-md border-b border-zinc-100 dark:border-zinc-900"},he={class:"max-w-screen-xl mx-auto px-4 sm:px-6"},fe={class:"flex items-center gap-1"},ge={class:"flex items-center gap-2"},ke={class:"text-xs text-zinc-400"},ze={key:0,class:"absolute bottom-0 left-0 right-0 h-0.5 bg-zinc-900 dark:bg-zinc-100"},we={class:"flex items-center gap-2"},ye={class:"text-xs text-zinc-400"},_e={key:0,class:"absolute bottom-0 left-0 right-0 h-0.5 bg-zinc-900 dark:bg-zinc-100"},je={class:"max-w-screen-xl mx-auto"},Ce={key:0,class:"px-2 sm:px-4 py-6"},$e={key:1,class:"flex flex-col items-center justify-center py-24"},Me={class:"text-zinc-500 dark:text-zinc-400 text-sm"},Ve={key:1,class:"px-4 sm:px-6 py-6"},Ae={key:0,class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4"},He={key:1,class:"flex flex-col items-center justify-center py-24"},Le={class:"text-zinc-500 dark:text-zinc-400 text-sm"},qe={key:2,class:"flex justify-center py-8"},Be={class:"flex items-center gap-2 text-zinc-400"},De={class:"text-sm"},Pe=e({__name:"UserCenterView",setup(e){var V,I;const E=b(),N=n(),S=A(),W=r(),F=c();W.configs&&!(null==(I=null==(V=W.configs)?void 0:V.app)?void 0:I.enable_explore)&&N.replace("/404");const J=i({}),O=i("photo"),Q=i([]),T=i(""),Pe=i(1),Ue=i(!1),Ie=i(!1),Ee=i(Date.now());async function Ne(e={}){var a,t,s,l,o;if(!Ue.value&&!Ie.value){Ue.value=!0;try{const r={photo:f,album:h},c=await r[O.value]({query:{q:T.value,page:Pe.value,username:J.value.username,per_page:20,...e}});if("error"===(null==(a=c.data)?void 0:a.status))return S.error(null==(t=c.data)?void 0:t.message),void(Ue.value=!1);const n=(null==(s=c.data)?void 0:s.data.data)||[];Q.value.push(...n),Ie.value=(null==(l=c.data)?void 0:l.data.meta.last_page)===(null==(o=c.data)?void 0:o.data.meta.current_page),n.length>0&&Pe.value++}catch(r){}finally{Ue.value=!1}}}function Se(e){const a=e.target;100+a.scrollTop+a.clientHeight>=a.scrollHeight&&(Ue.value||Ie.value||Ne())}u(O,(()=>{Q.value=[],T.value="",Pe.value=1,Ue.value=!1,Ie.value=!1,Ne()}));const We=d((()=>{var e;return F.isLoggedIn&&(null==(e=F.profile)?void 0:e.username)===J.value.username}));async function Fe(e){var a,t;try{const s=await C({body:{background:e.file.file}});"success"===(null==(a=s.data)?void 0:a.status)?(S.success("背景图片设置成功"),Ee.value=Date.now(),await F.fetchUserProfile(),await Oe()):S.error((null==(t=s.data)?void 0:t.message)||"设置失败")}catch(s){S.error("设置失败，请重试")}}async function Je(){var e,a;try{const t=await $();"success"===(null==(e=t.data)?void 0:e.status)?(S.success("背景图片已移除"),Ee.value=Date.now(),await F.fetchUserProfile(),await Oe()):S.error((null==(a=t.data)?void 0:a.message)||"移除失败")}catch(t){S.error("移除失败，请重试")}}async function Oe(){var e,a,t;try{const s=await p({path:{username:E.params.username.toString()}});if("error"===(null==(e=s.data)?void 0:e.status))return N.back(),S.error(null==(a=s.data)?void 0:a.message);J.value=null==(t=s.data)?void 0:t.data,Ne()}catch(s){}}return v((()=>{Oe()})),(e,r)=>(t(),m(H,{"toggle-header":!1,"show-footer":!0,"header-title":e.$t("Square"),"on-scroll":Se},{default:x((()=>[s("div",K,[s("div",R,[s("div",{class:"h-48 sm:h-64 md:h-80 bg-zinc-100 dark:bg-zinc-900",style:g(J.value.background_url?{backgroundImage:`url(${J.value.background_url}?t=${Ee.value})`,backgroundSize:"cover",backgroundPosition:"center"}:{})},[J.value.background_url?(t(),a("div",X)):k("",!0),We.value?(t(),a("div",Y,[J.value.background_url?(t(),a("button",{key:1,onClick:Je,class:"flex items-center gap-2 px-3 py-2 rounded-lg bg-black/40 backdrop-blur-sm text-white text-sm font-medium hover:bg-black/60 transition-colors"},[z(l(q),{component:l(B),size:16},null,8,["component"]),r[3]||(r[3]=s("span",{class:"hidden sm:inline"},"移除背景",-1))])):(t(),m(l(U),{key:0,"show-file-list":!1,accept:"image/*",max:1,"custom-request":Fe},{default:x((()=>[s("button",Z,[z(l(q),{component:l(L),size:16},null,8,["component"]),r[2]||(r[2]=s("span",{class:"hidden sm:inline"},"设置背景",-1))])])),_:1}))])):k("",!0)],4),s("div",ee,[s("div",ae,[s("div",te,[s("div",se,[s("img",{src:l(D).getUserAvatar(J.value.avatar_url),alt:J.value.name,class:"w-28 h-28 sm:w-36 sm:h-36 rounded-full object-cover border-4 border-white dark:border-zinc-950 shadow-lg"},null,8,le)]),s("div",oe,[s("h1",re,o(J.value.name),1),s("p",ce,"@"+o(J.value.username),1),J.value.intro?(t(),a("p",ne,o(J.value.intro),1)):k("",!0)]),s("div",ie,[s("div",ue,[s("div",de,o(J.value.photo_count||0),1),s("div",ve,o(e.$t("Photo")),1)]),s("div",me,[s("div",xe,o(J.value.album_count||0),1),s("div",pe,o(e.$t("Album")),1)])])])])])]),s("div",be,[s("div",he,[s("div",fe,[s("button",{onClick:r[0]||(r[0]=e=>O.value="photo"),class:w(["relative px-4 py-4 text-sm font-medium transition-colors","photo"===O.value?"text-zinc-900 dark:text-zinc-100":"text-zinc-500 dark:text-zinc-400 hover:text-zinc-700 dark:hover:text-zinc-300"])},[s("div",ge,[r[4]||(r[4]=s("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),y(" "+o(e.$t("Photo"))+" ",1),s("span",ke,o(J.value.photo_count>999?"999+":J.value.photo_count),1)]),"photo"===O.value?(t(),a("div",ze)):k("",!0)],2),s("button",{onClick:r[1]||(r[1]=e=>O.value="album"),class:w(["relative px-4 py-4 text-sm font-medium transition-colors","album"===O.value?"text-zinc-900 dark:text-zinc-100":"text-zinc-500 dark:text-zinc-400 hover:text-zinc-700 dark:hover:text-zinc-300"])},[s("div",we,[r[5]||(r[5]=s("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})],-1)),y(" "+o(e.$t("Album"))+" ",1),s("span",ye,o(J.value.album_count>999?"999+":J.value.album_count),1)]),"album"===O.value?(t(),a("div",_e)):k("",!0)],2)])])]),s("div",je,["photo"===O.value?(t(),a("div",Ce,[Q.value.length>0?(t(),m(P,{key:0,items:Q.value.map((e=>({...e,id:e.id}))),"column-width":280,gap:16,"max-aspect-ratio":2.5},{default:x((({item:e})=>[z(M,{photo:e,photos:Q.value},null,8,["photo","photos"])])),_:1},8,["items"])):Ue.value?k("",!0):(t(),a("div",$e,[r[6]||(r[6]=s("div",{class:"w-20 h-20 mb-4 rounded-full bg-zinc-100 dark:bg-zinc-800 flex items-center justify-center"},[s("svg",{class:"w-8 h-8 text-zinc-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})])],-1)),s("p",Me,o(e.$t("No photos yet")),1)]))])):k("",!0),"album"===O.value?(t(),a("div",Ve,[Q.value.length>0?(t(),a("div",Ae,[(t(!0),a(_,null,j(Q.value,(e=>(t(),m(G,{album:e,key:e.id},null,8,["album"])))),128))])):Ue.value?k("",!0):(t(),a("div",He,[r[7]||(r[7]=s("div",{class:"w-20 h-20 mb-4 rounded-full bg-zinc-100 dark:bg-zinc-800 flex items-center justify-center"},[s("svg",{class:"w-8 h-8 text-zinc-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})])],-1)),s("p",Le,o(e.$t("No albums yet")),1)]))])):k("",!0),Ue.value?(t(),a("div",qe,[s("div",Be,[r[8]||(r[8]=s("svg",{class:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),s("span",De,o(e.$t("Loading"))+"...",1)])])):k("",!0)])])])),_:1},8,["header-title"]))}});export{Pe as default};
