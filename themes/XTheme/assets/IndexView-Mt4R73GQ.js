import{d as e,i as a,a as t,c as l,o as s,J as r,b as n,f as o,g as i,e as c,h as d,bD as u,c6 as v,B as p,n as g,A as h,y as x,F as k,x as z,T as m,v as b,c7 as f,I as w,j as y,c8 as _,u as q,s as C,c9 as j}from"./index-Ctnlk-aF.js";import{E as L}from"./ExploreImage-DuMNEv2N.js";import{W as M}from"./WaterfallLayout-Cc-Ll5Bs.js";import{L as B}from"./Layout-B7WTefT3.js";const $={class:"w-full"},S={class:"flex flex-col items-center gap-4"},V={class:"relative w-full max-w-2xl"},H={class:"relative"},A=["placeholder"],E={key:0,class:"absolute -top-0.5 -right-0.5 w-2 h-2 bg-zinc-900 dark:bg-zinc-100 rounded-full"},I={key:0,class:"flex flex-wrap items-center justify-center gap-2"},T={key:0,class:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-zinc-100 dark:bg-zinc-800 text-sm text-zinc-700 dark:text-zinc-300"},U=["onClick"],P={key:1,class:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-zinc-100 dark:bg-zinc-800 text-sm text-zinc-700 dark:text-zinc-300"},W={key:0,class:"w-full max-w-2xl"},D={class:"p-6 rounded-xl bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800"},F={class:"space-y-6"},J={class:"block text-xs font-medium text-zinc-500 dark:text-zinc-400 uppercase tracking-wide mb-3"},K={class:"flex flex-wrap gap-2"},N=["onClick"],O={class:"block text-xs font-medium text-zinc-500 dark:text-zinc-400 uppercase tracking-wide mb-3"},R={class:"flex flex-wrap gap-2"},G=["onClick"],Q={class:"flex items-center gap-3 cursor-pointer group"},X={class:"relative"},Y={class:"text-sm text-zinc-600 dark:text-zinc-400 group-hover:text-zinc-900 dark:group-hover:text-zinc-200 transition-colors"},Z=e({__name:"AdvancedExploreSearch",setup(e){const{t:q}=a(),C=w(),j=y(),L=t({q:"",order:"newest",tags:"",has_tags:!1}),M=[{label:q("Latest"),value:"newest"},{label:q("Oldest"),value:"oldest"},{label:q("Most Liked"),value:"most_liked"},{label:q("Least Liked"),value:"least_liked"}],B=t(!1),Z=t([]);function ee(){L.value.q=C.query.q||"",L.value.order=C.query.order||"newest",L.value.tags=C.query.tags||"",L.value.has_tags="1"===C.query.has_tags}const ae=l((()=>{const e=new URLSearchParams;return L.value.q&&e.set("q",L.value.q),L.value.order&&"newest"!==L.value.order&&e.set("order",L.value.order),L.value.tags&&e.set("tags",L.value.tags),L.value.has_tags&&e.set("has_tags","1"),e.toString()})),te=l((()=>"newest"!==L.value.order||L.value.tags||L.value.has_tags));function le(){const e=ae.value;j.push("/explore"+(e?"?"+e:""))}function se(){L.value.order="newest",L.value.tags="",L.value.has_tags=!1,le()}function re(e){const a=L.value.tags.split(",").filter((a=>a.trim()&&a!==e));L.value.tags=a.join(",")}const ne=l((()=>L.value.tags.split(",").filter((e=>e.trim()))));return ee(),s((()=>{!async function(){var e;try{const a=await _({query:{limit:8}});"success"===(null==(e=a.data)?void 0:e.status)&&(Z.value=a.data.data||[])}catch(a){Z.value=[{id:1,name:"风景"},{id:2,name:"人像"},{id:3,name:"动物"},{id:4,name:"建筑"},{id:5,name:"美食"},{id:6,name:"旅行"},{id:7,name:"艺术"},{id:8,name:"自然"}]}}()})),r((()=>C.query),(()=>{ee()})),r((()=>[L.value.order,L.value.tags,L.value.has_tags]),(()=>{le()}),{deep:!0}),(e,a)=>{var t;return o(),n("div",$,[i("div",S,[i("div",V,[i("div",H,[a[6]||(a[6]=i("div",{class:"absolute left-4 top-1/2 -translate-y-1/2 text-zinc-400"},[i("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),u(i("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>L.value.q=e),type:"text",placeholder:e.$t("Search photos..."),class:"w-full h-12 pl-12 pr-12 rounded-xl bg-zinc-100 dark:bg-zinc-800 border-0 text-zinc-900 dark:text-zinc-100 placeholder-zinc-400 dark:placeholder-zinc-500 focus:outline-none focus:ring-2 focus:ring-zinc-900 dark:focus:ring-zinc-100 transition-shadow",onKeyup:p(le,["enter"])},null,40,A),[[v,L.value.q]]),i("button",{onClick:a[1]||(a[1]=e=>B.value=!B.value),class:g(["absolute right-3 top-1/2 -translate-y-1/2 p-2 rounded-lg hover:bg-zinc-200 dark:hover:bg-zinc-700 transition-colors",{"text-zinc-900 dark:text-zinc-100":B.value||te.value,"text-zinc-400":!B.value&&!te.value}])},[a[5]||(a[5]=i("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})],-1)),te.value?(o(),n("span",E)):c("",!0)],2)])]),te.value?(o(),n("div",I,["newest"!==L.value.order?(o(),n("span",T,[h(x(null==(t=M.find((e=>e.value===L.value.order)))?void 0:t.label)+" ",1),i("button",{onClick:a[2]||(a[2]=e=>L.value.order="newest"),class:"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200"},a[7]||(a[7]=[i("svg",{class:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)]))])):c("",!0),(o(!0),n(k,null,z(ne.value,(e=>(o(),n("span",{key:e,class:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-zinc-100 dark:bg-zinc-800 text-sm text-zinc-700 dark:text-zinc-300"},[h(x(e)+" ",1),i("button",{onClick:a=>re(e),class:"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200"},a[8]||(a[8]=[i("svg",{class:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)]),8,U)])))),128)),L.value.has_tags?(o(),n("span",P,[h(x(e.$t("Has tags only"))+" ",1),i("button",{onClick:a[3]||(a[3]=e=>L.value.has_tags=!1),class:"text-zinc-400 hover:text-zinc-600 dark:hover:text-zinc-200"},a[9]||(a[9]=[i("svg",{class:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)]))])):c("",!0),i("button",{onClick:se,class:"text-sm text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-300 underline underline-offset-2"},x(e.$t("Clear all")),1)])):c("",!0),d(m,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"opacity-0 -translate-y-2","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition duration-150 ease-in","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 -translate-y-2"},{default:b((()=>[B.value?(o(),n("div",W,[i("div",D,[i("div",F,[i("div",null,[i("label",J,x(e.$t("Sort by")),1),i("div",K,[(o(),n(k,null,z(M,(e=>i("button",{key:e.value,onClick:a=>L.value.order=e.value,class:g(["px-4 py-2 rounded-lg text-sm font-medium transition-colors",L.value.order===e.value?"bg-zinc-900 dark:bg-zinc-100 text-white dark:text-zinc-900":"bg-white dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 hover:bg-zinc-100 dark:hover:bg-zinc-700 border border-zinc-200 dark:border-zinc-700"])},x(e.label),11,N))),64))])]),i("div",null,[i("label",O,x(e.$t("Popular tags")),1),i("div",R,[(o(!0),n(k,null,z(Z.value,(e=>(o(),n("button",{key:e.id,onClick:a=>ne.value.includes(e.name)?re(e.name):function(e){const a=L.value.tags.split(",").filter((e=>e.trim()));a.includes(e)||(a.push(e),L.value.tags=a.join(","))}(e.name),class:g(["px-4 py-2 rounded-lg text-sm font-medium transition-colors",ne.value.includes(e.name)?"bg-zinc-900 dark:bg-zinc-100 text-white dark:text-zinc-900":"bg-white dark:bg-zinc-800 text-zinc-600 dark:text-zinc-400 hover:bg-zinc-100 dark:hover:bg-zinc-700 border border-zinc-200 dark:border-zinc-700"])},x(e.name),11,G)))),128))])]),i("div",null,[i("label",Q,[i("div",X,[u(i("input",{type:"checkbox","onUpdate:modelValue":a[4]||(a[4]=e=>L.value.has_tags=e),class:"sr-only peer"},null,512),[[f,L.value.has_tags]]),a[10]||(a[10]=i("div",{class:"w-5 h-5 rounded border-2 border-zinc-300 dark:border-zinc-600 peer-checked:border-zinc-900 dark:peer-checked:border-zinc-100 peer-checked:bg-zinc-900 dark:peer-checked:bg-zinc-100 transition-colors"},null,-1)),a[11]||(a[11]=i("svg",{class:"absolute top-0.5 left-0.5 w-4 h-4 text-white dark:text-zinc-900 opacity-0 peer-checked:opacity-100 transition-opacity",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"3"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 13l4 4L19 7"})],-1))]),i("span",Y,x(e.$t("Show only photos with tags")),1)])])])])])):c("",!0)])),_:1})])])}}}),ee={class:"min-h-screen bg-white dark:bg-zinc-950"},ae={class:"sticky top-0 z-[5] bg-white/80 dark:bg-zinc-950/80 backdrop-blur-md border-b border-zinc-100 dark:border-zinc-900"},te={class:"max-w-screen-2xl mx-auto px-4 py-3"},le={class:"max-w-screen-2xl mx-auto"},se={key:0,class:"px-2 sm:px-4 py-6"},re={key:1,class:"flex flex-col items-center justify-center py-32"},ne={class:"text-zinc-500 dark:text-zinc-400 text-sm"},oe={key:2,class:"flex justify-center py-32"},ie={class:"flex items-center gap-2 text-zinc-400"},ce={class:"text-sm"},de=e({__name:"IndexView",setup(e){var a,l;const u=w(),v=y(),p=q();p.configs&&!(null==(l=null==(a=p.configs)?void 0:a.app)?void 0:l.enable_explore)&&v.replace("/404");const g=t([]),h=t({q:"",order:"newest",tags:"",has_tags:!1}),k=t(1),z=t(!1),m=t(!1);async function f(){var e,a,t,l;if(!z.value&&!m.value){z.value=!0;try{const s={page:k.value,per_page:40};h.value.q&&(s.q=h.value.q),h.value.order&&"newest"!==h.value.order&&(s.order=h.value.order),h.value.tags&&(s.tags=h.value.tags),h.value.has_tags&&(s.has_tags=1);const r=await j({query:s});if("error"===(null==(e=r.data)?void 0:e.status))return;const n=(null==(a=r.data)?void 0:a.data.data)||[];g.value.push(...n),n.length>0&&k.value++,m.value=(null==(t=r.data)?void 0:t.data.meta.last_page)===(null==(l=r.data)?void 0:l.data.meta.current_page)}catch(s){}finally{z.value=!1}}}function _(e){const a=e.target;100+a.scrollTop+a.clientHeight>=a.scrollHeight&&(z.value||m.value||f())}function $(){h.value.q=u.query.q||"",h.value.order=u.query.order||"newest",h.value.tags=u.query.tags||"",h.value.has_tags="1"===u.query.has_tags}return s((()=>{$(),f()})),r((()=>u.query),(()=>{g.value=[],k.value=1,z.value=!1,m.value=!1,$(),f(),window.scrollTo(0,0)}),{deep:!0}),(e,a)=>(o(),C(B,{"toggle-header":!1,"show-footer":!0,"header-title":e.$t("Square"),"on-scroll":_},{default:b((()=>[i("div",ee,[i("div",ae,[i("div",te,[d(Z)])]),i("div",le,[g.value.length>0?(o(),n("div",se,[d(M,{items:g.value.map((e=>({...e,id:e.id}))),"column-width":280,gap:16,"max-aspect-ratio":2.5,loading:z.value,"show-load-more":!m.value,onLoadMore:f},{default:b((({item:e})=>[d(L,{photo:e,photos:g.value},null,8,["photo","photos"])])),_:1},8,["items","loading","show-load-more"])])):z.value?c("",!0):(o(),n("div",re,[a[0]||(a[0]=i("div",{class:"w-24 h-24 mb-6 rounded-full bg-zinc-100 dark:bg-zinc-800 flex items-center justify-center"},[i("svg",{class:"w-10 h-10 text-zinc-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[i("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})])],-1)),i("p",ne,x(e.$t("No photos yet")),1)])),z.value&&0===g.value.length?(o(),n("div",oe,[i("div",ie,[a[1]||(a[1]=i("svg",{class:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24"},[i("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),i("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),i("span",ce,x(e.$t("Loading"))+"...",1)])])):c("",!0)])])])),_:1},8,["header-title"]))}});export{de as default};
