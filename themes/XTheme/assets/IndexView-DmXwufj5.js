import{d as e,m as a,i as l,a as t,J as r,o as n,s as i,z as o,C as s,v as u,g as d,h as c,A as p,y as v,E as f,b as m,e as h,F as b,x as y,O as g,f as w,bM as _,bN as k,u as x,c as z,bO as $,I as P,bP as C,j as U,bQ as q,S,bR as A,bS as j,a8 as E,bT as I,bU as N,T as R,n as V,_ as L}from"./index-Ctnlk-aF.js";import{_ as O}from"./Content.vue_vue_type_script_setup_true_lang-CATP0AmL.js";import{a as M,i as B,j as D,l as T,N as F,b as Q,f as W,z as H,o as K,m as Y,c as J,L as G,n as X}from"./Layout-B7WTefT3.js";import{N as Z}from"./Upload-B8hcdnl-.js";import{N as ee}from"./Popconfirm-DM_99shz.js";import{b as ae,a as le,_ as te}from"./PhoneVerifyInput.vue_vue_type_script_setup_true_lang-e--7F6GK.js";import{N as re}from"./Alert-CXqSmTtF.js";const ne={class:"mb-6"},ie={class:"relative group cursor-pointer"},oe={class:"absolute inset-0 rounded-full bg-black/0 group-hover:bg-black/30 transition-colors duration-200 flex items-center justify-center"},se={class:"flex items-center gap-2 text-xs font-medium uppercase tracking-wider text-zinc-400 dark:text-zinc-500 mb-3"},ue={class:"grid grid-cols-1 sm:grid-cols-2 gap-x-4"},de={class:"flex items-center gap-2 text-xs font-medium uppercase tracking-wider text-zinc-400 dark:text-zinc-500 mb-3"},ce={class:"flex items-center gap-2 text-xs font-medium uppercase tracking-wider text-zinc-400 dark:text-zinc-500 mb-3"},pe={class:"grid grid-cols-1 sm:grid-cols-2 gap-x-4"},ve={class:"flex items-center gap-2 text-xs font-medium uppercase tracking-wider text-zinc-400 dark:text-zinc-500 mb-3"},fe={class:"w-full space-y-2"},me={class:"pt-3 border-t border-zinc-100/80 dark:border-zinc-800/50 mt-3"},he=e({__name:"Info",setup(e){var k,x;const z=M(),$=a(),{t:P}=l(),C=t(!1),U=t({}),q=t(null),S=t(null),A={username:{type:"string",required:!0,trigger:["blur","input"],message:P("Please enter your username")},name:{type:"string",required:!0,trigger:["blur","input"],message:P("Please enter a nickname")}},j=async e=>{var a;e.preventDefault(),null==(a=q.value)||a.validate((async e=>{var a,l,t;if(!e){C.value=!0;const e=await _({body:U.value}).finally((()=>C.value=!1));return"error"===(null==(a=e.data)?void 0:a.status)?z.error(null==(l=e.data)?void 0:l.message):(null==(t=S.value)||t.clear(),await $.fetchUserProfile(),C.value=!1,z.success(P("Successfully updated")))}}))},E=e=>{let a;e.fileList.length>0&&(a=e.fileList[0].file),U.value&&(a?U.value.avatar=a:delete U.value.avatar)},I=e=>{for(const a in e)U.value[`interests[${a}]`]=e[a]},N=e=>{for(const a in e)U.value[`socials[${a}]`]=e[a]},R=t((null==(k=$.profile)?void 0:k.interests)||[]),V=t((null==(x=$.profile)?void 0:x.socials)||[]);r(R,(e=>I(e)),{deep:!0}),r(V,(e=>N(e)),{deep:!0});return n((()=>{var e,a,l,t,r,n,i,o;U.value={name:null==(e=$.profile)?void 0:e.name,username:null==(a=$.profile)?void 0:a.username,tagline:null==(l=$.profile)?void 0:l.tagline,bio:(null==(t=$.profile)?void 0:t.bio)||"",url:(null==(r=$.profile)?void 0:r.url)||"",company:(null==(n=$.profile)?void 0:n.company)||"",company_title:(null==(i=$.profile)?void 0:i.company_title)||"",location:null==(o=$.profile)?void 0:o.location},I(R.value),N(V.value)})),(e,a)=>(w(),i(o(B),{ref_key:"formRef",ref:q,"label-placement":"top",model:U.value,rules:A,onSubmit:s(j,["prevent"])},{default:u((()=>[d("div",ne,[c(o(D),{label:e.$t("Avatar"),path:"avatar"},{default:u((()=>[c(o(Z),{ref_key:"uploadRef",ref:S,"list-type":"image","default-upload":!1,accept:".png,.jpg,.jpeg,.gif",max:1,name:"avatar",onChange:E,"with-credentials":""},{default:u((()=>{var a;return[c(o(T),{trigger:"hover",placement:"right",disabled:Boolean(null==(a=U.value)?void 0:a.avatar)},{trigger:u((()=>{var e;return[d("div",ie,[c(o(F),{round:"",src:o(Q).getUserAvatar(null==(e=o($).profile)?void 0:e.avatar_url),class:"w-20 h-20"},null,8,["src"]),d("div",oe,[c(o(f),{icon:["fas","camera"],class:"w-5 h-5 text-white opacity-0 group-hover:opacity-100 transition-opacity duration-200"})])])]})),default:u((()=>[p(v(e.$t("Click to upload a new avatar. It will take effect after saving."))+" ",1)])),_:1},8,["disabled"])]})),_:1},512)])),_:1},8,["label"])]),d("h3",se,[c(o(f),{icon:["far","user"],class:"w-3.5 h-3.5"}),p(" "+v(e.$t("Account")),1)]),d("div",ue,[c(o(D),{label:e.$t("Username"),path:"username"},{default:u((()=>[c(o(W),{value:U.value.username,"onUpdate:value":a[0]||(a[0]=e=>U.value.username=e),maxlength:20,placeholder:e.$t("Please enter your username")},null,8,["value","placeholder"])])),_:1},8,["label"]),c(o(D),{label:e.$t("Nickname"),path:"name"},{default:u((()=>[c(o(W),{value:U.value.name,"onUpdate:value":a[1]||(a[1]=e=>U.value.name=e),maxlength:20,placeholder:e.$t("Please enter a nickname within 20 characters")},null,8,["value","placeholder"])])),_:1},8,["label"])]),a[10]||(a[10]=d("div",{class:"h-px bg-zinc-100/80 dark:bg-zinc-800/50 my-5"},null,-1)),d("h3",de,[c(o(f),{icon:["far","address-card"],class:"w-3.5 h-3.5"}),p(" "+v(e.$t("About")),1)]),c(o(D),{label:e.$t("Personal Signature"),path:"tagline"},{default:u((()=>[c(o(W),{value:U.value.tagline,"onUpdate:value":a[2]||(a[2]=e=>U.value.tagline=e),maxlength:100,placeholder:e.$t("This person is diligent and has written a personal signature")},null,8,["value","placeholder"])])),_:1},8,["label"]),c(o(D),{label:e.$t("Personal Introduction"),path:"bio"},{default:u((()=>[c(o(W),{type:"textarea",value:U.value.bio,"onUpdate:value":a[3]||(a[3]=e=>U.value.bio=e),maxlength:200,autosize:{minRows:3,maxRows:6},placeholder:e.$t("Introduce yourself within 200 characters~")},null,8,["value","placeholder"])])),_:1},8,["label"]),c(o(D),{label:e.$t("Personal Website"),path:"url"},{default:u((()=>[c(o(W),{"input-props":{type:"url"},value:U.value.url,"onUpdate:value":a[4]||(a[4]=e=>U.value.url=e),maxlength:200,placeholder:e.$t("Enter personal website URL")},{prefix:u((()=>[c(o(f),{icon:["fas","globe"],class:"w-3.5 h-3.5 text-zinc-400"})])),_:1},8,["value","placeholder"])])),_:1},8,["label"]),a[11]||(a[11]=d("div",{class:"h-px bg-zinc-100/80 dark:bg-zinc-800/50 my-5"},null,-1)),d("h3",ce,[c(o(f),{icon:["far","building"],class:"w-3.5 h-3.5"}),p(" "+v(e.$t("Work")),1)]),d("div",pe,[c(o(D),{label:e.$t("Company"),path:"company"},{default:u((()=>[c(o(W),{value:U.value.company,"onUpdate:value":a[5]||(a[5]=e=>U.value.company=e),maxlength:80,placeholder:e.$t("Enter company name")},null,8,["value","placeholder"])])),_:1},8,["label"]),c(o(D),{label:e.$t("Position at Company"),path:"company_title"},{default:u((()=>[c(o(W),{value:U.value.company_title,"onUpdate:value":a[6]||(a[6]=e=>U.value.company_title=e),maxlength:20,placeholder:e.$t("Enter your position at the company")},null,8,["value","placeholder"])])),_:1},8,["label"])]),c(o(D),{label:e.$t("Location"),path:"location"},{default:u((()=>[c(o(W),{value:U.value.location,"onUpdate:value":a[7]||(a[7]=e=>U.value.location=e),maxlength:80,placeholder:e.$t("Enter location")},{prefix:u((()=>[c(o(f),{icon:["fas","location-dot"],class:"w-3.5 h-3.5 text-zinc-400"})])),_:1},8,["value","placeholder"])])),_:1},8,["label"]),a[12]||(a[12]=d("div",{class:"h-px bg-zinc-100/80 dark:bg-zinc-800/50 my-5"},null,-1)),d("h3",ve,[c(o(f),{icon:["far","heart"],class:"w-3.5 h-3.5"}),p(" "+v(e.$t("Interests & Social")),1)]),c(o(D),{label:e.$t("Hobbies")},{default:u((()=>[c(o(H),{value:R.value,"onUpdate:value":a[8]||(a[8]=e=>R.value=e),max:9},null,8,["value"])])),_:1},8,["label"]),c(o(D),{label:e.$t("Social Accounts")},{default:u((()=>[d("div",fe,[(w(!0),m(b,null,y(V.value,((a,l)=>(w(),m("div",{key:l,class:"flex items-center gap-2"},[c(o(W),{"input-props":{type:"url",required:!0},value:V.value[l],"onUpdate:value":e=>V.value[l]=e,maxlength:60,placeholder:e.$t("Link to social profile"),clearable:""},{prefix:u((()=>[c(o(f),{icon:"fa-link",class:"w-3.5 h-3.5 text-zinc-400"})])),_:2},1032,["value","onUpdate:value","placeholder"]),c(o(g),{quaternary:"",size:"small",onClick:e=>(e=>{V.value.splice(e,1)})(l),class:"shrink-0"},{icon:u((()=>[c(o(f),{icon:["far","trash-can"],class:"w-3 h-3"})])),_:2},1032,["onClick"])])))),128)),V.value.length<6?(w(),i(o(g),{key:0,onClick:a[9]||(a[9]=e=>{V.value.push("")}),quaternary:"",size:"small",class:"mt-1"},{icon:u((()=>[c(o(f),{icon:["fas","plus"],class:"w-3 h-3"})])),default:u((()=>[p(" "+v(e.$t("Add social link")),1)])),_:1})):h("",!0)])])),_:1},8,["label"]),d("div",me,[c(o(g),{"attr-type":"submit",type:"primary",loading:C.value,size:"medium"},{default:u((()=>[p(v(e.$t("Confirm Save")),1)])),_:1},8,["loading"])])])),_:1,__:[10,11,12]},8,["model"]))}}),be=e({__name:"Password",setup(e){const a=M(),{t:r}=l(),n=t(!1),d=t({current_password:"",password:"",password_confirmation:""}),f=t(null),m={current_password:{type:"string",required:!0,trigger:["blur","input"],message:r("Please enter your old password")},password:{type:"string",required:!0,trigger:["blur","change"],message:r("Please enter a new password")},password_confirmation:{type:"string",required:!0,trigger:["blur","input"],validator:(e,a)=>new Promise(((e,l)=>{a||l(new Error(r("Please confirm your new password"))),a!==d.value.password?l(new Error(r("New password and confirmation do not match"))):e()}))}},h=async e=>{var l;e.preventDefault(),null==(l=f.value)||l.validate((async e=>{var l,t;if(!e){n.value=!0;const e=await k({body:d.value}).finally((()=>n.value=!1));if("error"===(null==(l=e.data)?void 0:l.status))return a.error(null==(t=e.data)?void 0:t.message);a.success(r("Successfully updated. It will take effect next login.")),Object.keys(d.value).forEach((e=>d.value[e]=""))}n.value=!1}))};return(e,a)=>(w(),i(o(B),{ref_key:"formRef",ref:f,"label-placement":"top",model:d.value,rules:m,onSubmit:s(h,["prevent"])},{default:u((()=>[c(o(D),{label:e.$t("Old Password"),path:"current_password"},{default:u((()=>[c(o(W),{type:"password","input-props":{type:"password",required:!0},value:d.value.current_password,"onUpdate:value":a[0]||(a[0]=e=>d.value.current_password=e),placeholder:e.$t("Please enter your old password")},null,8,["value","placeholder"])])),_:1},8,["label"]),c(o(D),{label:e.$t("New Password"),path:"password"},{default:u((()=>[c(o(W),{type:"password",minlength:8,"input-props":{type:"password",required:!0},value:d.value.password,"onUpdate:value":a[1]||(a[1]=e=>d.value.password=e),placeholder:e.$t("Please enter a new password, at least 8 characters")},null,8,["value","placeholder"])])),_:1},8,["label"]),c(o(D),{label:e.$t("Confirm New Password"),path:"password_confirmation"},{default:u((()=>[c(o(W),{type:"password",minlength:8,"input-props":{type:"password",required:!0},value:d.value.password_confirmation,"onUpdate:value":a[2]||(a[2]=e=>d.value.password_confirmation=e),placeholder:e.$t("Please confirm your new password, at least 8 characters")},null,8,["value","placeholder"])])),_:1},8,["label"]),c(o(D),{"show-feedback":!1},{default:u((()=>[c(o(g),{"attr-type":"submit",type:"primary",loading:n.value},{default:u((()=>[p(v(e.$t("Confirm Changes")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["model"]))}}),ye={class:"space-y-6"},ge={class:"text-sm text-zinc-500 dark:text-zinc-400"},we={key:0,class:"space-y-3"},_e={class:"flex items-center gap-2 text-xs font-medium uppercase tracking-wider text-zinc-400 dark:text-zinc-500 pb-2.5 border-b border-zinc-100/80 dark:border-zinc-800/50"},ke={class:"ml-auto text-xs font-normal tabular-nums"},xe={class:"flex items-center gap-3 min-w-0"},ze=["src","alt"],$e={key:1,class:"flex h-9 w-9 items-center justify-center rounded-full bg-zinc-200 dark:bg-zinc-700 shrink-0"},Pe={class:"min-w-0"},Ce={class:"text-sm font-medium text-zinc-900 dark:text-zinc-100 truncate"},Ue={key:0,class:"font-normal text-zinc-500 dark:text-zinc-400"},qe={class:"text-xs text-zinc-500 dark:text-zinc-400 mt-0.5"},Se={key:2},Ae={class:"flex items-center gap-2 text-xs font-medium uppercase tracking-wider text-zinc-400 dark:text-zinc-500 mb-3 pb-2.5 border-b border-zinc-100/80 dark:border-zinc-800/50"},je={class:"flex flex-wrap gap-3"},Ee=e({__name:"Social",setup(e){const a=P(),r=U(),s=M(),_=x(),{t:k}=l(),A=t([]),j=z((()=>{var e;return((null==(e=_.configs)?void 0:e.app.socialites)||[]).filter((e=>-1===A.value.map((e=>e.driver.id)).indexOf(e.id)))}));return n((()=>{$({query:{page:1,per_page:999}}).then((e=>{var a;A.value=(null==(a=e.data)?void 0:a.data.data)||[]})),a.query.driver_id&&a.query.code&&C({path:{id:a.query.driver_id.toString()},body:{code:a.query.code.toString()}}).then((e=>{var a,l;if("error"===(null==(a=e.data)?void 0:a.status))return s.error(null==(l=e.data)?void 0:l.message);$({query:{page:1,per_page:999}}).then((e=>{var a;A.value=(null==(a=e.data)?void 0:a.data.data)||[]})),r.replace("/user/profile?tab=social"),s.success(k("Bound successfully"))}))})),(e,a)=>(w(),m("div",ye,[d("p",ge,v(e.$t("Bind a third-party account to log in directly with it in the future.")),1),A.value.length>0?(w(),m("div",we,[d("h3",_e,[c(o(f),{icon:["fas","link"],class:"w-3.5 h-3.5"}),p(" "+v(e.$t("Bound Accounts"))+" ",1),d("span",ke,v(A.value.length),1)]),(w(!0),m(b,null,y(A.value,(a=>(w(),m("div",{key:a.driver.id,class:"flex items-center justify-between p-3 rounded-xl bg-zinc-50/80 dark:bg-zinc-900/40 border border-zinc-100/80 dark:border-zinc-800/40"},[d("div",xe,[a.avatar?(w(),m("img",{key:0,class:"w-9 h-9 rounded-full object-cover shrink-0",src:a.avatar,alt:a.name||a.nickname},null,8,ze)):(w(),m("div",$e,[c(o(f),{icon:["far","user"],class:"w-4 h-4 text-zinc-500 dark:text-zinc-400"})])),d("div",Pe,[d("p",Ce,[p(v(a.driver.name)+" ",1),a.name||a.nickname?(w(),m("span",Ue," Â· "+v(a.name||a.nickname),1)):h("",!0)]),d("p",qe,v(e.$t("Bound on {date}",{date:o(Y)(a.created_at).format("LL")})),1)])]),c(o(ee),{onPositiveClick:e=>{return l=a.driver.id,void q({path:{id:l.toString()}}).then((e=>{var a,l;if("error"===(null==(a=e.data)?void 0:a.status))return s.error(null==(l=e.data)?void 0:l.message);$().then((e=>{var a;A.value=(null==(a=e.data)?void 0:a.data.data)||[]})),s.success(k("Unbound successfully"))}));var l}},{trigger:u((()=>[c(o(g),{quaternary:"",size:"small",type:"error"},{default:u((()=>[p(v(e.$t("Unbind")),1)])),_:1})])),default:u((()=>[p(v(e.$t("Are you sure you want to unbind this account?"))+" ",1)])),_:2},1032,["onPositiveClick"])])))),128))])):h("",!0),A.value.length<=0?(w(),i(o(K),{key:1,description:e.$t("No third-party accounts bound yet")},null,8,["description"])):h("",!0),j.value.length>0?(w(),m("div",Se,[d("h3",Ae,[c(o(f),{icon:["fas","plus-circle"],class:"w-3.5 h-3.5"}),p(" "+v(e.$t("Available to bind")),1)]),d("div",je,[(w(!0),m(b,null,y(j.value,(e=>(w(),i(o(g),{key:e.id,onClick:a=>(async e=>{var a,l;const t=await S({path:{id:e.id.toString()},query:{redirect_url:`${Q.getWithoutQueryUrl()}?tab=social&driver_id=${e.id}`}});if("error"===(null==(a=t.data)?void 0:a.status))return s.error(null==(l=t.data)?void 0:l.message);window.location.replace(t.data.data.redirect_url)})(e),secondary:"",size:"small"},{icon:u((()=>[c(o(J),{component:o(Q).getSocialiteIcon(e.provider)},null,8,["component"])])),default:u((()=>[p(" "+v(e.name),1)])),_:2},1032,["onClick"])))),128))])])):h("",!0)]))}}),Ie={key:0},Ne={key:0},Re={key:1},Ve=e({__name:"Phone",setup(e){const r=M(),n=a(),s=x(),{t:d}=l(),f=t(!1),b=t(!1),y=t({country_code:"cn",phone:"",code:""}),_=t({code:""}),k=t(""),z=t(""),$=t(null),P=t(null),C={phone:{type:"string",required:!0,trigger:["blur","change"],message:d("Please enter a new mobile number")},code:{type:"string",required:!0,trigger:["blur","change"],message:d("Please enter the mobile verification code")}},U={code:{type:"string",required:!0,trigger:["blur","change"],message:d("Please enter the mobile verification code")}},q=t(d("Send SMS Verification Code")),S=t(!1),E=async()=>{var e,a,l;if(!k.value)return r.error(d("Please enter captcha"));if(!z.value)return r.error(d("Captcha key is missing, please refresh the captcha"));const t=await A({body:{event:"bind",country_code:(null==(e=n.profile)?void 0:e.country_code)||"cn",phone:(null==(a=n.profile)?void 0:a.phone)||"",captcha:k.value,captcha_key:z.value}});"success"===(null==(l=t.data)?void 0:l.status)?(()=>{let e=60;S.value=!0;const a=setInterval((()=>{e--,q.value=d("Resend after {seconds} seconds",{seconds:e}),e<=0&&(S.value=!1,q.value=d("Send SMS Verification Code"),clearInterval(a))}),1e3)})():r.error(t.data.message)},I=async e=>{var a;e.preventDefault(),null==(a=$.value)||a.validate((async e=>{var a,l;if(!e){f.value=!0;const e=await j({body:y.value}).finally((()=>f.value=!1));if("error"===(null==(a=e.data)?void 0:a.status))return r.error(null==(l=e.data)?void 0:l.message);await n.fetchUserProfile(),Object.keys(y.value).forEach((e=>y.value[e]=""))}f.value=!1}))},N=async e=>{var a;e.preventDefault(),null==(a=P.value)||a.validate((async e=>{var a,l,t,i;if(!e){b.value=!0;const e=await j({body:{country_code:(null==(a=n.profile)?void 0:a.country_code)||"cn",phone:(null==(l=n.profile)?void 0:l.phone)||"",code:_.value.code}}).finally((()=>b.value=!1));if("error"===(null==(t=e.data)?void 0:t.status))return r.error(null==(i=e.data)?void 0:i.message);await n.fetchUserProfile(),r.success(d("Phone verified successfully")),_.value.code=""}b.value=!1}))};return(e,a)=>{var l,t,r;return(null==(l=o(s).configs)?void 0:l.app.user_phone_verify)&&(null==(t=o(n).profile)?void 0:t.phone)&&!(null==(r=o(n).profile)?void 0:r.phone_verified_at)?(w(),m("div",Ie,[c(o(B),{ref_key:"verifyFormRef",ref:P,"label-placement":"top",model:_.value,rules:U},{default:u((()=>[c(o(D),null,{default:u((()=>[c(o(re),{type:"warning","show-icon":!1},{default:u((()=>[p(v(e.$t("Your phone number has not been verified. Please verify your phone number for account security and to access all features. Click the button below to send a verification code to your current phone number.")),1)])),_:1})])),_:1}),c(o(D),{label:e.$t("Current Mobile Number")},{default:u((()=>{var e;return[c(o(W),{"default-value":null==(e=o(n).profile)?void 0:e.phone,disabled:""},null,8,["default-value"])]})),_:1},8,["label"]),c(o(D),{label:e.$t("Captcha"),"show-require-mark":""},{default:u((()=>[c(ae,{captcha:k.value,"onUpdate:captcha":a[0]||(a[0]=e=>k.value=e),"captcha-key":z.value,"onUpdate:captchaKey":a[1]||(a[1]=e=>z.value=e)},null,8,["captcha","captcha-key"])])),_:1},8,["label"]),c(o(D),{label:e.$t("Verification Code"),"show-require-mark":""},{default:u((()=>[c(o(W),{value:_.value.code,"onUpdate:value":a[2]||(a[2]=e=>_.value.code=e),"input-props":{required:!0},placeholder:e.$t("Please enter the SMS verification code")},{suffix:u((()=>[c(o(g),{text:"",type:"info",onClick:E,disabled:S.value||!k.value},{default:u((()=>[p(v(q.value),1)])),_:1},8,["disabled"])])),_:1},8,["value","placeholder"])])),_:1},8,["label"]),c(o(D),{"show-feedback":!1},{default:u((()=>[c(o(g),{type:"primary",loading:b.value,onClick:N},{default:u((()=>[p(v(e.$t("Verify Phone")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["model"])])):(w(),i(o(B),{key:1,ref_key:"formRef",ref:$,"label-placement":"top",model:y.value,rules:C},{default:u((()=>{var l;return[(null==(l=o(n).profile)?void 0:l.phone)?(w(),i(o(D),{key:0,label:e.$t("Current Mobile Number")},{default:u((()=>{var e;return[c(o(W),{"default-value":null==(e=o(n).profile)?void 0:e.phone,disabled:""},null,8,["default-value"])]})),_:1},8,["label"])):h("",!0),c(o(D),null,{default:u((()=>[c(o(re),{"show-icon":!1},{default:u((()=>{var a;return[(null==(a=o(n).profile)?void 0:a.phone)?(w(),m("p",Ne,v(e.$t("To change your mobile number, please enter the new number in the form below. A verification code will be sent to the new number. Once verified, you can update your mobile number.")),1)):(w(),m("p",Re,v(e.$t("According to national laws and regulations, the account must be bound to at least one mobile number.")),1))]})),_:1})])),_:1}),c(le,{event:"bind","country-code":y.value.country_code,"onUpdate:countryCode":a[3]||(a[3]=e=>y.value.country_code=e),phone:y.value.phone,"onUpdate:phone":a[4]||(a[4]=e=>y.value.phone=e),code:y.value.code,"onUpdate:code":a[5]||(a[5]=e=>y.value.code=e),size:"medium"},null,8,["country-code","phone","code"]),c(o(D),{"show-feedback":!1},{default:u((()=>[c(o(g),{type:"primary",loading:f.value,onClick:I},{default:u((()=>{var a;return[p(v(e.$t("Confirm"))+v((null==(a=o(n).profile)?void 0:a.phone)?e.$t("Change"):e.$t("Bind")),1)]})),_:1},8,["loading"])])),_:1})]})),_:1},8,["model"]))}}}),Le={key:0},Oe=e({__name:"Email",setup(e){const r=M(),n=a(),s=x(),{t:d}=l(),f=t(!1),h=t(!1),b=t({email:"",code:""}),y=t({code:""}),_=t(""),k=t(""),z=t(null),$=t(null),P={email:{type:"string",required:!0,trigger:["blur","input"],message:d("Please enter a new email")},code:{type:"string",required:!0,trigger:["blur","input"],message:d("Please enter the email verification code")}},C={code:{type:"string",required:!0,trigger:["blur","input"],message:d("Please enter the email verification code")}},U=async e=>{var a;e.preventDefault(),null==(a=z.value)||a.validate((async e=>{var a,l;if(!e){f.value=!0;const e=await I({body:b.value}).finally((()=>f.value=!1));if("error"===(null==(a=e.data)?void 0:a.status))return r.error(null==(l=e.data)?void 0:l.message);await n.fetchUserProfile(),Object.keys(b.value).forEach((e=>b.value[e]=""))}f.value=!1}))},q=async e=>{var a;e.preventDefault(),null==(a=$.value)||a.validate((async e=>{var a,l,t;if(!e){h.value=!0;const e=await I({body:{email:(null==(a=n.profile)?void 0:a.email)||"",code:y.value.code}}).finally((()=>h.value=!1));if("error"===(null==(l=e.data)?void 0:l.status))return r.error(null==(t=e.data)?void 0:t.message);await n.fetchUserProfile(),r.success(d("Email verified successfully")),y.value.code=""}h.value=!1}))},S=t(d("Send Email Verification Code")),A=t(!1);let j=null;E((()=>{j&&clearInterval(j)}));const R=async()=>{var e,a;if(!_.value)return r.error(d("Please enter captcha"));if(!k.value)return r.error(d("Captcha key is missing, please refresh the captcha"));const l=await N({body:{event:"bind",email:(null==(e=n.profile)?void 0:e.email)||"",captcha:_.value,captcha_key:k.value}});"success"===(null==(a=l.data)?void 0:a.status)?(()=>{let e=60;A.value=!0,j&&clearInterval(j),j=setInterval((()=>{e--,S.value=d("Resend after {seconds} seconds",{seconds:e}),e<=0&&(A.value=!1,S.value=d("Send Email Verification Code"),clearInterval(j),j=null)}),1e3)})():r.error(l.data.message)};return(e,a)=>{var l,t,r;return(null==(l=o(s).configs)?void 0:l.app.user_email_verify)&&!(null==(t=o(n).profile)?void 0:t.email_verified_at)&&(null==(r=o(n).profile)?void 0:r.email)?(w(),m("div",Le,[c(o(B),{ref_key:"verifyFormRef",ref:$,"label-placement":"top",model:y.value,rules:C},{default:u((()=>[c(o(D),null,{default:u((()=>[c(o(re),{type:"warning","show-icon":!1},{default:u((()=>[p(v(e.$t("Your email has not been verified. Please verify your email for account security and to access all features. Click the button below to send a verification code to your current email.")),1)])),_:1})])),_:1}),c(o(D),{label:e.$t("Current Email")},{default:u((()=>{var e;return[c(o(W),{"default-value":null==(e=o(n).profile)?void 0:e.email,disabled:""},null,8,["default-value"])]})),_:1},8,["label"]),c(o(D),{label:e.$t("Captcha"),"show-require-mark":""},{default:u((()=>[c(ae,{captcha:_.value,"onUpdate:captcha":a[0]||(a[0]=e=>_.value=e),"captcha-key":k.value,"onUpdate:captchaKey":a[1]||(a[1]=e=>k.value=e)},null,8,["captcha","captcha-key"])])),_:1},8,["label"]),c(o(D),{label:e.$t("Verification Code"),"show-require-mark":""},{default:u((()=>[c(o(W),{value:y.value.code,"onUpdate:value":a[2]||(a[2]=e=>y.value.code=e),"input-props":{required:!0},placeholder:e.$t("Please enter the email verification code")},{suffix:u((()=>[c(o(g),{text:"",type:"info",onClick:R,disabled:A.value||!_.value},{default:u((()=>[p(v(S.value),1)])),_:1},8,["disabled"])])),_:1},8,["value","placeholder"])])),_:1},8,["label"]),c(o(D),{"show-feedback":!1},{default:u((()=>[c(o(g),{type:"primary",loading:h.value,onClick:q},{default:u((()=>[p(v(e.$t("Verify Email")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["model"])])):(w(),i(o(B),{key:1,ref_key:"formRef",ref:z,"label-placement":"top",model:b.value,rules:P},{default:u((()=>[c(o(D),{label:e.$t("Current Email")},{default:u((()=>{var e;return[c(o(W),{"default-value":null==(e=o(n).profile)?void 0:e.email,disabled:""},null,8,["default-value"])]})),_:1},8,["label"]),c(o(D),null,{default:u((()=>[c(o(re),{"show-icon":!1},{default:u((()=>[p(v(e.$t("To change your email address, please enter the new email in the form below. A verification code will be sent to the new email. Once verified, you can update your email.")),1)])),_:1})])),_:1}),c(te,{event:"bind",email:b.value.email,"onUpdate:email":a[3]||(a[3]=e=>b.value.email=e),code:b.value.code,"onUpdate:code":a[4]||(a[4]=e=>b.value.code=e),size:"medium"},null,8,["email","code"]),c(o(D),{"show-feedback":!1},{default:u((()=>[c(o(g),{type:"primary",loading:f.value,onClick:U},{default:u((()=>[p(v(e.$t("Confirm Change")),1)])),_:1},8,["loading"])])),_:1})])),_:1},8,["model"]))}}}),Me={class:"profile-section profile-card overflow-hidden",style:{"--i":"0"}},Be={class:"px-5 pb-5 -mt-10 relative"},De={class:"flex flex-col sm:flex-row sm:items-end gap-4"},Te={class:"flex-1 min-w-0 pb-1"},Fe={class:"flex items-center gap-2 flex-wrap"},Qe={class:"text-lg font-semibold text-zinc-900 dark:text-zinc-100 truncate"},We={class:"text-sm text-zinc-500 dark:text-zinc-400"},He={key:0,class:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-red-50 text-red-600 dark:bg-red-900/30 dark:text-red-400"},Ke={key:0,class:"text-sm text-zinc-500 dark:text-zinc-400 mt-0.5 truncate"},Ye={class:"flex items-center gap-6 mt-4 pt-4 border-t border-zinc-100/80 dark:border-zinc-800/50 text-sm"},Je={class:"flex items-center gap-1.5"},Ge={class:"font-medium text-zinc-900 dark:text-zinc-100 tabular-nums"},Xe={class:"text-zinc-500 dark:text-zinc-400"},Ze={class:"flex items-center gap-1.5"},ea={class:"font-medium text-zinc-900 dark:text-zinc-100 tabular-nums"},aa={class:"text-zinc-500 dark:text-zinc-400"},la={class:"flex items-center gap-1.5"},ta={class:"font-medium text-zinc-900 dark:text-zinc-100 tabular-nums"},ra={class:"text-zinc-500 dark:text-zinc-400"},na={class:"profile-section flex flex-col lg:flex-row gap-6",style:{"--i":"1"}},ia={class:"lg:w-56 shrink-0"},oa={class:"profile-card p-2 lg:sticky lg:top-20"},sa=["onClick"],ua={class:"flex-1 min-w-0"},da={class:"profile-card p-5 md:p-6"},ca={key:"basic"},pa={key:"email"},va={key:"phone"},fa={key:"social"},ma={key:"password"},ha=L(e({__name:"IndexView",setup(e){const l=P(),r=U(),n=x(),s=a(),g=t(l.query.tab?l.query.tab.toString():"basic"),_=z((()=>{var e;const a=[{key:"basic",label:"Personal Information",icon:["far","user"]},{key:"email",label:"Email",icon:["far","envelope"]}];return(null==(e=n.configs)?void 0:e.app.user_phone_verify)&&a.push({key:"phone",label:"Mobile Number",icon:["fas","mobile-screen-button"]}),a.push({key:"social",label:"Third-Party Accounts",icon:["fas","share-nodes"]},{key:"password",label:"Change Password",icon:["fas","lock"]}),a}));return(e,a)=>(w(),i(G,{"header-title":e.$t("Profile"),"toggle-header":!1,"show-footer":!1},{default:u((()=>[c(O,{class:"p-4 md:p-6 lg:p-8 space-y-6"},{default:u((()=>{var l,t,n,i,k,x,z,$,P;return[d("div",Me,[a[0]||(a[0]=d("div",{class:"h-28 md:h-36 bg-gradient-to-br from-zinc-800 to-zinc-900 dark:from-zinc-700 dark:to-zinc-800 relative"},[d("div",{class:"absolute top-0 right-0 w-48 h-48 bg-white/5 rounded-full -translate-y-1/2 translate-x-1/4"}),d("div",{class:"absolute bottom-0 left-1/3 w-32 h-32 bg-white/5 rounded-full translate-y-1/2"})],-1)),d("div",Be,[d("div",De,[c(o(F),{round:"",src:o(Q).getUserAvatar(null==(l=o(s).profile)?void 0:l.avatar_url),class:"w-20 h-20 ring-4 ring-white dark:ring-zinc-900 shrink-0",style:{fontSize:"20px"}},null,8,["src"]),d("div",Te,[d("div",Fe,[d("h1",Qe,v(null==(t=o(s).profile)?void 0:t.name),1),d("span",We,"@"+v(null==(n=o(s).profile)?void 0:n.username),1),(null==(i=o(s).profile)?void 0:i.is_admin)?(w(),m("span",He,[c(o(f),{icon:["fas","shield"],class:"w-2.5 h-2.5"}),p(" "+v(e.$t("Administrator")),1)])):h("",!0)]),(null==(k=o(s).profile)?void 0:k.tagline)?(w(),m("p",Ke,v(null==(x=o(s).profile)?void 0:x.tagline),1)):h("",!0)])]),d("div",Ye,[d("div",Je,[c(o(f),{icon:["far","images"],class:"w-3.5 h-3.5 text-zinc-400"}),d("span",Ge,v(o(X).format((null==(z=o(s).profile)?void 0:z.photo_count)||0)),1),d("span",Xe,v(e.$t("Photo")),1)]),d("div",Ze,[c(o(f),{icon:["far","folder"],class:"w-3.5 h-3.5 text-zinc-400"}),d("span",ea,v(o(X).format((null==($=o(s).profile)?void 0:$.album_count)||0)),1),d("span",aa,v(e.$t("Album")),1)]),d("div",la,[c(o(f),{icon:["fas","share-nodes"],class:"w-3.5 h-3.5 text-zinc-400"}),d("span",ta,v(o(X).format((null==(P=o(s).profile)?void 0:P.share_count)||0)),1),d("span",ra,v(e.$t("Share")),1)])])])]),d("div",na,[d("nav",ia,[d("div",oa,[(w(!0),m(b,null,y(_.value,(a=>(w(),m("button",{key:a.key,onClick:e=>{return l=a.key,g.value=l,void r.replace(`/user/profile?tab=${l}`);var l},class:V(["profile-nav-item",g.value===a.key?"profile-nav-active":"profile-nav-inactive"])},[c(o(f),{icon:a.icon,class:"w-4 h-4 shrink-0"},null,8,["icon"]),d("span",null,v(e.$t(a.label)),1)],10,sa)))),128))])]),d("div",ua,[d("div",da,[c(R,{name:"fade",mode:"out-in"},{default:u((()=>["basic"===g.value?(w(),m("div",ca,[c(he)])):"email"===g.value?(w(),m("div",pa,[c(Oe)])):"phone"===g.value?(w(),m("div",va,[c(Ve)])):"social"===g.value?(w(),m("div",fa,[c(Ee)])):"password"===g.value?(w(),m("div",ma,[c(be)])):h("",!0)])),_:1})])])])]})),_:1})])),_:1},8,["header-title"]))}}),[["__scopeId","data-v-6299ab5c"]]);export{ha as default};
