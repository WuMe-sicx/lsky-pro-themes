import{a as e,L as a,c as l,n as t,m as n}from"./Layout-B7WTefT3.js";import{_ as r}from"./Content.vue_vue_type_script_setup_true_lang-CATP0AmL.js";import{d as u,b as s,f as o,g as c,a as i,u as d,aq as m,i as p,c as v,o as f,s as _,v as y,au as w,I as b,h as g,e as h,z as x,P as $,y as C,A as k,x as z,F as L,O as P}from"./index-Ctnlk-aF.js";import{_ as j}from"./Back.vue_vue_type_script_setup_true_lang-sCWvZjrO.js";import{u as O}from"./order-Dy3mpmSB.js";import{u as M,_ as S}from"./usePayment-CU_7hDca.js";import{N as B,a as N}from"./DescriptionsItem-BnC20TdP.js";import{u as I}from"./composables-DhvgzyQS.js";const D={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},T=[c("path",{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0 0 51.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z",fill:"currentColor"},null,-1),c("path",{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448s448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372s372 166.6 372 372s-166.6 372-372 372z",fill:"currentColor"},null,-1)],U=u({name:"CheckCircleOutlined",render:function(e,a){return o(),s("svg",D,T)}}),H={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},V=[c("path",{d:"M685.4 354.8c0-4.4-3.6-8-8-8l-66 .3L512 465.6l-99.3-118.4l-66.1-.3c-4.4 0-8 3.5-8 8c0 1.9.7 3.7 1.9 5.2l130.1 155L340.5 670a8.32 8.32 0 0 0-1.9 5.2c0 4.4 3.6 8 8 8l66.1-.3L512 564.4l99.3 118.4l66 .3c4.4 0 8-3.5 8-8c0-1.9-.7-3.7-1.9-5.2L553.5 515l130.1-155c1.2-1.4 1.8-3.3 1.8-5.2z",fill:"currentColor"},null,-1),c("path",{d:"M512 65C264.6 65 64 265.6 64 513s200.6 448 448 448s448-200.6 448-448S759.4 65 512 65zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372s372 166.6 372 372s-166.6 372-372 372z",fill:"currentColor"},null,-1)],q=u({name:"CloseCircleOutlined",render:function(e,a){return o(),s("svg",H,V)}}),A={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},F=[c("path",{d:"M464 720a48 48 0 1 0 96 0a48 48 0 1 0-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z",fill:"currentColor"},null,-1)],J=u({name:"WarningOutlined",render:function(e,a){return o(),s("svg",A,F)}}),W={class:"flex flex-col space-y-3 my-6 items-center justify-center"},E={class:"flex space-x-1 w-full items-center"},G=["title"],K={class:"text-red-500"},Q={class:"text-red-500"},R={key:0,class:"text-xs"},X={key:0},Y={class:"flex justify-end space-x-2 w-full mt-4"},Z=u({__name:"DetailView",setup(u){const D=b(),T=e(),H=I(),V=i({}),A=d(),F=O(),Z=m(),{t:ee}=p(),ae=i(""),{handlePayment:le,validatePayment:te}=M();async function ne(){var e,a,l;const t=await w({path:{trade_no:D.params.trade_no.toString()}});if("error"===(null==(e=t.data)?void 0:e.status))return T.error(null==(a=t.data)?void 0:a.message);V.value=null==(l=t.data)?void 0:l.data}const re=v((()=>({cancelled:ee("Cancelled"),unpaid:ee("Unpaid"),paid:ee("Paid")}))),ue=v((()=>({cancelled:"red",unpaid:"yellow",paid:"green"}))),se={cancelled:q,unpaid:J,paid:U};async function oe(){te(ae.value,V.value.amount)&&await le(ae.value,D.params.trade_no.toString())}async function ce(){try{await F.cancelOrder(D.params.trade_no.toString(),H,ee),T.success(ee("Cancellation successful")),ne()}catch(e){}}return f((()=>{ne()})),(e,u)=>(o(),_(a,{"header-title":e.$t("Order Details"),"toggle-header":!1,"show-footer":!1},{default:y((()=>[g(r,{class:"mx-auto p-4 md:p-10 space-y-5"},{default:y((()=>[g(j,{to:"/user/orders"}),g(x($),null,{default:y((()=>[c("div",W,[g(x(l),{size:50,color:ue.value[V.value.status],component:se[V.value.status]},null,8,["color","component"]),c("p",null,C(re.value[V.value.status]),1)])])),_:1}),g(x($),{title:e.$t("Package Snapshot")},{default:y((()=>[g(x(B),{"content-class":"ml-10",columns:1,size:"large","label-placement":"left",separator:""},{default:y((()=>[g(x(N),{label:e.$t("Name")},{default:y((()=>{var e;return[k(C(null==(e=V.value.snapshot)?void 0:e.name),1)]})),_:1},8,["label"]),g(x(N),{label:e.$t("Intro")},{default:y((()=>{var e;return[k(C(null==(e=V.value.snapshot)?void 0:e.intro),1)]})),_:1},8,["label"]),g(x(N),{label:e.$t("Badge")},{default:y((()=>{var e;return[k(C(null==(e=V.value.snapshot)?void 0:e.badge),1)]})),_:1},8,["label"]),g(x(N),{label:e.$t("Privileges")},{default:y((()=>{var e;return[(o(!0),s(L,null,z((null==(e=V.value.snapshot)?void 0:e.features)||[],(e=>(o(),s("div",E,[g(x(l),{size:16,color:"green",component:x(U)},null,8,["component"]),c("p",{class:"w-full truncate",title:e},C(e),9,G)])))),256))]})),_:1},8,["label"])])),_:1})])),_:1},8,["title"]),g(x($),{title:e.$t("Product Information")},{default:y((()=>[g(x(B),{"content-class":"ml-10",columns:1,size:"large","label-placement":"left",separator:""},{default:y((()=>[g(x(N),{label:e.$t("Name")},{default:y((()=>{var e;return[k(C(null==(e=V.value.product)?void 0:e.name),1)]})),_:1},8,["label"]),g(x(N),{label:e.$t("Duration")},{default:y((()=>{var a;return[k(C(e.$t("{minutes} minutes",{minutes:null==(a=V.value.product)?void 0:a.duration})),1)]})),_:1},8,["label"]),g(x(N),{label:e.$t("Price")},{default:y((()=>{var e,a;return[c("p",K,C(x(t).currency(null==(e=V.value.product)?void 0:e.price,null==(a=x(A).configs)?void 0:a.app.currency,x(Z).locale)),1)]})),_:1},8,["label"])])),_:1})])),_:1},8,["title"]),g(x($),{title:e.$t("Order Information")},{default:y((()=>[g(x(B),{"content-class":"ml-10",columns:1,size:"large","label-placement":"left",separator:""},{default:y((()=>[g(x(N),{label:e.$t("Order Number")},{default:y((()=>[k(C(V.value.trade_no),1)])),_:1},8,["label"]),g(x(N),{label:e.$t("Order Status")},{default:y((()=>[k(C(re.value[V.value.status]),1)])),_:1},8,["label"]),V.value.pay_method?(o(),_(x(N),{key:0,label:e.$t("Payment Method")},{default:y((()=>[k(C(V.value.pay_method),1)])),_:1},8,["label"])):h("",!0),V.value.paid_at?(o(),_(x(N),{key:1,label:e.$t("Payment Time")},{default:y((()=>[k(C(x(n)(V.value.paid_at).format("LLL")),1)])),_:1},8,["label"])):h("",!0),V.value.canceled_at?(o(),_(x(N),{key:2,label:e.$t("Cancellation Time")},{default:y((()=>[k(C(x(n)(V.value.canceled_at).format("LLL")),1)])),_:1},8,["label"])):h("",!0),g(x(N),{label:e.$t("Creation Time")},{default:y((()=>[k(C(x(n)(V.value.created_at).format("LLL")),1)])),_:1},8,["label"]),g(x(N),{label:e.$t("Total Price")},{default:y((()=>{var a,l;return[c("p",Q,C(x(t).currency(V.value.amount,null==(a=x(A).configs)?void 0:a.app.currency,x(Z).locale)),1),V.value.deduct_amount>0?(o(),s("span",R,C(e.$t("Use the coupon to deduct {amount}",{amount:x(t).currency(V.value.deduct_amount,null==(l=x(A).configs)?void 0:l.app.currency,x(Z).locale)})),1)):h("",!0)]})),_:1},8,["label"])])),_:1})])),_:1},8,["title"]),"unpaid"===V.value.status?(o(),s("div",X,[g(x($),{title:e.$t("Checkout")},{default:y((()=>[V.value.amount>0?(o(),_(S,{key:0,value:ae.value,"onUpdate:value":u[0]||(u[0]=e=>ae.value=e)},null,8,["value"])):h("",!0),c("div",Y,[V.value.amount>0?(o(),_(x(P),{key:0,type:"primary",disabled:""===ae.value,size:"small",onClick:oe},{default:y((()=>[k(C(e.$t("Proceed to Payment")),1)])),_:1},8,["disabled"])):(o(),_(x(P),{key:1,type:"primary",size:"small",onClick:oe},{default:y((()=>[k(C(e.$t("Pay Now")),1)])),_:1})),g(x(P),{type:"error",size:"small",onClick:ce},{default:y((()=>[k(C(e.$t("Cancel Order")),1)])),_:1})])])),_:1},8,["title"])])):h("",!0)])),_:1})])),_:1},8,["header-title"]))}});export{Z as default};
