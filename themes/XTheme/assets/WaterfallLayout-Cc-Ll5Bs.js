import{a as e,o,q as t,d as a,c as n,J as l,b as i,f as s,g as r,F as u,x as c,cr as v,D as h,n as d,e as p,y as f,ag as m,_ as w,i as g,z as b,C as y,Y as k,h as x,E as M,s as P,v as I,ai as D}from"./index-Ctnlk-aF.js";import{n as _,s as T,aa as L}from"./Layout-B7WTefT3.js";function C(){const a=e(!1);function n(){a.value=window.innerWidth<768}return o((()=>{n(),window.addEventListener("resize",n)})),t((()=>{window.removeEventListener("resize",n)})),{isMobile:a,breakpoint:768}}const E={class:"thumbnail-list"},R=["onClick"],A={class:"thumbnail-wrapper"},$=["src","alt"],W={key:0,class:"thumbnail-loading"},N={key:1,class:"thumbnail-indicator"},Y={class:"thumbnail-index"},S=w(a({__name:"ThumbnailList",props:{photos:{},currentPhotoId:{}},emits:["select"],setup(o,{emit:t}){v((e=>({"70c589d4":`${x.value}px`})));const a=o,w=t,{isMobile:g}=C(),b=e(),y=n((()=>a.currentPhotoId?a.photos.findIndex((e=>e.id===a.currentPhotoId)):0)),k=n((()=>g.value?window.innerWidth<480?50:60:80)),x=n((()=>g.value?window.innerWidth<480?4:6:8));function M(e){return e.thumbnail||e.src}function P(e){b.value&&(e.preventDefault(),b.value.scrollLeft+=e.deltaY)}return l((()=>a.currentPhotoId),(function(){!b.value||y.value<0||m((()=>{const e=b.value,o=k.value+x.value,t=e.clientWidth,a=y.value*o-t/2+o/2;e.scrollTo({left:Math.max(0,a),behavior:"smooth"})}))}),{immediate:!0}),(e,o)=>(s(),i("div",E,[r("div",{ref_key:"scrollContainer",ref:b,class:"thumbnail-container",onWheel:P},[(s(!0),i(u,null,c(e.photos,((t,a)=>(s(),i("div",{key:t.id,class:d(["thumbnail-item",{active:t.id===e.currentPhotoId,loading:!t.src}]),style:h({width:`${k.value}px`,height:`${k.value}px`}),onClick:e=>{return o=t.id,void w("select",o);var o}},[r("div",A,[r("img",{src:M(t),alt:t.name||`Photo ${a+1}`,class:"thumbnail-image",loading:"lazy",draggable:"false"},null,8,$),t.src?p("",!0):(s(),i("div",W,o[0]||(o[0]=[r("div",{class:"thumbnail-spinner"},null,-1)]))),t.id===e.currentPhotoId?(s(),i("div",N)):p("",!0)]),r("div",Y,f(a+1),1)],14,R)))),128))],544)]))}}),[["__scopeId","data-v-6d3ae229"]]),z={class:"drawer-content"},B={class:"drawer-header"},V={class:"drawer-title"},X={class:"drawer-body"},U={key:0,class:"info-section"},O={class:"info-label"},F={class:"info-value"},G={key:0,class:"info-item"},j={class:"info-label"},q={class:"tags-container"},H={key:1,class:"custom-content"},J={key:2,class:"empty-state"},Z={class:"empty-text"},K={class:"drawer-header"},Q={class:"drawer-title"},ee={class:"drawer-body"},oe={key:0,class:"info-section"},te={class:"info-label"},ae={class:"info-value"},ne={key:0,class:"info-item"},le={class:"info-label"},ie={class:"tags-container"},se={key:1,class:"custom-content"},re={key:2,class:"empty-state"},ue={class:"empty-text"},ce=w(a({__name:"PhotoDrawer",props:{show:{type:Boolean},photo:{},config:{}},emits:["update:show"],setup(e,{emit:o}){const t=e,a=o,{isMobile:l}=C(),{t:v,locale:h}=g(),m=n((()=>{var e;return(null==(e=t.config)?void 0:e.title)||v("Photo Viewer Info")})),w=n((()=>{var e,o;return(null==(e=t.photo)?void 0:e.width)&&(null==(o=t.photo)?void 0:o.height)?_.calculateAspectRatio(t.photo.width,t.photo.height):v("Unknown")})),x=n((()=>[{key:"name",label:v("Filename"),formatter:e=>e||v("Unnamed"),show:()=>!0},{key:"extension",label:v("Format"),formatter:e=>T.formatExtension(e),show:()=>!0},{key:"size",label:v("File Size"),formatter:e=>_.fileSize(1024*e),show:()=>!0},{key:"dimensions",label:v("Image Dimensions"),formatter:()=>{var e,o;return _.formatDimensions(null==(e=t.photo)?void 0:e.width,null==(o=t.photo)?void 0:o.height)},show:()=>!0},{key:"aspectRatio",label:v("Aspect Ratio"),formatter:()=>w.value,show:()=>!0},{key:"created_at",label:v("Created Time"),formatter:e=>e?L(e).format("YYYY-MM-DD HH:mm:ss"):v("Unknown"),show:()=>{var e;return!!(null==(e=t.photo)?void 0:e.created_at)}},{key:"is_public",label:v("Visibility"),formatter:e=>v(e?"Public":"Private"),show:()=>{var e;return void 0!==(null==(e=t.photo)?void 0:e.is_public)}}])),M=n((()=>{var e;return((null==(e=t.config)?void 0:e.fields)||x.value).filter((e=>(!e.show||e.show(t.photo))&&t.photo))}));function P(){a("update:show",!1)}return(e,o)=>(s(),i(u,null,[b(l)?p("",!0):(s(),i("div",{key:0,class:"photo-drawer-desktop",onClick:o[0]||(o[0]=y((()=>{}),["stop"]))},[r("div",z,[r("div",B,[r("h3",V,f(m.value),1)]),r("div",X,[e.photo?(s(),i("div",U,[(s(!0),i(u,null,c(M.value,(o=>(s(),i("div",{key:o.key,class:"info-item"},[r("span",O,f(o.label),1),r("span",F,f(o.formatter?o.formatter(e.photo[o.key]):e.photo[o.key]),1)])))),128)),e.photo.tags&&e.photo.tags.length>0?(s(),i("div",G,[r("span",j,f(b(v)("Tags")),1),r("div",q,[(s(!0),i(u,null,c(e.photo.tags,(e=>(s(),i("span",{key:e.id,class:"tag-badge"},f(e.name),1)))),128))])])):p("",!0)])):p("",!0),e.$slots.default?(s(),i("div",H,[k(e.$slots,"default",{},void 0,!0)])):p("",!0),e.photo?p("",!0):(s(),i("div",J,[r("div",Z,f(b(v)("No photo selected")),1)]))])])])),b(l)?(s(),i("div",{key:1,class:d(["photo-drawer-mobile",{show:e.show}]),onClick:P},[r("div",{class:"drawer-content",onClick:o[1]||(o[1]=y((()=>{}),["stop"]))},[r("div",K,[r("h3",Q,f(m.value),1),r("button",{class:"close-button",onClick:P},o[2]||(o[2]=[r("span",{class:"text-white text-lg"},"Ã—",-1)]))]),r("div",ee,[e.photo?(s(),i("div",oe,[(s(!0),i(u,null,c(M.value,(o=>(s(),i("div",{key:o.key,class:"info-item"},[r("span",te,f(o.label),1),r("span",ae,f(o.formatter?o.formatter(e.photo[o.key]):e.photo[o.key]),1)])))),128)),e.photo.tags&&e.photo.tags.length>0?(s(),i("div",ne,[r("span",le,f(b(v)("Tags")),1),r("div",ie,[(s(!0),i(u,null,c(e.photo.tags,(e=>(s(),i("span",{key:e.id,class:"tag-badge"},f(e.name),1)))),128))])])):p("",!0)])):p("",!0),e.$slots.default?(s(),i("div",se,[k(e.$slots,"default",{},void 0,!0)])):p("",!0),e.photo?p("",!0):(s(),i("div",re,[r("div",ue,f(b(v)("No photo selected")),1)]))])])],2)):p("",!0)],64))}}),[["__scopeId","data-v-977d2045"]]),ve={class:"flex gap-2"},he=w(a({__name:"ViewerControls",props:{photo:{},controls:{},showDrawer:{type:Boolean}},emits:["toggle-info","close"],setup(e,{emit:o}){const t=o;function a(){t("toggle-info")}function n(){t("close")}return(e,o)=>{var t,l;return s(),i("div",ve,[k(e.$slots,"default",{photo:e.photo},void 0,!0),(null==(t=e.controls)?void 0:t.showInfo)&&e.showDrawer?(s(),i("button",{key:0,class:"viewer-button info-button",onClick:a},[x(b(M),{icon:"fa-solid fa-info",class:"text-sm text-white"})])):p("",!0),(null==(l=e.controls)?void 0:l.showClose)?(s(),i("button",{key:1,class:"viewer-button close-button",onClick:n},[x(b(M),{icon:"fa-solid fa-times",class:"text-sm text-white"})])):p("",!0)])}}}),[["__scopeId","data-v-00eaa5a9"]]),de=w(a({__name:"ViewerNavigation",props:{showNavigation:{type:Boolean},canGoPrevious:{type:Boolean},canGoNext:{type:Boolean},isVisible:{type:Boolean}},emits:["previous","next"],setup(e,{emit:o}){const t=o;function a(){t("previous")}function n(){t("next")}return(e,o)=>e.showNavigation?(s(),i(u,{key:0},[e.canGoPrevious&&e.isVisible?(s(),i("button",{key:0,class:"photo-viewer-nav photo-viewer-nav-prev",onClick:a,onDblclick:o[0]||(o[0]=y((()=>{}),["stop"]))},[x(b(M),{icon:"fa-solid fa-chevron-left",class:"text-white text-sm"})],32)):p("",!0),e.canGoNext&&e.isVisible?(s(),i("button",{key:1,class:"photo-viewer-nav photo-viewer-nav-next",onClick:n,onDblclick:o[1]||(o[1]=y((()=>{}),["stop"]))},[x(b(M),{icon:"fa-solid fa-chevron-right",class:"text-white text-sm"})],32)):p("",!0)],64)):p("",!0)}}),[["__scopeId","data-v-07bed2a6"]]),pe=["src","alt"],fe=w(a({__name:"ViewerImage",props:{photo:{},imageTransform:{}},emits:["load","error","mousedown"],setup(o,{expose:t,emit:a}){const n=a,l=e(null);function r(){n("load")}function u(){n("error",new Error("Image failed to load"))}function c(e){n("mousedown",e)}return t({imageRef:l}),(e,o)=>{var t,a;return s(),i("img",{ref_key:"imageRef",ref:l,src:null==(t=e.photo)?void 0:t.src,alt:(null==(a=e.photo)?void 0:a.name)||"Photo",class:"photo-viewer-image",style:h(e.imageTransform),draggable:"false",onLoad:r,onError:u,onMousedown:c,onDragstart:o[0]||(o[0]=y((()=>{}),["prevent"])),onDrag:o[1]||(o[1]=y((()=>{}),["prevent"])),onDragend:o[2]||(o[2]=y((()=>{}),["prevent"]))},null,44,pe)}}}),[["__scopeId","data-v-d0a7069e"]]);const me={key:0,class:"photo-viewer"},we={class:"photo-viewer-main"},ge={class:"photo-viewer-top-left"},be={class:"photo-viewer-top-right"},ye={key:0,class:"photo-viewer-bottom"},ke={class:"photo-drawer-container"},xe={key:1,class:"photo-viewer-mobile"},Me={class:"photo-viewer-top-left"},Pe={class:"photo-viewer-top-right"},Ie={key:0,class:"photo-viewer-bottom"},De=w(a({__name:"PhotoViewer",props:{show:{type:Boolean},photos:{},currentPhotoId:{},config:{default:()=>({showThumbnails:!0,showDrawer:!0,drawerConfig:{defaultOpen:!1},controls:{showClose:!0,showInfo:!0,showNavigation:!0}})}},emits:["update:show","update:currentPhotoId","photo:change","photo:load","photo:error","drawer:toggle"],setup(a,{emit:u}){const c=a,v=u,{isMobile:f}=C(),w=function(a,l){const i=e(),s=e(),r=e(1),u=e(0),c=e(0),v=e(!1),h=e({x:0,y:0}),d=e(!1),p=e({x:0,y:0,scale:1}),f=e(0),m=e(0),w=n((()=>{const e=b(l);if(!e)return 0;const o=b(a).findIndex((o=>o.id===e));return-1===o?0:o})),g=n((()=>{const e=b(a);return e[w.value]||e[0]}));function y(){r.value=1,u.value=0,c.value=0}function k(){1===r.value?r.value=2:y()}function x(e){!v.value||r.value<=1||(u.value=e.clientX-h.value.x,c.value=e.clientY-h.value.y)}function M(){v.value=!1}function P(e){if(e.length<2)return 0;const o=e[0],t=e[1];return Math.sqrt(Math.pow(t.clientX-o.clientX,2)+Math.pow(t.clientY-o.clientY,2))}const I=n((()=>({transform:`translate(${u.value}px, ${c.value}px) scale(${r.value})`,cursor:r.value>1?v.value?"grabbing":"grab":"default"})));return o((()=>{document.addEventListener("mousemove",x),document.addEventListener("mouseup",M)})),t((()=>{document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",M)})),{imageRef:i,containerRef:s,scale:r,translateX:u,translateY:c,isDragging:v,imageLoaded:d,currentIndex:w,currentPhoto:g,imageTransform:I,goToPrevious:function(){return Math.max(0,w.value-1)},goToNext:function(){const e=b(a);return Math.min(e.length-1,w.value+1)},resetImageState:function(){r.value=1,u.value=0,c.value=0,d.value=!1},zoomIn:function(){const e=Math.min(5,r.value+.5);r.value=e},zoomOut:function(){const e=Math.max(.1,r.value-.5);r.value=e,e<=1&&(u.value=0,c.value=0)},resetZoom:y,handleDoubleClick:k,handleWheel:function(e){e.preventDefault();const o=e.deltaY>0?-.1:.1,t=Math.max(.1,Math.min(5,r.value+o));r.value=t,t<=1&&(u.value=0,c.value=0)},handleMouseDown:function(e){r.value<=1||(v.value=!0,h.value={x:e.clientX-u.value,y:e.clientY-c.value},e.preventDefault())},handleImageLoad:function(){d.value=!0},handleImageError:function(e){d.value=!1},handleTouchStart:function(e){const o=Date.now(),t=e.touches;if(1===t.length){const e=t[0];if(o-m.value<300)return void k();m.value=o,r.value>1&&(v.value=!0,h.value={x:e.clientX-u.value,y:e.clientY-c.value})}else 2===t.length&&(e.preventDefault(),v.value=!1,f.value=P(t),p.value={x:(t[0].clientX+t[1].clientX)/2,y:(t[0].clientY+t[1].clientY)/2,scale:r.value})},handleTouchMove:function(e){const o=e.touches;if(1===o.length&&v.value&&r.value>1){e.preventDefault();const t=o[0];u.value=t.clientX-h.value.x,c.value=t.clientY-h.value.y}else if(2===o.length){e.preventDefault();const t=P(o);if(f.value>0){const e=t/f.value,o=Math.max(.5,Math.min(3,p.value.scale*e));r.value=o,o<=1&&(u.value=0,c.value=0)}}},handleTouchEnd:function(e){0===e.touches.length&&(v.value=!1)}}}(n((()=>c.photos)),n((()=>c.currentPhotoId))),g=e(!1),y=e(!1),M=n((()=>w.currentIndex.value>0)),_=n((()=>w.currentIndex.value<c.photos.length-1));function T(){v("update:show",!1)}function L(e){v("update:currentPhotoId",e)}function E(){if(M.value){const e=w.goToPrevious(),o=c.photos[e];o&&v("update:currentPhotoId",o.id)}}function R(){if(_.value){const e=w.goToNext(),o=c.photos[e];o&&v("update:currentPhotoId",o.id)}}function A(){g.value=!g.value,v("drawer:toggle",g.value)}function $(){var e;f.value?g.value=!1:g.value=(null==(e=c.config.drawerConfig)?void 0:e.defaultOpen)??!1}function W(e){w.currentPhoto.value&&v("photo:error",w.currentPhoto.value,e)}return function(e){function a(o){var t,a,n,l,i,s,r;switch(["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Space"].includes(o.code)&&o.preventDefault(),o.code){case"Escape":null==(t=e.onEscape)||t.call(e);break;case"ArrowLeft":null==(a=e.onArrowLeft)||a.call(e);break;case"ArrowRight":null==(n=e.onArrowRight)||n.call(e);break;case"ArrowUp":null==(l=e.onArrowUp)||l.call(e);break;case"ArrowDown":null==(i=e.onArrowDown)||i.call(e);break;case"Space":null==(s=e.onSpace)||s.call(e);break;case"Enter":null==(r=e.onEnter)||r.call(e)}}o((()=>{document.addEventListener("keydown",a)})),t((()=>{document.removeEventListener("keydown",a)}))}({onEscape:T,onArrowLeft:E,onArrowRight:R,onSpace:A}),o((()=>{$()})),l((()=>c.show),(e=>{e?(w.resetImageState(),$(),m((()=>{document.body.style.overflow="hidden"}))):(document.body.style.overflow="",g.value=!1)})),l((()=>c.currentPhotoId),(()=>{w.resetImageState()})),l((()=>w.currentPhoto.value),(e=>{e&&v("photo:change",e)}),{immediate:!0}),(e,o)=>{var t,a,n,l;return s(),P(D,{to:"body"},[e.show?(s(),i("div",me,[r("div",{class:"photo-viewer-backdrop",onClick:T}),r("div",{class:"photo-viewer-bg",style:h({backgroundImage:`url(${(null==(t=b(w).currentPhoto.value)?void 0:t.thumbnail)||(null==(a=b(w).currentPhoto.value)?void 0:a.src)})`})},null,4),b(f)?(s(),i("div",xe,[r("div",Me,[k(e.$slots,"top-left",{photo:b(w).currentPhoto.value},void 0,!0)]),r("div",Pe,[x(he,{photo:b(w).currentPhoto.value,controls:e.config.controls,"show-drawer":e.config.showDrawer,onToggleInfo:A,onClose:T},{default:I((({photo:o})=>[k(e.$slots,"top-right",{photo:o},void 0,!0)])),_:3},8,["photo","controls","show-drawer"])]),r("div",{ref:"viewer.containerRef",class:"photo-viewer-image-container",onWheel:o[4]||(o[4]=(...e)=>b(w).handleWheel&&b(w).handleWheel(...e)),onDblclick:o[5]||(o[5]=(...e)=>b(w).handleDoubleClick&&b(w).handleDoubleClick(...e)),onTouchstart:o[6]||(o[6]=(...e)=>b(w).handleTouchStart&&b(w).handleTouchStart(...e)),onTouchmove:o[7]||(o[7]=(...e)=>b(w).handleTouchMove&&b(w).handleTouchMove(...e)),onTouchend:o[8]||(o[8]=(...e)=>b(w).handleTouchEnd&&b(w).handleTouchEnd(...e))},[x(de,{"show-navigation":null==(l=e.config.controls)?void 0:l.showNavigation,"can-go-previous":M.value,"can-go-next":_.value,"is-visible":!0,onPrevious:E,onNext:R},null,8,["show-navigation","can-go-previous","can-go-next"]),x(fe,{ref:"viewer.imageRef",photo:b(w).currentPhoto.value,"image-transform":b(w).imageTransform.value,onLoad:b(w).handleImageLoad,onError:W,onMousedown:b(w).handleMouseDown},null,8,["photo","image-transform","onLoad","onMousedown"])],544),e.config.showThumbnails?(s(),i("div",Ie,[x(S,{photos:e.photos,"current-photo-id":e.currentPhotoId,onSelect:L},null,8,["photos","current-photo-id"])])):p("",!0),e.config.showDrawer?(s(),P(ce,{key:1,show:g.value,photo:b(w).currentPhoto.value,config:e.config.drawerConfig,"onUpdate:show":o[9]||(o[9]=e=>g.value=e)},{default:I((()=>[k(e.$slots,"drawer-content",{photo:b(w).currentPhoto.value},void 0,!0)])),_:3},8,["show","photo","config"])):p("",!0)])):(s(),i("div",{key:0,class:d(["photo-viewer-desktop",{"has-drawer":g.value}])},[r("div",we,[r("div",ge,[k(e.$slots,"top-left",{photo:b(w).currentPhoto.value},void 0,!0)]),r("div",be,[x(he,{photo:b(w).currentPhoto.value,controls:e.config.controls,"show-drawer":e.config.showDrawer,onToggleInfo:A,onClose:T},{default:I((({photo:o})=>[k(e.$slots,"top-right",{photo:o},void 0,!0)])),_:3},8,["photo","controls","show-drawer"])]),r("div",{ref:"viewer.containerRef",class:"photo-viewer-image-container",onWheel:o[0]||(o[0]=(...e)=>b(w).handleWheel&&b(w).handleWheel(...e)),onDblclick:o[1]||(o[1]=(...e)=>b(w).handleDoubleClick&&b(w).handleDoubleClick(...e)),onMouseenter:o[2]||(o[2]=e=>y.value=!0),onMouseleave:o[3]||(o[3]=e=>y.value=!1)},[x(de,{"show-navigation":null==(n=e.config.controls)?void 0:n.showNavigation,"can-go-previous":M.value,"can-go-next":_.value,"is-visible":y.value,onPrevious:E,onNext:R},null,8,["show-navigation","can-go-previous","can-go-next","is-visible"]),x(fe,{ref:"viewer.imageRef",photo:b(w).currentPhoto.value,"image-transform":b(w).imageTransform.value,onLoad:b(w).handleImageLoad,onError:W,onMousedown:b(w).handleMouseDown},null,8,["photo","image-transform","onLoad","onMousedown"])],544),e.config.showThumbnails?(s(),i("div",ye,[x(S,{photos:e.photos,"current-photo-id":e.currentPhotoId,onSelect:L},null,8,["photos","current-photo-id"])])):p("",!0)]),e.config.showDrawer?(s(),i("div",{key:0,class:d(["photo-viewer-drawer",{show:g.value}])},[r("div",ke,[x(ce,{show:g.value,photo:b(w).currentPhoto.value,config:e.config.drawerConfig},{default:I((()=>[k(e.$slots,"drawer-content",{photo:b(w).currentPhoto.value},void 0,!0)])),_:3},8,["show","photo","config"])])],2)):p("",!0)],2))])):p("",!0)])}}}),[["__scopeId","data-v-c1662508"]]),_e={class:"waterfall-wrapper relative w-full"},Te={class:"waterfall-item-content w-full h-full"},Le={key:0,class:"load-more-wrapper flex justify-center",style:{marginTop:"20px"}},Ce=w(a({__name:"WaterfallLayout",props:{items:{type:Array,required:!0,default:()=>[]},columnWidth:{type:Number,default:250},gap:{type:Number,default:8},loading:{type:Boolean,default:!1},showLoadMore:{type:Boolean,default:!0},loadMoreText:{type:String,default:""},maxAspectRatio:{type:Number,default:3},uniformRatio:{type:Number,default:0}},emits:["loadMore"],setup(a,{expose:v,emit:w}){const g=a,b=w,y=e(),x=e(1),M=e([]),P=e([]),I=e([]),D=e([]);let _,T=null;function L(){if(!y.value)return 1;const e=y.value.clientWidth,o=Math.floor(e/(g.columnWidth+g.gap));return Math.min(Math.max(1,o),6)}function C(){D.value.forEach((e=>clearTimeout(e))),D.value=[]}function E(){if(!y.value||0===g.items.length)return P.value=[],M.value=[],I.value=[],void C();const e=x.value,o=y.value.clientWidth;if(o<=0)return;const t=o-(e-1)*g.gap,a=Math.max(100,t/e);M.value=new Array(e).fill(0),P.value=new Array(g.items.length);const n=I.value.length;I.value=new Array(g.items.length).fill(!1);for(let l=0;l<Math.min(n,g.items.length);l++)I.value[l]=!0;g.items.forEach(((e,o)=>{const t=M.value.indexOf(Math.min(...M.value)),n=t*(a+g.gap),l=M.value[t];let i=200;if(g.uniformRatio>0)i=a*g.uniformRatio;else if(e.width&&e.height&&e.width>0){const o=Math.min(e.height/e.width,g.maxAspectRatio);i=Math.max(100,o*a)}P.value[o]={left:n,top:l,width:a,height:i},M.value[t]+=i+g.gap})),function(e){C();for(let o=e;o<g.items.length;o++){const t=setTimeout((()=>{o<I.value.length&&(I.value[o]=!0)}),100*(o-e));D.value.push(t)}}(n)}function R(){m(E)}function A(){m((()=>{x.value=L(),E()}))}const $=n((()=>0===M.value.length?0:Math.max(...M.value)));function W(){b("loadMore")}return l([()=>g.items,x],R,{deep:!0}),l((()=>g.columnWidth),(()=>{A()})),l((()=>g.loading),(e=>{e||R()})),o((()=>{x.value=L(),R(),window.addEventListener("waterfall-recalculate",A),function(){if(!y.value)return;let e=0;T=new ResizeObserver((o=>{for(const t of o){const{width:o}=t.contentRect;o>0&&Math.abs(o-e)>1&&(e=o,clearTimeout(_),_=setTimeout((()=>{const e=L();e!==x.value&&(x.value=e),R()}),30))}})),T.observe(y.value)}()})),t((()=>{null==T||T.disconnect(),T=null,window.removeEventListener("waterfall-recalculate",A),clearTimeout(_),C()})),v({recalculateLayout:A}),(e,o)=>(s(),i("div",_e,[r("div",{ref_key:"containerRef",ref:y,class:"waterfall-container relative w-full",style:h({height:$.value+"px"})},[(s(!0),i(u,null,c(a.items,((o,t)=>{var n,l,u,c;return s(),i("div",{key:o.id||t,class:d(["waterfall-item absolute transition-all duration-500 ease-out",{"item-visible":I.value[t],"item-hidden":!I.value[t]}]),style:h({left:(null==(n=P.value[t])?void 0:n.left)+"px",top:(null==(l=P.value[t])?void 0:l.top)+"px",width:(null==(u=P.value[t])?void 0:u.width)+"px",height:a.uniformRatio>0?(null==(c=P.value[t])?void 0:c.height)+"px":void 0})},[r("div",Te,[k(e.$slots,"default",{item:o,index:t},void 0,!0)])],6)})),128))],4),a.showLoadMore&&!a.loading&&a.items.length>0?(s(),i("div",Le,[r("button",{onClick:W,class:"load-more-btn px-4 py-2 text-gray-600 hover:text-blue-500 transition-colors duration-200 text-sm font-medium border-none bg-transparent cursor-pointer"},f(a.loadMoreText||"Load more"),1)])):p("",!0)]))}}),[["__scopeId","data-v-25433125"]]);export{De as P,Ce as W};
