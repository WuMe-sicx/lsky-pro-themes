import{a as e,L as a,d as t,f as s,n as l}from"./Layout-B7WTefT3.js";import{_ as i}from"./Content.vue_vue_type_script_setup_true_lang-CATP0AmL.js";import{_ as r}from"./Back.vue_vue_type_script_setup_true_lang-sCWvZjrO.js";import{d as n,u as c,aq as d,a as o,i as u,c as p,J as m,o as v,H as x,I as f,s as y,v as b,ar as g,h as k,z as h,g as z,b as w,e as _,A as $,E as j,y as C,x as P,F as S,O,as as A,j as N,f as D,n as I,_ as L}from"./index-Ctnlk-aF.js";import{u as M,_ as B}from"./usePayment-CU_7hDca.js";import{N as E}from"./Spin-DlOkiMFH.js";import{N as J}from"./Alert-CXqSmTtF.js";import"./order-Dy3mpmSB.js";const U={class:"space-y-6"},q={class:"detail-section flex items-center justify-between",style:{"--i":"0"}},F={key:0,class:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-semibold bg-zinc-900 text-white dark:bg-zinc-100 dark:text-zinc-900"},H={class:"detail-section plan-card overflow-hidden",style:{"--i":"1"}},T={class:"relative bg-gradient-to-br from-zinc-800 to-zinc-900 dark:from-zinc-700 dark:to-zinc-800 p-6 md:p-8"},V={class:"relative"},G={class:"text-2xl md:text-3xl font-bold text-white"},K={key:0,class:"text-zinc-400 mt-2 max-w-xl"},Q={class:"detail-section",style:{"--i":"2"}},R={class:"detail-section flex flex-col lg:flex-row gap-6",style:{"--i":"3"}},W={class:"w-full lg:w-2/3 space-y-6"},X={class:"plan-card p-5"},Y={class:"flex items-center gap-2 text-xs font-medium uppercase tracking-wider text-zinc-400 dark:text-zinc-500 mb-4"},Z={class:"grid grid-cols-1 md:grid-cols-2 gap-3"},ee={class:"flex h-5 w-5 items-center justify-center rounded-full bg-emerald-100/60 dark:bg-emerald-900/30 shrink-0 mt-0.5"},ae=["title"],te={class:"plan-card p-5"},se={class:"flex items-center gap-2 text-xs font-medium uppercase tracking-wider text-zinc-400 dark:text-zinc-500 mb-4"},le={class:"space-y-3"},ie=["onClick"],re={key:0,class:"h-2.5 w-2.5 rounded-full bg-zinc-900 dark:bg-zinc-100"},ne={class:"flex-1 min-w-0"},ce={class:"flex items-center gap-2 flex-wrap"},de={class:"text-sm font-medium text-zinc-900 dark:text-zinc-100"},oe={key:0,class:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-red-50 text-red-600 dark:bg-red-900/30 dark:text-red-400"},ue={key:0,class:"text-xs text-zinc-500 dark:text-zinc-400 mt-1"},pe={key:1,class:"flex flex-wrap gap-2 mt-2"},me={class:"text-right shrink-0"},ve={class:"text-lg font-bold text-zinc-900 dark:text-zinc-100"},xe={class:"w-full lg:w-1/3 space-y-6"},fe={class:"plan-card p-5"},ye={class:"flex items-center gap-2 text-xs font-medium uppercase tracking-wider text-zinc-400 dark:text-zinc-500 mb-3"},be={class:"plan-card p-5 lg:sticky lg:top-20"},ge={class:"flex items-center gap-2 text-xs font-medium uppercase tracking-wider text-zinc-400 dark:text-zinc-500 mb-4"},ke={class:"space-y-3"},he={class:"flex items-center justify-between text-sm"},ze={class:"text-zinc-500 dark:text-zinc-400"},we={class:"font-medium text-zinc-900 dark:text-zinc-100 truncate ml-4"},_e={class:"flex items-center justify-between text-sm"},$e={class:"text-zinc-500 dark:text-zinc-400"},je={class:"font-medium text-zinc-900 dark:text-zinc-100 truncate ml-4"},Ce={key:0,class:"flex items-center justify-between text-sm"},Pe={class:"text-emerald-600 dark:text-emerald-400"},Se={class:"flex items-center gap-2"},Oe={class:"font-medium text-emerald-600 dark:text-emerald-400"},Ae={key:0,class:"inline-flex px-1.5 py-0.5 rounded text-xs font-medium bg-emerald-50 text-emerald-600 dark:bg-emerald-900/30 dark:text-emerald-400"},Ne={class:"flex items-center justify-between"},De={class:"text-sm font-semibold text-zinc-900 dark:text-zinc-100"},Ie={class:"text-xl font-bold text-red-600 dark:text-red-400"},Le={class:"flex items-center gap-2 text-xs font-medium uppercase tracking-wider text-zinc-400 dark:text-zinc-500 mb-3"},Me=L(n({__name:"DetailView",setup(n){const L=f(),Me=N(),Be=e(),Ee=c(),Je=d(),Ue=o({}),qe=o({}),Fe=o(""),He=o(""),Te=o(0),Ve=o(0),{t:Ge}=u(),Ke=o(!1),{handlePayment:Qe,validatePayment:Re}=M(),We=p((()=>Te.value)),Xe=p((()=>{var e;return Ve.value&&"number"==typeof(null==(e=qe.value)?void 0:e.price)?0===qe.value.price||Ve.value>=qe.value.price?100:Math.round(Ve.value/qe.value.price*100):0}));async function Ye(){var e,a,t,s;Ke.value=!0;try{const l=await g({body:{price_id:qe.value.id,coupon_code:He.value}});if("error"===(null==(e=l.data)?void 0:e.status))return Be.error(null==(a=l.data)?void 0:a.message);Te.value=(null==(t=l.data)?void 0:t.data.amount)||0,Ve.value=(null==(s=l.data)?void 0:s.data.deduct_amount)||0}catch(l){}finally{Ke.value=!1}}async function Ze(){var e,a,t;if(Re(Fe.value,Te.value)){Ke.value=!0;try{const s=await A({body:{price_id:qe.value.id,coupon_code:He.value}});if("error"===(null==(e=s.data)?void 0:e.status))return Be.error(null==(a=s.data)?void 0:a.message);const l=s.data.data.trade_no;(null==(t=s.data)?void 0:t.data.is_paid)?Me.push(`/user/orders/${l}`).then((()=>{Be.success(Ge("Order Payment Successful"))})):await Qe(Fe.value,l)}catch(s){Be.error(Ge("Order creation failed"))}finally{Ke.value=!1}}}return m(qe,(()=>Ye()),{deep:!0}),v((async()=>{var e,a,t,s;Ke.value=!0;try{const l=await x({path:{id:Number(L.params.id)}});if("error"===(null==(e=l.data)?void 0:e.status))return Be.error(null==(a=l.data)?void 0:a.message);Ue.value=null==(t=l.data)?void 0:t.data,qe.value=null==(s=l.data)?void 0:s.data.prices[0],await Ye()}catch(l){}finally{Ke.value=!1}})),(e,n)=>(D(),y(a,{"header-title":e.$t("Subscription Details"),"toggle-header":!1,"show-footer":!1},{default:b((()=>[k(i,{class:"p-4 md:p-6 lg:p-8 space-y-6"},{default:b((()=>[k(h(E),{show:Ke.value},{default:b((()=>{var a,i;return[z("div",U,[z("div",q,[k(r,{to:"/user/plans",class:"hover:text-primary transition-colors"}),Ue.value.badge?(D(),w("span",F,[k(h(j),{icon:["fas","star"],class:"w-2.5 h-2.5"}),$(" "+C(Ue.value.badge),1)])):_("",!0)]),z("div",H,[z("div",T,[n[3]||(n[3]=z("div",{class:"absolute top-0 right-0 w-48 h-48 bg-white/5 rounded-full -translate-y-1/2 translate-x-1/4"},null,-1)),n[4]||(n[4]=z("div",{class:"absolute bottom-0 left-1/3 w-32 h-32 bg-white/5 rounded-full translate-y-1/2"},null,-1)),z("div",V,[z("h1",G,C(Ue.value.name),1),Ue.value.intro?(D(),w("p",K,C(Ue.value.intro),1)):_("",!0)])])]),z("div",Q,[k(h(J),{type:"info","show-icon":!0},{default:b((()=>[$(C(e.$t("Note that subscription purchases do not stack packages, only one subscription will be in effect at any one time, and the most recently purchased subscription will be applied immediately upon successful purchase.")),1)])),_:1})]),z("div",R,[z("div",W,[z("div",X,[z("h2",Y,[k(h(j),{icon:["fas","list-check"],class:"w-4 h-4"}),$(" "+C(e.$t("Subscription Information")),1)]),z("div",Z,[(D(!0),w(S,null,P(Ue.value.features,(e=>(D(),w("div",{key:e,class:"flex items-start gap-2.5 p-2.5 rounded-lg hover:bg-zinc-50 dark:hover:bg-zinc-800/50 transition-colors"},[z("div",ee,[k(h(j),{icon:["fas","check"],class:"w-2.5 h-2.5 text-emerald-600 dark:text-emerald-400"})]),z("span",{class:"text-sm text-zinc-700 dark:text-zinc-300 leading-relaxed",title:e},C(e),9,ae)])))),128))])]),z("div",te,[z("h2",se,[k(h(j),{icon:["far","clock"],class:"w-4 h-4"}),$(" "+C(e.$t("Payment Cycle")),1)]),z("div",le,[(D(!0),w(S,null,P(Ue.value.prices,(a=>{var t;return D(),w("div",{key:a.id,class:I(["flex items-center gap-4 p-4 rounded-xl border cursor-pointer transition-all duration-200",a.id===qe.value.id?"border-zinc-900 dark:border-zinc-100 bg-zinc-50/80 dark:bg-zinc-800/40":"border-zinc-200/80 dark:border-zinc-800/60 hover:border-zinc-300 dark:hover:border-zinc-700"]),onClick:e=>qe.value=a},[z("div",{class:I(["flex h-5 w-5 items-center justify-center rounded-full border-2 shrink-0 transition-colors",a.id===qe.value.id?"border-zinc-900 dark:border-zinc-100":"border-zinc-300 dark:border-zinc-600"])},[a.id===qe.value.id?(D(),w("div",re)):_("",!0)],2),z("div",ne,[z("div",ce,[z("span",de,C(a.name),1),a.recommended?(D(),w("span",oe,C(e.$t("Best value")),1)):_("",!0)]),a.description?(D(),w("p",ue,C(a.description),1)):_("",!0),a.features&&a.features.length>0?(D(),w("div",pe,[(D(!0),w(S,null,P(a.features,((e,a)=>(D(),w("span",{key:a,class:"text-xs text-zinc-500 dark:text-zinc-400 flex items-center gap-1"},[n[5]||(n[5]=z("span",{class:"h-1 w-1 rounded-full bg-zinc-400 dark:bg-zinc-500"},null,-1)),$(" "+C(e),1)])))),128))])):_("",!0)]),z("div",me,[z("span",ve,C(h(l).currency(a.price,null==(t=h(Ee).configs)?void 0:t.app.currency,h(Je).locale)),1)])],10,ie)})),128))])])]),z("div",xe,[z("div",fe,[z("h2",ye,[k(h(j),{icon:["fas","ticket"],class:"w-4 h-4"}),$(" "+C(e.$t("Apply Coupon")),1)]),k(h(t),null,{default:b((()=>[k(h(s),{value:He.value,"onUpdate:value":n[0]||(n[0]=e=>He.value=e),placeholder:e.$t("Enter coupon code")},null,8,["value","placeholder"]),k(h(O),{type:"primary",disabled:!He.value,onClick:n[1]||(n[1]=()=>{He.value&&Ye()})},{default:b((()=>[$(C(e.$t("Apply")),1)])),_:1},8,["disabled"])])),_:1})]),z("div",be,[z("h2",ge,[k(h(j),{icon:["fas","receipt"],class:"w-4 h-4"}),$(" "+C(e.$t("Order Summary")),1)]),z("div",ke,[z("div",he,[z("span",ze,C(e.$t("Subscription")),1),z("span",we,C(Ue.value.name),1)]),z("div",_e,[z("span",$e,C(e.$t("Plan")),1),z("span",je,C(qe.value.name),1)]),Ve.value>0?(D(),w("div",Ce,[z("span",Pe,C(e.$t("Coupon Discount")),1),z("div",Se,[z("span",Oe," -"+C(h(l).currency(Ve.value,null==(a=h(Ee).configs)?void 0:a.app.currency,h(Je).locale)),1),Xe.value>0&&Xe.value<=100?(D(),w("span",Ae," -"+C(Xe.value)+"% ",1)):_("",!0)])])):_("",!0),n[6]||(n[6]=z("div",{class:"h-px bg-zinc-100/80 dark:bg-zinc-800/50 my-1"},null,-1)),z("div",Ne,[z("span",De,C(e.$t("Total")),1),z("span",Ie,C(h(l).currency(We.value,null==(i=h(Ee).configs)?void 0:i.app.currency,h(Je).locale)),1)])]),Te.value>0?(D(),w(S,{key:0},[n[7]||(n[7]=z("div",{class:"h-px bg-zinc-100/80 dark:bg-zinc-800/50 my-4"},null,-1)),z("h3",Le,[k(h(j),{icon:["far","credit-card"],class:"w-4 h-4"}),$(" "+C(e.$t("Payment Method")),1)]),k(B,{value:Fe.value,"onUpdate:value":n[2]||(n[2]=e=>Fe.value=e)},null,8,["value"]),k(h(O),{type:"primary",size:"large",block:"",disabled:""===Fe.value,onClick:Ze,class:"mt-4 !rounded-xl"},{icon:b((()=>[k(h(j),{icon:["fas","lock"],class:"w-3.5 h-3.5"})])),default:b((()=>[$(" "+C(e.$t("Complete Purchase")),1)])),_:1},8,["disabled"])],64)):(D(),w(S,{key:1},[n[8]||(n[8]=z("div",{class:"h-px bg-zinc-100/80 dark:bg-zinc-800/50 my-4"},null,-1)),k(h(O),{type:"primary",size:"large",block:"",onClick:Ze,class:"!rounded-xl"},{default:b((()=>[$(C(e.$t("Confirm Order")),1)])),_:1})],64))])])])])]})),_:1},8,["show"])])),_:1})])),_:1},8,["header-title"]))}}),[["__scopeId","data-v-7f4371df"]]);export{Me as default};
