import{d as e,m as t,i as a,a as r,a4 as s,O as n,j as l,s as d,v as i,h as o,g as c,z as u,E as m,y as p,B as f,at as v,f as y,_ as h}from"./index-Ctnlk-aF.js";import{_}from"./Content.vue_vue_type_script_setup_true_lang-CATP0AmL.js";import{B as g,m as k,D as x,L as b,n as w,f as z}from"./Layout-B7WTefT3.js";import{_ as j}from"./DataTable.vue_vue_type_script_setup_true_lang-BVAbYJmv.js";import{u as C}from"./order-Dy3mpmSB.js";import{u as $}from"./composables-DhvgzyQS.js";import"./Checkbox-oCtQDiYY.js";import"./Ellipsis-8oa2BOhe.js";const O={class:"order-section rounded-xl border border-zinc-200 dark:border-zinc-800 p-5",style:{"--i":"0"}},W={class:"flex items-center gap-4"},U={class:"flex h-10 w-10 items-center justify-center rounded-lg bg-amber-100/50 dark:bg-amber-900/30"},K={class:"text-xl font-semibold text-zinc-900 dark:text-zinc-100"},B={class:"text-sm text-zinc-500 dark:text-zinc-400 mt-0.5"},D={class:"order-section rounded-xl border border-zinc-200 dark:border-zinc-800 p-5",style:{"--i":"1"}},E={class:"flex flex-col gap-4"},L={class:"flex items-center justify-end"},M={class:"grow md:grow-0 md:w-72"},P=h(e({__name:"IndexView",setup(e){const h=l(),P=C(),q=t(),{t:A}=a(),I=$(),R=r(),S=[{title:A("Order Number"),key:"trade_no",minWidth:250},{title:A("Product"),key:"snapshot.name",minWidth:300},{title:A("Payment Cycle"),key:"product.name",minWidth:200},{title:A("Order Amount"),key:"amount",minWidth:100,sorter:!0,align:"center"},{title:A("Order Status"),key:"status",minWidth:100,align:"center",render(e){const t={cancelled:A("Cancelled"),unpaid:A("Unpaid"),paid:A("Paid")},a=e.status;return s(g,{type:{cancelled:"danger",unpaid:"warning",paid:"success"}[a]},{default:()=>t[a]??A("Unknown")})}},{title:A("Creation Time"),minWidth:200,key:"created_at",sorter:!0,align:"center",render:e=>k(e.created_at).format("L")},{title:A("Actions"),key:"actions",minWidth:170,fixed:"right",align:"center",render:e=>s(x,{vertical:!1,size:5,justify:"center"},{default:()=>[s(n,{size:"small",onClick:()=>{h.push(`/user/orders/${e.trade_no}`)}},{default:()=>A("Details")}),s(n,{disabled:"unpaid"!==e.status,size:"small",type:"error",onClick:async()=>{P.cancelOrder(e.trade_no,I,A).then((()=>{var e;V.value=[],null==(e=R.value)||e.refresh()}))}},{default:()=>A("Cancel Order")})]})}],T=r(""),N=r("sort:latest"),V=r([]),F=e=>v({query:{page:e,per_page:40,q:`${T.value} ${N.value}`.trim()}});function G(e){var t;e.order?N.value=`sort:${e.columnKey}:${e.order}`:N.value="sort:latest",null==(t=R.value)||t.refresh()}function H(){var e;null==(e=R.value)||e.refresh()}return(e,t)=>(y(),d(b,{"header-title":e.$t("Order Management"),"toggle-header":!1,"show-footer":!1},{default:i((()=>[o(_,{class:"p-4 md:p-6 lg:p-8 space-y-6"},{default:i((()=>{var a;return[c("div",O,[c("div",W,[c("div",U,[o(u(m),{icon:["far","rectangle-list"],class:"w-4 h-4 text-amber-600 dark:text-amber-400"})]),c("div",null,[c("h1",K,p(e.$t("Order Management")),1),c("p",B,p(e.$t("{count} orders total",{count:u(w).format((null==(a=u(q).profile)?void 0:a.order_count)||0)})),1)])])]),c("div",D,[c("div",E,[c("div",L,[c("div",M,[o(u(z),{value:T.value,"onUpdate:value":t[0]||(t[0]=e=>T.value=e),placeholder:e.$t("Enter keywords to search..."),onKeyup:f(H,["enter","native"])},{prefix:i((()=>[o(u(m),{icon:["fas","magnifying-glass"],class:"w-3.5 h-3.5 text-zinc-400"})])),_:1},8,["value","placeholder"])])]),o(j,{striped:"",ref_key:"tableRef",ref:R,bordered:!1,fetch:F,columns:S,"row-key":e=>e.id,"checked-row-keys":V.value,"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>V.value=e),onUpdateSorter:G},null,8,["row-key","checked-row-keys"])])])]})),_:1})])),_:1},8,["header-title"]))}}),[["__scopeId","data-v-9f92b59a"]]);export{P as default};
