import{d as e,k as t,a,Z as r,E as s,u as l,v as n,x as o,C as i,B as d,N as u,f as c,P as p,aM as m,e as _}from"./index.CT88Sm32.js";import{_ as f}from"./Content.vue_vue_type_script_setup_true_lang.Dbg-RI-4.js";import{L as v,s as y,M as h,_ as k,h as g,N as w,O as x}from"./Layout.vue_vue_type_script_setup_true_lang.CVCKf7J5.js";import{_ as j}from"./DataTable.vue_vue_type_script_setup_true_lang.CdustvT4.js";import{u as b}from"./order.DxOKZBgy.js";import{u as C}from"./composables.DHPbJdtC.js";import"./Checkbox.B8MxR3xo.js";import"./Ellipsis.Bs9t3VhK.js";const O={class:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between"},W={class:"grow md:grow-0 md:basis-1/2"},$=e({__name:"IndexView",setup(e){const $=l(),P=b(),{t:U}=t(),E=C(),M=a(),z=[{title:U("Order Number"),key:"trade_no",minWidth:250},{title:U("Product"),key:"snapshot.name",minWidth:300},{title:U("Payment Cycle"),key:"product.name",minWidth:200},{title:U("Order Amount"),key:"amount",minWidth:100,sorter:!0,align:"center"},{title:U("Order Status"),key:"status",minWidth:100,sorter:!0,align:"center",render(e){const t={cancelled:U("Cancelled"),unpaid:U("Unpaid"),paid:U("Paid")},a=e.status;return r(v,{type:{cancelled:"danger",unpaid:"warning",paid:"success"}[a]},{default:()=>t[a]??U("Unknown")})}},{title:U("Creation Time"),minWidth:200,key:"created_at",sorter:!0,align:"center",render:e=>y(e.created_at).format("L")},{title:U("Actions"),key:"actions",minWidth:170,fixed:"right",align:"center",render:e=>r(h,{vertical:!1,size:5,justify:"center"},{default:()=>[r(s,{size:"small",onClick:()=>{$.push(`/user/orders/${e.trade_no}`)}},{default:()=>U("Details")}),r(s,{disabled:"unpaid"!==e.status,size:"small",type:"error",onClick:async()=>{P.cancelOrder(e.trade_no,E,U).then((()=>{var e;L.value=[],null==(e=M.value)||e.refresh()}))}},{default:()=>U("Cancel Order")})]})}],D=a(""),K=a("sort:latest"),L=a([]),N=e=>m({query:{page:e,per_page:40,q:`${D.value} ${K.value}`.trim()}});function q(e){var t;e.order?K.value=`sort:${e.columnKey}:${e.order}`:K.value="sort:latest",null==(t=M.value)||t.refresh()}function A(){var e;null==(e=M.value)||e.refresh()}return(e,t)=>(_(),n(k,{"header-title":e.$t("Order Management"),"toggle-header":!1,"show-footer":!1},{default:o((()=>[i(f,{class:"mx-auto p-4 md:p-10 space-y-10"},{default:o((()=>[i(d(u),null,{default:o((()=>[i(d(h),{vertical:""},{default:o((()=>[c("div",O,[t[2]||(t[2]=c("div",null,null,-1)),c("div",W,[i(d(g),{value:D.value,"onUpdate:value":t[0]||(t[0]=e=>D.value=e),placeholder:e.$t("Enter keywords to search..."),onKeyup:p(A,["enter","native"])},{prefix:o((()=>[i(d(w),{component:d(x)},null,8,["component"])])),_:1},8,["value","placeholder"])])]),i(j,{striped:"",ref_key:"tableRef",ref:M,bordered:!1,fetch:N,columns:z,"row-key":e=>e.id,"checked-row-keys":L.value,"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>L.value=e),onUpdateSorter:q},null,8,["row-key","checked-row-keys"])])),_:1})])),_:1})])),_:1})])),_:1},8,["header-title"]))}});export{$ as default};
