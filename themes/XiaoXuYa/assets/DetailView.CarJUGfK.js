import{a as e,_ as a,P as t,N as l,g as s,h as n,n as i}from"./Layout.vue_vue_type_script_setup_true_lang.CmpyqK56.js";import{_ as r}from"./Content.vue_vue_type_script_setup_true_lang.DOatZPr-.js";import{_ as o}from"./Back.vue_vue_type_script_setup_true_lang.D1yGjJMC.js";import{V as c,W as u,d,Z as v,aF as p,$ as f,aG as m,aH as y,a1 as b,c as x,aI as h,b as g,e as _,f as w,i as k,aJ as z,a as $,k as C,l as j,o as S,I as P,J as V,p as N,q as O,aK as H,z as B,y as A,s as D,x as F,A as R,N as T,E,F as I,B as M,aL as L,u as W,D as G,_ as J}from"./index.BwdMlFEt.js";import{u as U}from"./order.CtBHXfPS.js";import{u as q,_ as K}from"./usePayment.ClSOaWqe.js";import{C as Q}from"./CheckCircleOutlined.BkqbuloA.js";import{N as Z}from"./Spin.tqDYaYhL.js";import{N as X}from"./Alert.BWCazsxj.js";import{N as Y}from"./Divider.BPMbU0Wr.js";const ee=c("statistic",[u("label","\n font-weight: var(--n-label-font-weight);\n transition: .3s color var(--n-bezier);\n font-size: var(--n-label-font-size);\n color: var(--n-label-text-color);\n "),c("statistic-value","\n margin-top: 4px;\n font-weight: var(--n-value-font-weight);\n ",[u("prefix","\n margin: 0 4px 0 0;\n font-size: var(--n-value-font-size);\n transition: .3s color var(--n-bezier);\n color: var(--n-value-prefix-text-color);\n ",[c("icon",{verticalAlign:"-0.125em"})]),u("content","\n font-size: var(--n-value-font-size);\n transition: .3s color var(--n-bezier);\n color: var(--n-value-text-color);\n "),u("suffix","\n margin: 0 0 0 4px;\n font-size: var(--n-value-font-size);\n transition: .3s color var(--n-bezier);\n color: var(--n-value-suffix-text-color);\n ",[c("icon",{verticalAlign:"-0.125em"})])])]),ae=d({name:"Statistic",props:Object.assign(Object.assign({},m.props),{tabularNums:Boolean,label:String,value:[String,Number]}),slots:Object,setup(e){const{mergedClsPrefixRef:a,inlineThemeDisabled:t,mergedRtlRef:l}=f(e),s=m("Statistic","-statistic",ee,y,e,a),n=b("Statistic",l,a),i=x((()=>{const{self:{labelFontWeight:e,valueFontSize:a,valueFontWeight:t,valuePrefixTextColor:l,labelTextColor:n,valueSuffixTextColor:i,valueTextColor:r,labelFontSize:o},common:{cubicBezierEaseInOut:c}}=s.value;return{"--n-bezier":c,"--n-label-font-size":o,"--n-label-font-weight":e,"--n-label-text-color":n,"--n-value-font-weight":t,"--n-value-font-size":a,"--n-value-prefix-text-color":l,"--n-value-suffix-text-color":i,"--n-value-text-color":r}})),r=t?h("statistic",void 0,i,e):void 0;return{rtlEnabled:n,mergedClsPrefix:a,cssVars:t?void 0:i,themeClass:null==r?void 0:r.themeClass,onRender:null==r?void 0:r.onRender}},render(){var e;const{mergedClsPrefix:a,$slots:{default:t,label:l,prefix:s,suffix:n}}=this;return null===(e=this.onRender)||void 0===e||e.call(this),v("div",{class:[`${a}-statistic`,this.themeClass,this.rtlEnabled&&`${a}-statistic--rtl`],style:this.cssVars},p(l,(e=>v("div",{class:`${a}-statistic__label`},this.label||e))),v("div",{class:`${a}-statistic-value`,style:{fontVariantNumeric:this.tabularNums?"tabular-nums":""}},p(s,(e=>e&&v("span",{class:`${a}-statistic-value__prefix`},e))),void 0!==this.value?v("span",{class:`${a}-statistic-value__content`},this.value):p(t,(e=>e&&v("span",{class:`${a}-statistic-value__content`},e))),p(n,(e=>e&&v("span",{class:`${a}-statistic-value__suffix`},e)))))}}),te={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},le=[w("path",{d:"M880 310H732.4c13.6-21.4 21.6-46.8 21.6-74c0-76.1-61.9-138-138-138c-41.4 0-78.7 18.4-104 47.4c-25.3-29-62.6-47.4-104-47.4c-76.1 0-138 61.9-138 138c0 27.2 7.9 52.6 21.6 74H144c-17.7 0-32 14.3-32 32v200c0 4.4 3.6 8 8 8h40v344c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V550h40c4.4 0 8-3.6 8-8V342c0-17.7-14.3-32-32-32zm-334-74c0-38.6 31.4-70 70-70s70 31.4 70 70s-31.4 70-70 70h-70v-70zm-138-70c38.6 0 70 31.4 70 70v70h-70c-38.6 0-70-31.4-70-70s31.4-70 70-70zM180 482V378h298v104H180zm48 68h250v308H228V550zm568 308H546V550h250v308zm48-376H546V378h298v104z",fill:"currentColor"},null,-1)],se=d({name:"GiftOutlined",render:function(e,a){return _(),g("svg",te,le)}}),ne={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},ie=[w("path",{d:"M832 312H696v-16c0-101.6-82.4-184-184-184s-184 82.4-184 184v16H192c-17.7 0-32 14.3-32 32v536c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V344c0-17.7-14.3-32-32-32zm-432-16c0-61.9 50.1-112 112-112s112 50.1 112 112v16H400v-16zm392 544H232V384h96v88c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-88h224v88c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-88h96v456z",fill:"currentColor"},null,-1)],re=d({name:"ShoppingOutlined",render:function(e,a){return _(),g("svg",ne,ie)}}),oe={class:"flex flex-col w-full space-y-4"},ce={class:"flex items-center justify-between"},ue={class:"bg-gradient-to-r from-green-50 to-blue-50 dark:from-gray-800 dark:to-gray-700 rounded-lg p-6 mb-4"},de={class:"text-2xl md:text-3xl font-bold mb-2 dark:text-white"},ve={class:"text-gray-600 dark:text-gray-300"},pe={class:"flex w-full flex-col md:flex-row gap-6"},fe={class:"w-full md:basis-2/3 space-y-6"},me={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ye={class:"flex-shrink-0 w-6 h-6 flex items-center justify-center rounded-full bg-green-100 dark:bg-green-900"},be=["title"],xe={class:"payment-options"},he=["onClick"],ge={class:"select-indicator"},_e={class:"radio-outer"},we={key:0,class:"radio-inner"},ke={class:"option-content"},ze={class:"option-header"},$e={class:"flex items-center"},Ce={class:"option-name"},je={key:0,class:"best-value-badge"},Se={key:0,class:"selected-badge"},Pe={class:"option-price"},Ve={key:0,class:"option-description"},Ne={key:1,class:"option-features"},Oe={class:"flex flex-col gap-4 w-full md:basis-1/3"},He={class:"font-medium mb-3 flex items-center gap-2"},Be={class:"flex flex-col space-y-4"},Ae={class:"flex justify-between items-center"},De={class:"text-gray-600 dark:text-gray-400"},Fe={class:"flex justify-between items-center"},Re={class:"text-gray-600 dark:text-gray-400"},Te={key:0,class:"flex justify-between items-center text-green-600"},Ee={class:"flex items-center gap-2"},Ie={class:"flex justify-between items-center"},Me={class:"font-bold"},Le=J(d({__name:"DetailView",setup(c){const u=V(),d=W(),v=e(),p=k(),f=z(),m=$({}),y=$({}),b=$(""),h=$(""),J=$(0),ee=$(0);U();const{t:te}=C(),le=$(!1),{handlePayment:ne,validatePayment:ie}=q(),Le=x((()=>J.value)),We=x((()=>{var e;return ee.value&&"number"==typeof(null==(e=y.value)?void 0:e.price)?0===y.value.price||ee.value>=y.value.price?100:Math.round(ee.value/y.value.price*100):0}));async function Ge(){var e,a,t,l;le.value=!0;try{const s=await H({body:{price_id:y.value.id,coupon_code:h.value}});if("error"===(null==(e=s.data)?void 0:e.status))return v.error(null==(a=s.data)?void 0:a.message);J.value=(null==(t=s.data)?void 0:t.data.amount)||0,ee.value=(null==(l=s.data)?void 0:l.data.deduct_amount)||0}catch(s){}finally{le.value=!1}}async function Je(){var e,a,t;if(ie(b.value,J.value)){le.value=!0;try{const l=await L({body:{price_id:y.value.id,coupon_code:h.value}});if("error"===(null==(e=l.data)?void 0:e.status))return v.error(null==(a=l.data)?void 0:a.message);const s=l.data.data.trade_no;(null==(t=l.data)?void 0:t.data.is_paid)?d.push(`/user/orders/${s}`).then((()=>{v.success(te("Order Payment Successful"))})):await ne(b.value,s)}catch(l){v.error(te("Order creation failed"))}finally{le.value=!1}}}return j(y,(()=>Ge()),{deep:!0}),S((async()=>{var e,a,t,l;le.value=!0;try{const s=await P({path:{id:Number(u.params.id)}});if("error"===(null==(e=s.data)?void 0:e.status))return v.error(null==(a=s.data)?void 0:a.message);m.value=null==(t=s.data)?void 0:t.data,y.value=null==(l=s.data)?void 0:l.data.prices[0],await Ge()}catch(s){}finally{le.value=!1}})),(e,c)=>(_(),N(a,{"header-title":e.$t("Subscription Details"),"toggle-header":!1,"show-footer":!1},{default:O((()=>[B(r,{class:"mx-auto p-4 md:p-10 space-y-6"},{default:O((()=>[B(A(Z),{show:le.value},{default:O((()=>[w("div",oe,[w("div",ce,[B(o,{to:"/user/plans",class:"hover:text-primary transition-colors"}),m.value.badge?(_(),N(A(t),{key:0,value:m.value.badge,type:"success"},null,8,["value"])):D("",!0)]),w("div",ue,[w("h1",de,F(m.value.name),1),w("p",ve,F(m.value.intro),1)]),B(A(X),{type:"info","show-icon":"",class:"mb-4"},{default:O((()=>[R(F(e.$t("Note that subscription purchases do not stack packages, only one subscription will be in effect at any one time, and the most recently purchased subscription will be applied immediately upon successful purchase.")),1)])),_:1}),w("div",pe,[w("div",fe,[B(A(T),{title:e.$t("Subscription Information"),class:"subscription-card",bordered:!1},{default:O((()=>[w("div",me,[(_(!0),g(I,null,E(m.value.features,(e=>(_(),g("div",{key:e,class:"flex space-x-2 items-center"},[w("div",ye,[B(A(l),{size:14,color:"#18a058",component:A(Q)},null,8,["component"])]),w("p",{class:"w-full",title:e},F(e),9,be)])))),128))])])),_:1},8,["title"]),B(A(T),{title:e.$t("Payment Cycle"),class:"subscription-card",bordered:!1},{default:O((()=>[w("div",xe,[(_(!0),g(I,null,E(m.value.prices,(a=>{var t;return _(),g("div",{key:a.id,class:G(["payment-option",{"payment-option-selected":a.id===y.value.id},{"payment-option-recommended":a.recommended}]),onClick:e=>y.value=a},[w("div",ge,[w("div",_e,[a.id===y.value.id?(_(),g("div",we)):D("",!0)])]),w("div",ke,[w("div",ze,[w("div",$e,[w("span",Ce,F(a.name),1),a.recommended?(_(),g("span",je,F(e.$t("Best value")),1)):D("",!0)]),a.id===y.value.id?(_(),g("div",Se,F(e.$t("Selected")),1)):D("",!0)]),w("div",Pe,F(A(i).currency(a.price,null==(t=A(p).configs)?void 0:t.app.currency,A(f).locale)),1),a.description?(_(),g("div",Ve,F(a.description),1)):D("",!0),a.features&&a.features.length>0?(_(),g("div",Ne,[(_(!0),g(I,null,E(a.features,((e,a)=>(_(),g("div",{key:a,class:"feature-item"},[c[3]||(c[3]=w("div",{class:"feature-dot"},null,-1)),w("span",null,F(e),1)])))),128))])):D("",!0)])],10,he)})),128))])])),_:1},8,["title"])]),w("div",Oe,[B(A(T),{class:"subscription-card",bordered:!1},{default:O((()=>[w("h3",He,[B(A(l),{component:A(se)},null,8,["component"]),w("span",null,F(e.$t("Apply Coupon")),1)]),B(A(s),null,{default:O((()=>[B(A(n),{value:h.value,"onUpdate:value":c[0]||(c[0]=e=>h.value=e),placeholder:e.$t("Enter coupon code")},null,8,["value","placeholder"]),B(A(M),{type:"primary",disabled:!h.value,onClick:c[1]||(c[1]=()=>{h.value&&Ge()})},{default:O((()=>[R(F(e.$t("Apply")),1)])),_:1},8,["disabled"])])),_:1})])),_:1}),B(A(T),{title:e.$t("Order Summary"),class:"subscription-card checkout-card",bordered:!1},{default:O((()=>{var a;return[w("div",Be,[w("div",Ae,[w("span",De,F(e.$t("Subscription")),1),w("span",null,F(m.value.name),1)]),w("div",Fe,[w("span",Re,F(e.$t("Plan")),1),w("span",null,F(y.value.name),1)]),ee.value>0?(_(),g("div",Te,[w("span",null,F(e.$t("Coupon Discount")),1),w("div",Ee,[w("span",null,"-"+F(A(i).currency(ee.value,null==(a=A(p).configs)?void 0:a.app.currency,A(f).locale)),1),We.value>0&&We.value<=100?(_(),N(A(t),{key:0,value:`-${We.value}%`,type:"success"},null,8,["value"])):D("",!0)])])):D("",!0),B(A(Y)),w("div",Ie,[w("span",Me,F(e.$t("Total")),1),B(A(ae),{value:Le.value,class:"text-2xl font-bold",style:{color:"#e53e3e"}},{prefix:O((()=>{var e;return[R(F(null==(e=A(p).configs)?void 0:e.app.currency),1)]})),_:1},8,["value"])]),J.value>0?(_(),g(I,{key:1},[B(K,{value:b.value,"onUpdate:value":c[2]||(c[2]=e=>b.value=e),class:"mt-2"},null,8,["value"]),B(A(M),{type:"primary",size:"large",block:"",disabled:""===b.value,onClick:Je,class:"mt-4"},{icon:O((()=>[B(A(l),{component:A(re)},null,8,["component"])])),default:O((()=>[R(" "+F(e.$t("Complete Purchase")),1)])),_:1},8,["disabled"])],64)):(_(),N(A(M),{key:2,type:"primary",size:"large",block:"",onClick:Je,class:"mt-4"},{default:O((()=>[R(F(e.$t("Confirm Order")),1)])),_:1}))])]})),_:1},8,["title"])])])])])),_:1},8,["show"])])),_:1})])),_:1},8,["header-title"]))}}),[["__scopeId","data-v-0898b0b5"]]);export{Le as default};
