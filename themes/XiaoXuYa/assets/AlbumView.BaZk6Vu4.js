import{d as a,i as e,u as l,a as t,o as s,b as u,z as o,q as r,F as i,ci as n,J as d,cj as v,e as p,f as c,x as m,y as f,B as _,A as g}from"./index.BwdMlFEt.js";import{_ as x,E as h}from"./ExploreImage.DBwEgo9n.js";import{W as y}from"./WaterfallLayout.CRdKSUiM.js";import{_ as w}from"./Content.vue_vue_type_script_setup_true_lang.DOatZPr-.js";import{a as b,_ as j,d as A,f as k}from"./Layout.vue_vue_type_script_setup_true_lang.CmpyqK56.js";const q={class:"w-full"},z={class:"container mx-auto p-4 sm:p-8"},$={class:"flex flex-col sm:flex-row sm:justify-between mb-10 w-full"},C={class:"flex flex-col"},E={class:"text-2xl mb-4 font-bold"},H={class:"flex items-center w-full"},L={class:"flex flex-col ml-2 w-full overflow-hidden"},N={class:"mt-4"},R={class:"flex justify-end mt-2 sm:mt-0"},T={class:"my-4"},W={style:{"padding-left":"6px","padding-right":"6px"}},B=a({__name:"AlbumView",setup(a){var B,D;const F=d(),I=l(),J=b(),U=e();U.configs&&!(null==(D=null==(B=U.configs)?void 0:B.app)?void 0:D.enable_explore)&&I.replace("/404");const V=t(null),G=t({}),K=t(0),M=t([]),O=t(""),P=t(1),Q=t(!1),S=t(!1);async function X(a={}){var e,l,t,s,u,o,r,i,d;if(!Q.value&&!S.value){Q.value=!0;try{const p=await n({path:{id:Number(F.params.id)}});if("error"===(null==(e=p.data)?void 0:e.status))return J.error(null==(l=p.data)?void 0:l.message),void(Q.value=!1);G.value=null==(t=p.data)?void 0:t.data;const c=await v({path:{id:Number(F.params.id)},query:{q:O.value,page:P.value,per_page:20,...a}});if("error"===(null==(s=c.data)?void 0:s.status))return J.error(null==(u=c.data)?void 0:u.message),void(Q.value=!1);const m=(null==(o=c.data)?void 0:o.data.data)||[];M.value.push(...m),K.value=(null==(r=c.data)?void 0:r.data.meta.total)||0,S.value=(null==(i=c.data)?void 0:i.data.meta.last_page)===(null==(d=c.data)?void 0:d.data.meta.current_page),m.length>0&&P.value++}catch(p){J.error("加载失败，请重试。")}finally{Q.value=!1}}}function Y(a){const e=a.target;100+e.scrollTop+e.clientHeight>=e.scrollHeight&&(Q.value||S.value||X())}function Z(){var a;null==(a=V.value)||a.open({path:{id:F.params.id}})}return s((()=>{X()})),(a,e)=>(p(),u(i,null,[o(x,{ref_key:"reportRef",ref:V,type:"album"},null,512),o(j,{"toggle-header":!1,"show-footer":!0,"header-title":a.$t("Album Details"),"on-scroll":Y},{default:r((()=>[o(w,null,{default:r((()=>{var e,l;return[c("div",q,[c("div",z,[c("div",$,[c("div",C,[c("p",E,m(G.value.name),1),c("div",H,[o(f(A),{class:"shrink-0",round:"",size:"medium",src:f(k).getUserAvatar(null==(e=G.value.user)?void 0:e.avatar_url)},null,8,["src"]),c("div",L,m(null==(l=G.value.user)?void 0:l.name),1)]),c("p",N,m(G.value.intro),1)]),c("div",R,[o(f(_),{secondary:"",strong:"",size:"small",onClick:Z},{default:r((()=>[g(m(a.$t("Report")),1)])),_:1})])]),c("p",T,m(a.$t("Total {count} photos",{count:K.value})),1)]),c("div",W,[o(y,{items:M.value.map((a=>({...a,id:a.id}))),"column-width":200,gap:6},{default:r((({item:a})=>[o(h,{photo:a},null,8,["photo"])])),_:1},8,["items"])])])]})),_:1})])),_:1},8,["header-title"])],64))}});export{B as default};
