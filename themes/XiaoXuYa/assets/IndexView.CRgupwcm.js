import{d as e,k as t,a,Z as r,B as s,u as l,p as n,q as o,z as i,y as d,N as u,f as c,P as p,aM as m,e as _}from"./index.DilSbsx1.js";import{_ as f}from"./Content.vue_vue_type_script_setup_true_lang.BvqggnOA.js";import{L as v,s as y,M as h,_ as k,h as g,N as w,O as x}from"./Layout.vue_vue_type_script_setup_true_lang.CBef50rk.js";import{_ as j}from"./DataTable.vue_vue_type_script_setup_true_lang.lgIikhec.js";import{u as b}from"./order.CdPBofOo.js";import{u as C}from"./composables.DH0Md89b.js";import"./Checkbox.GIjcFB4G.js";import"./Ellipsis.DrFQC8ng.js";const O={class:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between"},W={class:"grow md:grow-0 md:basis-1/2"},$=e({__name:"IndexView",setup(e){const $=l(),P=b(),{t:U}=t(),z=C(),M=a(),q=[{title:U("Order Number"),key:"trade_no",minWidth:250},{title:U("Product"),key:"snapshot.name",minWidth:300},{title:U("Payment Cycle"),key:"product.name",minWidth:200},{title:U("Order Amount"),key:"amount",minWidth:100,sorter:!0,align:"center"},{title:U("Order Status"),key:"status",minWidth:100,sorter:!0,align:"center",render(e){const t={cancelled:U("Cancelled"),unpaid:U("Unpaid"),paid:U("Paid")},a=e.status;return r(v,{type:{cancelled:"danger",unpaid:"warning",paid:"success"}[a]},{default:()=>t[a]??U("Unknown")})}},{title:U("Creation Time"),minWidth:200,key:"created_at",sorter:!0,align:"center",render:e=>y(e.created_at).format("L")},{title:U("Actions"),key:"actions",minWidth:170,fixed:"right",align:"center",render:e=>r(h,{vertical:!1,size:5,justify:"center"},{default:()=>[r(s,{size:"small",onClick:()=>{$.push(`/user/orders/${e.trade_no}`)}},{default:()=>U("Details")}),r(s,{disabled:"unpaid"!==e.status,size:"small",type:"error",onClick:async()=>{P.cancelOrder(e.trade_no,z,U).then((()=>{var e;K.value=[],null==(e=M.value)||e.refresh()}))}},{default:()=>U("Cancel Order")})]})}],D=a(""),E=a("sort:latest"),K=a([]),L=e=>m({query:{page:e,per_page:40,q:`${D.value} ${E.value}`.trim()}});function N(e){var t;e.order?E.value=`sort:${e.columnKey}:${e.order}`:E.value="sort:latest",null==(t=M.value)||t.refresh()}function A(){var e;null==(e=M.value)||e.refresh()}return(e,t)=>(_(),n(k,{"header-title":e.$t("Order Management"),"toggle-header":!1,"show-footer":!1},{default:o((()=>[i(f,{class:"mx-auto p-4 md:p-10 space-y-10"},{default:o((()=>[i(d(u),null,{default:o((()=>[i(d(h),{vertical:""},{default:o((()=>[c("div",O,[t[2]||(t[2]=c("div",null,null,-1)),c("div",W,[i(d(g),{value:D.value,"onUpdate:value":t[0]||(t[0]=e=>D.value=e),placeholder:e.$t("Enter keywords to search..."),onKeyup:p(A,["enter","native"])},{prefix:o((()=>[i(d(w),{component:d(x)},null,8,["component"])])),_:1},8,["value","placeholder"])])]),i(j,{striped:"",ref_key:"tableRef",ref:M,bordered:!1,fetch:L,columns:q,"row-key":e=>e.id,"checked-row-keys":K.value,"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>K.value=e),onUpdateSorter:N},null,8,["row-key","checked-row-keys"])])),_:1})])),_:1})])),_:1})])),_:1},8,["header-title"]))}});export{$ as default};
