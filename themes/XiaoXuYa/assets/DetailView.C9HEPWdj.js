import{a as e,_ as a,N as l,n as t,s as u}from"./Layout.vue_vue_type_script_setup_true_lang.CVCKf7J5.js";import{_ as n}from"./Content.vue_vue_type_script_setup_true_lang.Dbg-RI-4.js";import{d as r,b as s,e as o,f as c,a as i,i as d,aJ as m,k as p,c as v,o as f,v as _,x as y,aN as b,J as g,C as h,y as w,B as x,N as $,A as C,D as k,I as L,H as z,E as P}from"./index.CT88Sm32.js";import{_ as j}from"./Back.vue_vue_type_script_setup_true_lang.DS8I_LA8.js";import{u as O}from"./order.DxOKZBgy.js";import{u as N,_ as D}from"./usePayment.Dg3XkGLx.js";import{C as S}from"./CheckCircleOutlined.B03Ro8By.js";import{N as B,a as I}from"./DescriptionsItem.DOJDGP8K.js";import{u as M}from"./composables.DHPbJdtC.js";const T={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},U=[c("path",{d:"M685.4 354.8c0-4.4-3.6-8-8-8l-66 .3L512 465.6l-99.3-118.4l-66.1-.3c-4.4 0-8 3.5-8 8c0 1.9.7 3.7 1.9 5.2l130.1 155L340.5 670a8.32 8.32 0 0 0-1.9 5.2c0 4.4 3.6 8 8 8l66.1-.3L512 564.4l99.3 118.4l66 .3c4.4 0 8-3.5 8-8c0-1.9-.7-3.7-1.9-5.2L553.5 515l130.1-155c1.2-1.4 1.8-3.3 1.8-5.2z",fill:"currentColor"},null,-1),c("path",{d:"M512 65C264.6 65 64 265.6 64 513s200.6 448 448 448s448-200.6 448-448S759.4 65 512 65zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372s372 166.6 372 372s-166.6 372-372 372z",fill:"currentColor"},null,-1)],H=r({name:"CloseCircleOutlined",render:function(e,a){return o(),s("svg",T,U)}}),J={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},V=[c("path",{d:"M464 720a48 48 0 1 0 96 0a48 48 0 1 0-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z",fill:"currentColor"},null,-1)],A=r({name:"WarningOutlined",render:function(e,a){return o(),s("svg",J,V)}}),E={class:"flex flex-col space-y-3 my-6 items-center justify-center"},Q={class:"flex space-x-1 w-full items-center"},R=["title"],W={class:"text-red-500"},q={class:"text-red-500"},F={key:0,class:"text-xs"},G={key:0},K={class:"flex justify-end space-x-2 w-full mt-4"},X=r({__name:"DetailView",setup(r){const T=g(),U=e(),J=M(),V=i({}),X=d(),Y=O(),Z=m(),{t:ee}=p(),ae=i(""),{handlePayment:le,validatePayment:te}=N();async function ue(){var e,a,l;const t=await b({path:{trade_no:T.params.trade_no.toString()}});if("error"===(null==(e=t.data)?void 0:e.status))return U.error(null==(a=t.data)?void 0:a.message);V.value=null==(l=t.data)?void 0:l.data}const ne=v((()=>({cancelled:ee("Cancelled"),unpaid:ee("Unpaid"),paid:ee("Paid")}))),re=v((()=>({cancelled:"red",unpaid:"yellow",paid:"green"}))),se={cancelled:H,unpaid:A,paid:S};async function oe(){te(ae.value,V.value.amount)&&await le(ae.value,T.params.trade_no.toString())}async function ce(){try{await Y.cancelOrder(T.params.trade_no.toString(),J,ee),U.success(ee("Cancellation successful")),ue()}catch(e){}}return f((()=>{ue()})),(e,r)=>(o(),_(a,{"header-title":e.$t("Order Details"),"toggle-header":!1,"show-footer":!1},{default:y((()=>[h(n,{class:"mx-auto p-4 md:p-10 space-y-5"},{default:y((()=>[h(j,{to:"/user/orders"}),h(x($),null,{default:y((()=>[c("div",E,[h(x(l),{size:50,color:re.value[V.value.status],component:se[V.value.status]},null,8,["color","component"]),c("p",null,C(ne.value[V.value.status]),1)])])),_:1}),h(x($),{title:e.$t("Package Snapshot")},{default:y((()=>[h(x(B),{"content-class":"ml-10",columns:1,size:"large","label-placement":"left",separator:""},{default:y((()=>[h(x(I),{label:e.$t("Name")},{default:y((()=>{var e;return[k(C(null==(e=V.value.snapshot)?void 0:e.name),1)]})),_:1},8,["label"]),h(x(I),{label:e.$t("Intro")},{default:y((()=>{var e;return[k(C(null==(e=V.value.snapshot)?void 0:e.intro),1)]})),_:1},8,["label"]),h(x(I),{label:e.$t("Badge")},{default:y((()=>{var e;return[k(C(null==(e=V.value.snapshot)?void 0:e.badge),1)]})),_:1},8,["label"]),h(x(I),{label:e.$t("Privileges")},{default:y((()=>{var e;return[(o(!0),s(z,null,L((null==(e=V.value.snapshot)?void 0:e.features)||[],(e=>(o(),s("div",Q,[h(x(l),{size:16,color:"green",component:x(S)},null,8,["component"]),c("p",{class:"w-full truncate",title:e},C(e),9,R)])))),256))]})),_:1},8,["label"])])),_:1})])),_:1},8,["title"]),h(x($),{title:e.$t("Product Information")},{default:y((()=>[h(x(B),{"content-class":"ml-10",columns:1,size:"large","label-placement":"left",separator:""},{default:y((()=>[h(x(I),{label:e.$t("Name")},{default:y((()=>{var e;return[k(C(null==(e=V.value.product)?void 0:e.name),1)]})),_:1},8,["label"]),h(x(I),{label:e.$t("Duration")},{default:y((()=>{var a;return[k(C(e.$t("{minutes} minutes",{minutes:null==(a=V.value.product)?void 0:a.duration})),1)]})),_:1},8,["label"]),h(x(I),{label:e.$t("Price")},{default:y((()=>{var e,a;return[c("p",W,C(x(t).currency(null==(e=V.value.product)?void 0:e.price,null==(a=x(X).configs)?void 0:a.app.currency,x(Z).locale)),1)]})),_:1},8,["label"])])),_:1})])),_:1},8,["title"]),h(x($),{title:e.$t("Order Information")},{default:y((()=>[h(x(B),{"content-class":"ml-10",columns:1,size:"large","label-placement":"left",separator:""},{default:y((()=>[h(x(I),{label:e.$t("Order Number")},{default:y((()=>[k(C(V.value.trade_no),1)])),_:1},8,["label"]),h(x(I),{label:e.$t("Order Status")},{default:y((()=>[k(C(ne.value[V.value.status]),1)])),_:1},8,["label"]),V.value.pay_method?(o(),_(x(I),{key:0,label:e.$t("Payment Method")},{default:y((()=>[k(C(V.value.pay_method),1)])),_:1},8,["label"])):w("",!0),V.value.paid_at?(o(),_(x(I),{key:1,label:e.$t("Payment Time")},{default:y((()=>[k(C(x(u)(V.value.paid_at).format("LLL")),1)])),_:1},8,["label"])):w("",!0),V.value.canceled_at?(o(),_(x(I),{key:2,label:e.$t("Cancellation Time")},{default:y((()=>[k(C(x(u)(V.value.canceled_at).format("LLL")),1)])),_:1},8,["label"])):w("",!0),h(x(I),{label:e.$t("Creation Time")},{default:y((()=>[k(C(x(u)(V.value.created_at).format("LLL")),1)])),_:1},8,["label"]),h(x(I),{label:e.$t("Total Price")},{default:y((()=>{var a,l;return[c("p",q,C(x(t).currency(V.value.amount,null==(a=x(X).configs)?void 0:a.app.currency,x(Z).locale)),1),V.value.deduct_amount>0?(o(),s("span",F,C(e.$t("Use the coupon to deduct {amount}",{amount:x(t).currency(V.value.deduct_amount,null==(l=x(X).configs)?void 0:l.app.currency,x(Z).locale)})),1)):w("",!0)]})),_:1},8,["label"])])),_:1})])),_:1},8,["title"]),"unpaid"===V.value.status?(o(),s("div",G,[h(x($),{title:e.$t("Checkout")},{default:y((()=>[V.value.amount>0?(o(),_(D,{key:0,value:ae.value,"onUpdate:value":r[0]||(r[0]=e=>ae.value=e)},null,8,["value"])):w("",!0),c("div",K,[V.value.amount>0?(o(),_(x(P),{key:0,type:"primary",disabled:""===ae.value,size:"small",onClick:oe},{default:y((()=>[k(C(e.$t("Proceed to Payment")),1)])),_:1},8,["disabled"])):(o(),_(x(P),{key:1,type:"primary",size:"small",onClick:oe},{default:y((()=>[k(C(e.$t("Pay Now")),1)])),_:1})),h(x(P),{type:"error",size:"small",onClick:ce},{default:y((()=>[k(C(e.$t("Cancel Order")),1)])),_:1})])])),_:1},8,["title"])])):w("",!0)])),_:1})])),_:1},8,["header-title"]))}});export{X as default};
