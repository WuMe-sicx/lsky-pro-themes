import{$ as e,d as t,m as a,a as s,aB as r,B as o,aC as l,s as n,v as i,h as d,z as u,N as c,f as p,A as m,y as f,O as y,aD as h,e as v}from"./index-DKzf3TMO.js";import{_}from"./Content.vue_vue_type_script_setup_true_lang-CGEjm_tA.js";import{g as w,a as g,I as k,n as x,r as C,x as b,J as j,_ as D,N as $,S as L}from"./Layout.vue_vue_type_script_setup_true_lang-BRRcuvRl.js";import{_ as T}from"./DataTable.vue_vue_type_script_setup_true_lang-QegQ-Qi6.js";import{D as z}from"./DeleteOutlined-Daecp8an.js";import{u as A}from"./composables-B9wCYdts.js";import"./Checkbox-BBdeyiKG.js";import"./Ellipsis-DiUODvwn.js";const S={password:function(t,a={}){return e(w,{type:"password",showPasswordOn:"click",defaultValue:t,...a})}},P={class:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between"},W={class:"grow md:grow-0 md:basis-1/2"},N=t({__name:"IndexView",setup(t){const N=g(),E=A(),{t:K}=a(),O=s(),U=[{type:"selection"},{title:K("Type"),key:"type",width:100,align:"center",render:t=>e(k,null,{default:()=>"photo"===t.type?K("Photo"):K("Album")})},{title:K("Password"),key:"password",minWidth:180,render:e=>e.password?S.password(e.password,{size:"small",onChange(t){r({path:{id:e.id},body:{password:t}}).then(()=>{N.success(K("Successfully updated"))}).catch(()=>{N.error(K("Modification failed"))})}}):K("None")},{title:K("Views"),key:"view_count",minWidth:100,align:"center",sorter:!0,render:e=>x.format(e.view_count)},{title:K("Expiration Time"),minWidth:200,key:"expired_at",sorter:!0,align:"center",render:e=>e.expired_at?C(e.expired_at).format("LLL"):K("None")},{title:K("Creation Time"),minWidth:200,key:"created_at",sorter:!0,align:"center",render:e=>C(e.created_at).format("LLL")},{title:K("Actions"),key:"actions",minWidth:170,fixed:"right",align:"center",render:t=>e(j,{vertical:!1,size:5,justify:"center"},{default:()=>[e(o,{size:"small",onClick:()=>{b.copyText(`${window.location.origin}/shares/${t.slug}`).then(()=>{N.success(K("Copy successful"))}).catch(()=>{N.error(K("Copy failed"))})}},{default:()=>K("Copy Link")}),e(o,{size:"small",type:"error",onClick:()=>{R([t.id],{title:K("Delete Share"),content:K("Are you sure you want to delete this share?")})}},{default:()=>K("Delete")})]})}],V=s(""),q=s("sort:latest"),B=s([]),I=e=>h({query:{page:e,per_page:40,q:`${V.value} ${q.value}`.trim()}});function M(e){var t;e.order?q.value=`sort:${e.columnKey}:${e.order}`:q.value="sort:latest",null==(t=O.value)||t.refresh()}function R(e,t){const a=E.warning({positiveText:K("Confirm"),negativeText:K("Cancel"),onPositiveClick:()=>(a.loading=!0,new Promise(t=>{l({body:e}).then(()=>{var e;N.success(K("Deleted successfully")),B.value=[],null==(e=O.value)||e.refresh(),t(!0)}).finally(()=>{a.loading=!1})})),...t})}function H(){var e;null==(e=O.value)||e.refresh()}return(e,t)=>(v(),n(D,{"header-title":e.$t("My Shares"),"toggle-header":!1,"show-footer":!1},{default:i(()=>[d(_,{class:"mx-auto p-4 md:p-10 space-y-10"},{default:i(()=>[d(u(c),null,{default:i(()=>[d(u(j),{vertical:""},{default:i(()=>[p("div",P,[p("div",null,[d(u(o),{type:"error",size:"small",disabled:B.value.length<=0,onClick:t[0]||(t[0]=()=>{R(B.value.map(e=>e),{title:u(K)("Delete Share"),content:u(K)("Are you sure you want to delete the selected {count} shares?",{count:B.value.length})})})},{icon:i(()=>[d(u($),{component:u(z)},null,8,["component"])]),default:i(()=>[m(" "+f(e.$t("Delete")),1)]),_:1},8,["disabled"])]),p("div",W,[d(u(w),{value:V.value,"onUpdate:value":t[1]||(t[1]=e=>V.value=e),placeholder:e.$t("Enter keywords to search..."),onKeyup:y(H,["enter","native"])},{prefix:i(()=>[d(u($),{component:u(L)},null,8,["component"])]),_:1},8,["value","placeholder"])])]),d(T,{striped:"",ref_key:"tableRef",ref:O,bordered:!1,fetch:I,columns:U,"row-key":e=>e.id,"checked-row-keys":B.value,"onUpdate:checkedRowKeys":t[2]||(t[2]=e=>B.value=e),onUpdateSorter:M},null,8,["row-key","checked-row-keys"])]),_:1})]),_:1})]),_:1})]),_:1},8,["header-title"]))}});export{N as default};
