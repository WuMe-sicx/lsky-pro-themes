import{d as e,m as t,a,$ as r,B as s,j as l,s as n,v as o,h as i,z as d,N as u,f as c,O as p,aL as m,e as _}from"./index-DKzf3TMO.js";import{_ as f}from"./Content.vue_vue_type_script_setup_true_lang-CGEjm_tA.js";import{I as v,r as y,J as h,_ as k,g,N as w,S as j}from"./Layout.vue_vue_type_script_setup_true_lang-BRRcuvRl.js";import{_ as x}from"./DataTable.vue_vue_type_script_setup_true_lang-QegQ-Qi6.js";import{u as b}from"./order-Bn48_IHo.js";import{u as C}from"./composables-B9wCYdts.js";import"./Checkbox-BBdeyiKG.js";import"./Ellipsis-DiUODvwn.js";const O={class:"flex flex-col gap-2 md:flex-row md:items-center md:justify-between"},$={class:"grow md:grow-0 md:basis-1/2"},W=e({__name:"IndexView",setup(e){const W=l(),U=b(),{t:z}=t(),L=C(),A=a(),D=[{title:z("Order Number"),key:"trade_no",minWidth:250},{title:z("Product"),key:"snapshot.name",minWidth:300},{title:z("Payment Cycle"),key:"product.name",minWidth:200},{title:z("Order Amount"),key:"amount",minWidth:100,sorter:!0,align:"center"},{title:z("Order Status"),key:"status",minWidth:100,sorter:!0,align:"center",render(e){const t={cancelled:z("Cancelled"),unpaid:z("Unpaid"),paid:z("Paid")},a=e.status;return r(v,{type:{cancelled:"danger",unpaid:"warning",paid:"success"}[a]},{default:()=>t[a]??z("Unknown")})}},{title:z("Creation Time"),minWidth:200,key:"created_at",sorter:!0,align:"center",render:e=>y(e.created_at).format("L")},{title:z("Actions"),key:"actions",minWidth:170,fixed:"right",align:"center",render:e=>r(h,{vertical:!1,size:5,justify:"center"},{default:()=>[r(s,{size:"small",onClick:()=>{W.push(`/user/orders/${e.trade_no}`)}},{default:()=>z("Details")}),r(s,{disabled:"unpaid"!==e.status,size:"small",type:"error",onClick:async()=>{U.cancelOrder(e.trade_no,L,z).then(()=>{var e;P.value=[],null==(e=A.value)||e.refresh()})}},{default:()=>z("Cancel Order")})]})}],K=a(""),N=a("sort:latest"),P=a([]),S=e=>m({query:{page:e,per_page:40,q:`${K.value} ${N.value}`.trim()}});function q(e){var t;e.order?N.value=`sort:${e.columnKey}:${e.order}`:N.value="sort:latest",null==(t=A.value)||t.refresh()}function E(){var e;null==(e=A.value)||e.refresh()}return(e,t)=>(_(),n(k,{"header-title":e.$t("Order Management"),"toggle-header":!1,"show-footer":!1},{default:o(()=>[i(f,{class:"mx-auto p-4 md:p-10 space-y-10"},{default:o(()=>[i(d(u),null,{default:o(()=>[i(d(h),{vertical:""},{default:o(()=>[c("div",O,[t[2]||(t[2]=c("div",null,null,-1)),c("div",$,[i(d(g),{value:K.value,"onUpdate:value":t[0]||(t[0]=e=>K.value=e),placeholder:e.$t("Enter keywords to search..."),onKeyup:p(E,["enter","native"])},{prefix:o(()=>[i(d(w),{component:d(j)},null,8,["component"])]),_:1},8,["value","placeholder"])])]),i(x,{striped:"",ref_key:"tableRef",ref:A,bordered:!1,fetch:S,columns:D,"row-key":e=>e.id,"checked-row-keys":P.value,"onUpdate:checkedRowKeys":t[1]||(t[1]=e=>P.value=e),onUpdateSorter:q},null,8,["row-key","checked-row-keys"])]),_:1})]),_:1})]),_:1})]),_:1},8,["header-title"]))}});export{W as default};
