import{d as e,b as a,e as t,f as s,z as l,y as o,u as r,l as n,j as c,a as i,I as u,c as d,o as v,s as m,v as x,c9 as p,H as b,ca as h,c8 as f,af as g,g as k,h as z,n as w,A as y,F as _,x as j,cb as C,cc as $}from"./index-DKzf3TMO.js";import{E as M}from"./ExploreImage-6W_f9YrQ.js";import{n as H,a as V,_ as A,a9 as L,N as U,aa as q,d as B}from"./Layout.vue_vue_type_script_setup_true_lang-BRRcuvRl.js";import{W as P}from"./WaterfallLayout-B-kJbIBO.js";import{N as D}from"./Upload-Bzpebt8V.js";const I="/assets/empty-image-Dvbju7a-.png",N={class:"flex overflow-hidden rounded-md h-[200px]"},E={class:"flex basis-2/3 border-r shrink-0"},S=["src"],W={class:"flex basis-1/3 flex-col"},F=["src"],O=["src"],T={class:"flex flex-col w-full mt-4 space-y-2"},G={class:"text-base truncate"},J={class:"text-md text-gray-500 dark:text-gray-400"},K=e({__name:"ExploreAlbum",props:{album:{type:Object,required:!0,default:()=>{}}},setup(e){const r=e;return(e,n)=>(t(),a("div",{class:"flex flex-col w-full hover:opacity-75 transition-all cursor-pointer",onClick:n[0]||(n[0]=()=>{return e=`/explore/albums/${r.album.id}`,void window.open(e,"_blank");var e})},[s("div",N,[s("div",E,[s("img",{src:r.album.covers[0]||l(I),alt:"Album Cover",class:"w-full h-full object-cover"},null,8,S)]),s("div",W,[s("img",{src:r.album.covers[1]||l(I),alt:"Album Cover",class:"w-full h-full border-b object-cover shrink-0 overflow-hidden basis-1/2"},null,8,F),s("img",{src:r.album.covers[2]||l(I),alt:"Album Cover",class:"w-full h-full object-cover shrink-0 overflow-hidden basis-1/2"},null,8,O)])]),s("div",T,[s("p",G,o(r.album.name),1),s("p",J,o(e.$t("{count} photos",{count:l(H).format(r.album.photo_count||0)}))+" · Curated by "+o(r.album.user.name),1)])]))}}),Q={class:"min-h-screen bg-white dark:bg-zinc-950"},R={class:"relative"},X={key:0,class:"absolute inset-0 bg-black/20"},Y={key:1,class:"absolute top-4 right-4 z-10"},Z={class:"flex items-center gap-2 px-3 py-2 rounded-lg bg-white/90 dark:bg-zinc-800/90 text-zinc-700 dark:text-zinc-300 text-sm font-medium hover:bg-white dark:hover:bg-zinc-700 transition-colors shadow-sm"},ee={class:"max-w-screen-xl mx-auto px-4 sm:px-6"},ae={class:"relative -mt-16 sm:-mt-20 pb-6"},te={class:"flex flex-col sm:flex-row items-center sm:items-end gap-4"},se={class:"relative"},le=["src","alt"],oe={class:"flex-1 text-center sm:text-left pb-2"},re={class:"text-2xl sm:text-3xl font-bold text-zinc-900 dark:text-zinc-100"},ne={class:"text-zinc-500 dark:text-zinc-400 mt-1"},ce={key:0,class:"text-zinc-600 dark:text-zinc-400 mt-2 max-w-lg"},ie={class:"flex items-center gap-6 sm:gap-8"},ue={class:"text-center"},de={class:"text-xl sm:text-2xl font-bold text-zinc-900 dark:text-zinc-100"},ve={class:"text-xs text-zinc-500 dark:text-zinc-400"},me={class:"text-center"},xe={class:"text-xl sm:text-2xl font-bold text-zinc-900 dark:text-zinc-100"},pe={class:"text-xs text-zinc-500 dark:text-zinc-400"},be={class:"sticky top-0 z-20 bg-white/80 dark:bg-zinc-950/80 backdrop-blur-md border-b border-zinc-100 dark:border-zinc-900"},he={class:"max-w-screen-xl mx-auto px-4 sm:px-6"},fe={class:"flex items-center gap-1"},ge={class:"flex items-center gap-2"},ke={class:"text-xs text-zinc-400"},ze={key:0,class:"absolute bottom-0 left-0 right-0 h-0.5 bg-zinc-900 dark:bg-zinc-100"},we={class:"flex items-center gap-2"},ye={class:"text-xs text-zinc-400"},_e={key:0,class:"absolute bottom-0 left-0 right-0 h-0.5 bg-zinc-900 dark:bg-zinc-100"},je={class:"max-w-screen-xl mx-auto"},Ce={key:0,class:"px-2 sm:px-4 py-6"},$e={key:1,class:"flex flex-col items-center justify-center py-24"},Me={class:"text-zinc-500 dark:text-zinc-400 text-sm"},He={key:1,class:"px-4 sm:px-6 py-6"},Ve={key:0,class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4"},Ae={key:1,class:"flex flex-col items-center justify-center py-24"},Le={class:"text-zinc-500 dark:text-zinc-400 text-sm"},Ue={key:2,class:"flex justify-center py-8"},qe={class:"flex items-center gap-2 text-zinc-400"},Be={class:"text-sm"},Pe=e({__name:"UserCenterView",setup(e){var H,I;const N=b(),E=c(),S=V(),W=r(),F=n();W.configs&&!(null==(I=null==(H=W.configs)?void 0:H.app)?void 0:I.enable_explore)&&E.replace("/404");const O=i({}),T=i("photo"),G=i([]),J=i(""),Pe=i(1),De=i(!1),Ie=i(!1),Ne=i(Date.now());async function Ee(e={}){var a,t,s,l,o;if(!De.value&&!Ie.value){De.value=!0;try{const r={photo:f,album:h},n=await r[T.value]({query:{q:J.value,page:Pe.value,username:O.value.username,per_page:20,...e}});if("error"===(null==(a=n.data)?void 0:a.status))return S.error(null==(t=n.data)?void 0:t.message),void(De.value=!1);const c=(null==(s=n.data)?void 0:s.data.data)||[];G.value.push(...c),Ie.value=(null==(l=n.data)?void 0:l.data.meta.last_page)===(null==(o=n.data)?void 0:o.data.meta.current_page),c.length>0&&Pe.value++}catch(r){}finally{De.value=!1}}}function Se(e){const a=e.target;100+a.scrollTop+a.clientHeight>=a.scrollHeight&&(De.value||Ie.value||Ee())}u(T,()=>{G.value=[],J.value="",Pe.value=1,De.value=!1,Ie.value=!1,Ee()});const We=d(()=>{var e;return F.isLoggedIn&&(null==(e=F.profile)?void 0:e.username)===O.value.username});async function Fe(e){var a,t;try{const s=await C({body:{background:e.file.file}});"success"===(null==(a=s.data)?void 0:a.status)?(S.success("背景图片设置成功"),Ne.value=Date.now(),await F.fetchUserProfile(),await Te()):S.error((null==(t=s.data)?void 0:t.message)||"设置失败")}catch(s){S.error("设置失败，请重试")}}async function Oe(){var e,a;try{const t=await $();"success"===(null==(e=t.data)?void 0:e.status)?(S.success("背景图片已移除"),Ne.value=Date.now(),await F.fetchUserProfile(),await Te()):S.error((null==(a=t.data)?void 0:a.message)||"移除失败")}catch(t){S.error("移除失败，请重试")}}async function Te(){var e,a,t;try{const s=await p({path:{username:N.params.username.toString()}});if("error"===(null==(e=s.data)?void 0:e.status))return E.back(),S.error(null==(a=s.data)?void 0:a.message);O.value=null==(t=s.data)?void 0:t.data,Ee()}catch(s){}}return v(()=>{Te()}),(e,r)=>(t(),m(A,{"toggle-header":!1,"show-footer":!0,"header-title":e.$t("Square"),"on-scroll":Se},{default:x(()=>[s("div",Q,[s("div",R,[s("div",{class:"h-48 sm:h-64 md:h-80 bg-zinc-100 dark:bg-zinc-900",style:g(O.value.background_url?{backgroundImage:`url(${O.value.background_url}?t=${Ne.value})`,backgroundSize:"cover",backgroundPosition:"center"}:{})},[O.value.background_url?(t(),a("div",X)):k("",!0),We.value?(t(),a("div",Y,[O.value.background_url?(t(),a("button",{key:1,onClick:Oe,class:"flex items-center gap-2 px-3 py-2 rounded-lg bg-black/40 backdrop-blur-sm text-white text-sm font-medium hover:bg-black/60 transition-colors"},[z(l(U),{component:l(q),size:16},null,8,["component"]),r[3]||(r[3]=s("span",{class:"hidden sm:inline"},"移除背景",-1))])):(t(),m(l(D),{key:0,"show-file-list":!1,accept:"image/*",max:1,"custom-request":Fe},{default:x(()=>[s("button",Z,[z(l(U),{component:l(L),size:16},null,8,["component"]),r[2]||(r[2]=s("span",{class:"hidden sm:inline"},"设置背景",-1))])]),_:1}))])):k("",!0)],4),s("div",ee,[s("div",ae,[s("div",te,[s("div",se,[s("img",{src:l(B).getUserAvatar(O.value.avatar_url),alt:O.value.name,class:"w-28 h-28 sm:w-36 sm:h-36 rounded-full object-cover border-4 border-white dark:border-zinc-950 shadow-lg"},null,8,le)]),s("div",oe,[s("h1",re,o(O.value.name),1),s("p",ne,"@"+o(O.value.username),1),O.value.intro?(t(),a("p",ce,o(O.value.intro),1)):k("",!0)]),s("div",ie,[s("div",ue,[s("div",de,o(O.value.photo_count||0),1),s("div",ve,o(e.$t("Photo")),1)]),s("div",me,[s("div",xe,o(O.value.album_count||0),1),s("div",pe,o(e.$t("Album")),1)])])])])])]),s("div",be,[s("div",he,[s("div",fe,[s("button",{onClick:r[0]||(r[0]=e=>T.value="photo"),class:w(["relative px-4 py-4 text-sm font-medium transition-colors","photo"===T.value?"text-zinc-900 dark:text-zinc-100":"text-zinc-500 dark:text-zinc-400 hover:text-zinc-700 dark:hover:text-zinc-300"])},[s("div",ge,[r[4]||(r[4]=s("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),y(" "+o(e.$t("Photo"))+" ",1),s("span",ke,o(O.value.photo_count>999?"999+":O.value.photo_count),1)]),"photo"===T.value?(t(),a("div",ze)):k("",!0)],2),s("button",{onClick:r[1]||(r[1]=e=>T.value="album"),class:w(["relative px-4 py-4 text-sm font-medium transition-colors","album"===T.value?"text-zinc-900 dark:text-zinc-100":"text-zinc-500 dark:text-zinc-400 hover:text-zinc-700 dark:hover:text-zinc-300"])},[s("div",we,[r[5]||(r[5]=s("svg",{class:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})],-1)),y(" "+o(e.$t("Album"))+" ",1),s("span",ye,o(O.value.album_count>999?"999+":O.value.album_count),1)]),"album"===T.value?(t(),a("div",_e)):k("",!0)],2)])])]),s("div",je,["photo"===T.value?(t(),a("div",Ce,[G.value.length>0?(t(),m(P,{key:0,items:G.value.map(e=>({...e,id:e.id})),"column-width":280,gap:16},{default:x(({item:e})=>[z(M,{photo:e,photos:G.value},null,8,["photo","photos"])]),_:1},8,["items"])):De.value?k("",!0):(t(),a("div",$e,[r[6]||(r[6]=s("div",{class:"w-20 h-20 mb-4 rounded-full bg-zinc-100 dark:bg-zinc-800 flex items-center justify-center"},[s("svg",{class:"w-8 h-8 text-zinc-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})])],-1)),s("p",Me,o(e.$t("No photos yet")),1)]))])):k("",!0),"album"===T.value?(t(),a("div",He,[G.value.length>0?(t(),a("div",Ve,[(t(!0),a(_,null,j(G.value,e=>(t(),m(K,{album:e,key:e.id},null,8,["album"]))),128))])):De.value?k("",!0):(t(),a("div",Ae,[r[7]||(r[7]=s("div",{class:"w-20 h-20 mb-4 rounded-full bg-zinc-100 dark:bg-zinc-800 flex items-center justify-center"},[s("svg",{class:"w-8 h-8 text-zinc-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})])],-1)),s("p",Le,o(e.$t("No albums yet")),1)]))])):k("",!0),De.value?(t(),a("div",Ue,[s("div",qe,[r[8]||(r[8]=s("svg",{class:"w-5 h-5 animate-spin",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),s("span",Be,o(e.$t("Loading"))+"...",1)])])):k("",!0)])])]),_:1},8,["header-title"]))}});export{Pe as default};
