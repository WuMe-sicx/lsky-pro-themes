import{d as a,u as e,j as l,a as t,o as s,b as u,h as o,v as r,F as i,ch as n,H as d,ci as v,e as c,f as p,y as m,z as f,B as _,A as g}from"./index-DKzf3TMO.js";import{_ as h,E as x}from"./ExploreImage-6W_f9YrQ.js";import{W as y}from"./WaterfallLayout-B-kJbIBO.js";import{_ as w}from"./Content.vue_vue_type_script_setup_true_lang-CGEjm_tA.js";import{a as b,_ as j,c as A,d as k}from"./Layout.vue_vue_type_script_setup_true_lang-BRRcuvRl.js";const z={class:"w-full"},H={class:"container mx-auto p-4 sm:p-8"},$={class:"flex flex-col sm:flex-row sm:justify-between mb-10 w-full"},q={class:"flex flex-col"},C={class:"text-2xl mb-4 font-bold"},E={class:"flex items-center w-full"},L={class:"flex flex-col ml-2 w-full overflow-hidden"},N={class:"mt-4"},R={class:"flex justify-end mt-2 sm:mt-0"},T={class:"my-4"},W={style:{"padding-left":"6px","padding-right":"6px"}},B=a({__name:"AlbumView",setup(a){var B,D;const F=d(),I=l(),U=b(),V=e();V.configs&&!(null==(D=null==(B=V.configs)?void 0:B.app)?void 0:D.enable_explore)&&I.replace("/404");const G=t(null),J=t({}),K=t(0),M=t([]),O=t(""),P=t(1),Q=t(!1),S=t(!1);async function X(a={}){var e,l,t,s,u,o,r,i,d;if(!Q.value&&!S.value){Q.value=!0;try{const c=await n({path:{id:Number(F.params.id)}});if("error"===(null==(e=c.data)?void 0:e.status))return U.error(null==(l=c.data)?void 0:l.message),void(Q.value=!1);J.value=null==(t=c.data)?void 0:t.data;const p=await v({path:{id:Number(F.params.id)},query:{q:O.value,page:P.value,per_page:20,...a}});if("error"===(null==(s=p.data)?void 0:s.status))return U.error(null==(u=p.data)?void 0:u.message),void(Q.value=!1);const m=(null==(o=p.data)?void 0:o.data.data)||[];M.value.push(...m),K.value=(null==(r=p.data)?void 0:r.data.meta.total)||0,S.value=(null==(i=p.data)?void 0:i.data.meta.last_page)===(null==(d=p.data)?void 0:d.data.meta.current_page),m.length>0&&P.value++}catch(c){U.error("加载失败，请重试。")}finally{Q.value=!1}}}function Y(a){const e=a.target;100+e.scrollTop+e.clientHeight>=e.scrollHeight&&(Q.value||S.value||X())}function Z(){var a;null==(a=G.value)||a.open({path:{id:F.params.id}})}return s(()=>{X()}),(a,e)=>(c(),u(i,null,[o(h,{ref_key:"reportRef",ref:G,type:"album"},null,512),o(j,{"toggle-header":!1,"show-footer":!0,"header-title":a.$t("Album Details"),"on-scroll":Y},{default:r(()=>[o(w,null,{default:r(()=>{var e,l;return[p("div",z,[p("div",H,[p("div",$,[p("div",q,[p("p",C,m(J.value.name),1),p("div",E,[o(f(A),{class:"shrink-0",round:"",size:"medium",src:f(k).getUserAvatar(null==(e=J.value.user)?void 0:e.avatar_url)},null,8,["src"]),p("div",L,m(null==(l=J.value.user)?void 0:l.name),1)]),p("p",N,m(J.value.intro),1)]),p("div",R,[o(f(_),{secondary:"",strong:"",size:"small",onClick:Z},{default:r(()=>[g(m(a.$t("Report")),1)]),_:1})])]),p("p",T,m(a.$t("Total {count} photos",{count:K.value})),1)]),p("div",W,[o(y,{items:M.value.map(a=>({...a,id:a.id})),"column-width":200,gap:6},{default:r(({item:a})=>[o(x,{photo:a},null,8,["photo"])]),_:1},8,["items"])])])]}),_:1})]),_:1},8,["header-title"])],64))}});export{B as default};
