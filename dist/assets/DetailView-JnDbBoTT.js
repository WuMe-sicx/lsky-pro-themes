import{a as e,_ as a,N as l,n as t,r as u}from"./Layout.vue_vue_type_script_setup_true_lang-BRRcuvRl.js";import{_ as n}from"./Content.vue_vue_type_script_setup_true_lang-CGEjm_tA.js";import{d as r,b as s,e as o,f as c,a as i,u as d,aI as m,m as p,c as v,o as f,s as _,v as y,aM as b,H as g,h,g as w,z as x,N as $,y as C,A as k,x as z,F as L,B as P}from"./index-DKzf3TMO.js";import{_ as j}from"./Back.vue_vue_type_script_setup_true_lang-i2ZA4QCP.js";import{u as O}from"./order-Bn48_IHo.js";import{u as N,_ as S}from"./usePayment-FrPjbpXw.js";import{C as B}from"./CheckCircleOutlined-LmT7nbt4.js";import{N as I,a as M}from"./DescriptionsItem-CDAJ72Yx.js";import{u as D}from"./composables-B9wCYdts.js";const T={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},U=[c("path",{d:"M685.4 354.8c0-4.4-3.6-8-8-8l-66 .3L512 465.6l-99.3-118.4l-66.1-.3c-4.4 0-8 3.5-8 8c0 1.9.7 3.7 1.9 5.2l130.1 155L340.5 670a8.32 8.32 0 0 0-1.9 5.2c0 4.4 3.6 8 8 8l66.1-.3L512 564.4l99.3 118.4l66 .3c4.4 0 8-3.5 8-8c0-1.9-.7-3.7-1.9-5.2L553.5 515l130.1-155c1.2-1.4 1.8-3.3 1.8-5.2z",fill:"currentColor"},null,-1),c("path",{d:"M512 65C264.6 65 64 265.6 64 513s200.6 448 448 448s448-200.6 448-448S759.4 65 512 65zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372s372 166.6 372 372s-166.6 372-372 372z",fill:"currentColor"},null,-1)],H=r({name:"CloseCircleOutlined",render:function(e,a){return o(),s("svg",T,U)}}),V={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},A=[c("path",{d:"M464 720a48 48 0 1 0 96 0a48 48 0 1 0-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z",fill:"currentColor"},null,-1)],F=r({name:"WarningOutlined",render:function(e,a){return o(),s("svg",V,A)}}),K={class:"flex flex-col space-y-3 my-6 items-center justify-center"},Q={class:"flex space-x-1 w-full items-center"},W=["title"],q={class:"text-red-500"},E={class:"text-red-500"},G={key:0,class:"text-xs"},J={key:0},R={class:"flex justify-end space-x-2 w-full mt-4"},X=r({__name:"DetailView",setup(r){const T=g(),U=e(),V=D(),A=i({}),X=d(),Y=O(),Z=m(),{t:ee}=p(),ae=i(""),{handlePayment:le,validatePayment:te}=N();async function ue(){var e,a,l;const t=await b({path:{trade_no:T.params.trade_no.toString()}});if("error"===(null==(e=t.data)?void 0:e.status))return U.error(null==(a=t.data)?void 0:a.message);A.value=null==(l=t.data)?void 0:l.data}const ne=v(()=>({cancelled:ee("Cancelled"),unpaid:ee("Unpaid"),paid:ee("Paid")})),re=v(()=>({cancelled:"red",unpaid:"yellow",paid:"green"})),se={cancelled:H,unpaid:F,paid:B};async function oe(){te(ae.value,A.value.amount)&&await le(ae.value,T.params.trade_no.toString())}async function ce(){try{await Y.cancelOrder(T.params.trade_no.toString(),V,ee),U.success(ee("Cancellation successful")),ue()}catch(e){}}return f(()=>{ue()}),(e,r)=>(o(),_(a,{"header-title":e.$t("Order Details"),"toggle-header":!1,"show-footer":!1},{default:y(()=>[h(n,{class:"mx-auto p-4 md:p-10 space-y-5"},{default:y(()=>[h(j,{to:"/user/orders"}),h(x($),null,{default:y(()=>[c("div",K,[h(x(l),{size:50,color:re.value[A.value.status],component:se[A.value.status]},null,8,["color","component"]),c("p",null,C(ne.value[A.value.status]),1)])]),_:1}),h(x($),{title:e.$t("Package Snapshot")},{default:y(()=>[h(x(I),{"content-class":"ml-10",columns:1,size:"large","label-placement":"left",separator:""},{default:y(()=>[h(x(M),{label:e.$t("Name")},{default:y(()=>{var e;return[k(C(null==(e=A.value.snapshot)?void 0:e.name),1)]}),_:1},8,["label"]),h(x(M),{label:e.$t("Intro")},{default:y(()=>{var e;return[k(C(null==(e=A.value.snapshot)?void 0:e.intro),1)]}),_:1},8,["label"]),h(x(M),{label:e.$t("Badge")},{default:y(()=>{var e;return[k(C(null==(e=A.value.snapshot)?void 0:e.badge),1)]}),_:1},8,["label"]),h(x(M),{label:e.$t("Privileges")},{default:y(()=>{var e;return[(o(!0),s(L,null,z((null==(e=A.value.snapshot)?void 0:e.features)||[],e=>(o(),s("div",Q,[h(x(l),{size:16,color:"green",component:x(B)},null,8,["component"]),c("p",{class:"w-full truncate",title:e},C(e),9,W)]))),256))]}),_:1},8,["label"])]),_:1})]),_:1},8,["title"]),h(x($),{title:e.$t("Product Information")},{default:y(()=>[h(x(I),{"content-class":"ml-10",columns:1,size:"large","label-placement":"left",separator:""},{default:y(()=>[h(x(M),{label:e.$t("Name")},{default:y(()=>{var e;return[k(C(null==(e=A.value.product)?void 0:e.name),1)]}),_:1},8,["label"]),h(x(M),{label:e.$t("Duration")},{default:y(()=>{var a;return[k(C(e.$t("{minutes} minutes",{minutes:null==(a=A.value.product)?void 0:a.duration})),1)]}),_:1},8,["label"]),h(x(M),{label:e.$t("Price")},{default:y(()=>{var e,a;return[c("p",q,C(x(t).currency(null==(e=A.value.product)?void 0:e.price,null==(a=x(X).configs)?void 0:a.app.currency,x(Z).locale)),1)]}),_:1},8,["label"])]),_:1})]),_:1},8,["title"]),h(x($),{title:e.$t("Order Information")},{default:y(()=>[h(x(I),{"content-class":"ml-10",columns:1,size:"large","label-placement":"left",separator:""},{default:y(()=>[h(x(M),{label:e.$t("Order Number")},{default:y(()=>[k(C(A.value.trade_no),1)]),_:1},8,["label"]),h(x(M),{label:e.$t("Order Status")},{default:y(()=>[k(C(ne.value[A.value.status]),1)]),_:1},8,["label"]),A.value.pay_method?(o(),_(x(M),{key:0,label:e.$t("Payment Method")},{default:y(()=>[k(C(A.value.pay_method),1)]),_:1},8,["label"])):w("",!0),A.value.paid_at?(o(),_(x(M),{key:1,label:e.$t("Payment Time")},{default:y(()=>[k(C(x(u)(A.value.paid_at).format("LLL")),1)]),_:1},8,["label"])):w("",!0),A.value.canceled_at?(o(),_(x(M),{key:2,label:e.$t("Cancellation Time")},{default:y(()=>[k(C(x(u)(A.value.canceled_at).format("LLL")),1)]),_:1},8,["label"])):w("",!0),h(x(M),{label:e.$t("Creation Time")},{default:y(()=>[k(C(x(u)(A.value.created_at).format("LLL")),1)]),_:1},8,["label"]),h(x(M),{label:e.$t("Total Price")},{default:y(()=>{var a,l;return[c("p",E,C(x(t).currency(A.value.amount,null==(a=x(X).configs)?void 0:a.app.currency,x(Z).locale)),1),A.value.deduct_amount>0?(o(),s("span",G,C(e.$t("Use the coupon to deduct {amount}",{amount:x(t).currency(A.value.deduct_amount,null==(l=x(X).configs)?void 0:l.app.currency,x(Z).locale)})),1)):w("",!0)]}),_:1},8,["label"])]),_:1})]),_:1},8,["title"]),"unpaid"===A.value.status?(o(),s("div",J,[h(x($),{title:e.$t("Checkout")},{default:y(()=>[A.value.amount>0?(o(),_(S,{key:0,value:ae.value,"onUpdate:value":r[0]||(r[0]=e=>ae.value=e)},null,8,["value"])):w("",!0),c("div",R,[A.value.amount>0?(o(),_(x(P),{key:0,type:"primary",disabled:""===ae.value,size:"small",onClick:oe},{default:y(()=>[k(C(e.$t("Proceed to Payment")),1)]),_:1},8,["disabled"])):(o(),_(x(P),{key:1,type:"primary",size:"small",onClick:oe},{default:y(()=>[k(C(e.$t("Pay Now")),1)]),_:1})),h(x(P),{type:"error",size:"small",onClick:ce},{default:y(()=>[k(C(e.$t("Cancel Order")),1)]),_:1})])]),_:1},8,["title"])])):w("",!0)]),_:1})]),_:1},8,["header-title"]))}});export{X as default};
